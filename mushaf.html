<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المصحف الشريف - القرآن الكريم كاملاً</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;600;700&family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gold: #d4af37;
            --secondary-gold: #b8860b;
            --dark-gold: #9a7c0c;
            --light-gold: #f5e987;
            --accent-gold: #ffd700;
            --bg-dark: #0d1421;
            --bg-secondary: #1a1f35;
            --bg-tertiary: #252b42;
            --bg-card: #2a3046;
            --text-light: #f8f9fa;
            --text-gold: #d4af37;
            --text-muted: #adb5bd;
            --shadow-gold: 0 0 30px rgba(212, 175, 55, 0.3);
            --shadow-card: 0 8px 32px rgba(0, 0, 0, 0.3);
            --gradient-gold: linear-gradient(135deg, #d4af37, #b8860b, #daa520);
            --gradient-bg: linear-gradient(135deg, #0d1421 0%, #1a1f35 50%, #252b42 100%);
            --gradient-card: linear-gradient(145deg, #2a3046 0%, #1f2438 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--gradient-bg);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* خلفية النجوم والأشكال الهندسية */
        .cosmic-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .star {
            position: absolute;
            background: var(--primary-gold);
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            animation: twinkle 4s ease-in-out infinite alternate;
        }

        .floating-shape {
            position: absolute;
            opacity: 0.1;
            animation: float 8s ease-in-out infinite;
        }

        @keyframes twinkle {
            0% { opacity: 0.3; transform: scale(0.8) rotate(0deg); }
            100% { opacity: 1; transform: scale(1.2) rotate(180deg); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        /* الحاوي الرئيسي */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* الرأس */
        .header {
            text-align: center;
            margin-bottom: 50px;
            padding: 60px 40px;
            background: linear-gradient(145deg, rgba(212, 175, 55, 0.08), rgba(184, 134, 11, 0.05));
            border: 2px solid var(--primary-gold);
            border-radius: 30px;
            box-shadow: var(--shadow-gold), inset 0 0 30px rgba(212, 175, 55, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(212, 175, 55, 0.1), transparent);
            animation: rotate 30s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header h1 {
            font-family: 'Amiri', serif;
            font-size: clamp(2.5rem, 6vw, 5rem);
            color: var(--primary-gold);
            text-shadow: 3px 3px 8px rgba(0,0,0,0.8);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 25px;
        }

        .header-icon {
            font-size: 0.8em;
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); filter: brightness(1.5); }
        }

        .header p {
            font-size: clamp(1.1rem, 2.5vw, 1.6rem);
            color: var(--secondary-gold);
            font-weight: 400;
            margin-bottom: 30px;
        }

        /* شريط البحث */
        .search-container {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .search-box {
            width: 100%;
            padding: 20px 60px 20px 25px;
            background: rgba(26, 31, 53, 0.8);
            border: 2px solid var(--primary-gold);
            border-radius: 50px;
            color: var(--text-light);
            font-size: 1.1rem;
            font-family: 'Cairo', sans-serif;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            box-shadow: 0 0 25px rgba(212, 175, 55, 0.5);
            border-color: var(--light-gold);
        }

        .search-box::placeholder {
            color: var(--text-muted);
        }

        .search-icon {
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-gold);
            font-size: 1.3rem;
        }

        /* فلاتر البحث */
        .filters-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 12px 25px;
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid var(--primary-gold);
            border-radius: 25px;
            color: var(--primary-gold);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-btn.active {
            background: var(--gradient-gold);
            color: var(--bg-dark);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
        }

        .filter-btn:hover:not(.active) {
            background: rgba(212, 175, 55, 0.2);
            transform: translateY(-2px);
        }

        /* تبويبات الرئيسية */
        .main-tabs {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 50px 0;
            flex-wrap: wrap;
        }

        .main-tab {
            padding: 18px 35px;
            background: var(--gradient-card);
            border: 2px solid var(--primary-gold);
            border-radius: 30px;
            color: var(--primary-gold);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 700;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: var(--shadow-card);
        }

        .main-tab.active {
            background: var(--gradient-gold);
            color: var(--bg-dark);
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(212, 175, 55, 0.5);
        }

        .main-tab:hover:not(.active) {
            background: rgba(212, 175, 55, 0.15);
            transform: translateY(-3px);
        }

        /* قسم القرآن المسموع */
        .audio-section {
            display: none;
        }

        .audio-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .control-group {
            background: var(--gradient-card);
            padding: 30px;
            border-radius: 25px;
            border: 2px solid var(--primary-gold);
            box-shadow: var(--shadow-card);
            transition: all 0.4s ease;
            backdrop-filter: blur(10px);
        }

        .control-group:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(212, 175, 55, 0.3);
        }

        .control-group label {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 18px;
            color: var(--primary-gold);
            font-weight: 700;
            font-size: 1.2rem;
        }

        .control-group select {
            width: 100%;
            padding: 18px;
            background: var(--bg-secondary);
            color: var(--text-light);
            border: 2px solid var(--primary-gold);
            border-radius: 15px;
            font-size: 1.1rem;
            font-family: 'Cairo', sans-serif;
            transition: all 0.3s ease;
        }

        .control-group select:focus {
            outline: none;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
            border-color: var(--light-gold);
        }

        /* معلومات السورة المختارة */
        .selected-surah-info {
            background: var(--gradient-card);
            border: 2px solid var(--primary-gold);
            border-radius: 25px;
            padding: 35px;
            margin: 35px 0;
            text-align: center;
            box-shadow: var(--shadow-gold);
            display: none;
            backdrop-filter: blur(10px);
        }

        .selected-surah-info h3 {
            font-family: 'Amiri', serif;
            color: var(--primary-gold);
            font-size: clamp(2rem, 4vw, 3rem);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        /* مشغل الصوت */
        .audio-player-container {
            text-align: center;
            margin: 40px 0;
        }

        .audio-player {
            width: 100%;
            max-width: 800px;
            margin: 25px auto;
            background: var(--bg-secondary);
            border: 3px solid var(--primary-gold);
            border-radius: 20px;
            padding: 20px;
            box-shadow: var(--shadow-gold);
        }

        /* قسم السور */
        .surahs-section {
            display: block;
        }

        .surahs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .surah-card {
            background: var(--gradient-card);
            border: 2px solid var(--primary-gold);
            border-radius: 20px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-card);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }

        .surah-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
            transition: left 0.6s;
        }

        .surah-card:hover::before {
            left: 100%;
        }

        .surah-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 50px rgba(212, 175, 55, 0.4);
            border-color: var(--light-gold);
        }

        .surah-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 20px;
        }

        .surah-number {
            background: var(--gradient-gold);
            color: var(--bg-dark);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.5);
        }

        .surah-name {
            font-family: 'Amiri', serif;
            color: var(--primary-gold);
            font-size: 1.8rem;
            font-weight: 700;
            text-align: center;
            flex: 1;
            margin: 0 15px;
        }

        .surah-type {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            min-width: 70px;
        }

        .surah-type.meccan {
            background: rgba(220, 20, 60, 0.2);
            color: #ff6b85;
            border: 1px solid #ff6b85;
        }

        .surah-type.medinan {
            background: rgba(34, 139, 34, 0.2);
            color: #5cb85c;
            border: 1px solid #5cb85c;
        }

        .surah-info {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.95rem;
            margin-bottom: 15px;
        }

        .surah-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .action-btn {
            padding: 10px 20px;
            border: 2px solid var(--primary-gold);
            background: rgba(212, 175, 55, 0.1);
            color: var(--primary-gold);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-btn:hover {
            background: var(--primary-gold);
            color: var(--bg-dark);
            transform: scale(1.05);
        }

        /* عرض نص السورة */
        .surah-text-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            display: none;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 1000px;
            max-height: 90%;
            background: var(--gradient-bg);
            border: 3px solid var(--primary-gold);
            border-radius: 25px;
            box-shadow: var(--shadow-gold);
            overflow: hidden;
        }

        .modal-header {
            background: var(--gradient-gold);
            color: var(--bg-dark);
            padding: 25px;
            text-align: center;
            position: relative;
        }

        .modal-header h2 {
            font-family: 'Amiri', serif;
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .close-modal {
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--bg-dark);
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            transform: translateY(-50%) scale(1.2);
        }

        .modal-body {
            padding: 30px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .text-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .font-control-btn {
            padding: 12px 20px;
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid var(--primary-gold);
            border-radius: 15px;
            color: var(--primary-gold);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .font-control-btn:hover {
            background: var(--primary-gold);
            color: var(--bg-dark);
        }

        .font-size-display {
            color: var(--primary-gold);
            font-weight: 700;
            font-size: 1.2rem;
            padding: 12px 20px;
            background: rgba(212, 175, 55, 0.1);
            border-radius: 15px;
            border: 2px solid var(--primary-gold);
            min-width: 80px;
            text-align: center;
        }

        /* البسملة في المودال */
        .modal-bismillah {
            text-align: center;
            font-family: 'Scheherazade New', serif;
            font-size: 2rem;
            color: var(--primary-gold);
            margin-bottom: 40px;
            padding: 25px;
            background: rgba(212, 175, 55, 0.08);
            border-radius: 20px;
            border: 1px solid var(--primary-gold);
        }

        /* الآيات في المودال */
        .modal-ayah {
            font-family: 'Scheherazade New', serif;
            font-size: 1.8rem;
            line-height: 2.8;
            margin-bottom: 25px;
            padding: 25px;
            background: rgba(212, 175, 55, 0.03);
            border-radius: 15px;
            border-right: 4px solid var(--primary-gold);
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
        }

        .modal-ayah:hover {
            background: rgba(212, 175, 55, 0.08);
            transform: translateX(-10px);
        }

        .modal-ayah.highlighted {
            background: rgba(212, 175, 55, 0.15);
            border-right-color: var(--light-gold);
            box-shadow: 0 0 25px rgba(212, 175, 55, 0.3);
        }

        .modal-ayah-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient-gold);
            color: var(--bg-dark);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            font-size: 1.1rem;
            font-weight: 700;
            margin-left: 15px;
            float: left;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
        }

        .modal-ayah-text {
            display: block;
            margin-right: 70px;
            color: var(--text-light);
            text-align: justify;
        }

        /* حالة التحميل */
        .loading {
            text-align: center;
            color: var(--primary-gold);
            font-size: 1.4rem;
            margin: 40px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .loading i {
            animation: spin 1.5s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text::after {
            content: '...';
            animation: dots 2s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { color: rgba(212, 175, 55, 0); text-shadow: .25em 0 0 rgba(212, 175, 55, 0), .5em 0 0 rgba(212, 175, 55, 0); }
            40% { color: var(--primary-gold); text-shadow: .25em 0 0 rgba(212, 175, 55, 0), .5em 0 0 rgba(212, 175, 55, 0); }
            60% { text-shadow: .25em 0 0 var(--primary-gold), .5em 0 0 rgba(212, 175, 55, 0); }
            80%, 100% { text-shadow: .25em 0 0 var(--primary-gold), .5em 0 0 var(--primary-gold); }
        }

        /* رسالة عدم وجود نتائج */
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
            font-size: 1.3rem;
        }

        .no-results i {
            font-size: 4rem;
            color: var(--primary-gold);
            margin-bottom: 20px;
            opacity: 0.5;
        }

        /* تخصيص شريط التمرير */
        .modal-body::-webkit-scrollbar {
            width: 12px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: rgba(26, 31, 53, 0.5);
            border-radius: 10px;
        }

        .modal-body::-webkit-scrollbar-thumb {
            background: var(--gradient-gold);
            border-radius: 10px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.3);
        }

        .modal-body::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-gold);
        }

        /* التذييل */
        .footer {
            background: var(--gradient-card);
            border-top: 3px solid var(--primary-gold);
            padding: 50px 20px;
            text-align: center;
            margin-top: 80px;
            backdrop-filter: blur(15px);
            box-shadow: 0 -10px 30px rgba(212, 175, 55, 0.2);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .developer-info {
            color: var(--primary-gold);
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .copyright {
            color: var(--secondary-gold);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* الاستجابة للأجهزة المحمولة */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header {
                padding: 40px 25px;
                margin-bottom: 30px;
            }

            .header h1 {
                flex-direction: column;
                gap: 15px;
            }

            .search-box {
                padding: 18px 55px 18px 20px;
                font-size: 1rem;
            }

            .main-tabs {
                flex-direction: column;
                align-items: center;
            }

            .main-tab {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }

            .surahs-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .surah-header {
                flex-direction: column;
                gap: 15px;
            }

            .surah-name {
                margin: 0;
            }

            .modal-content {
                width: 95%;
                max-height: 95%;
            }

            .modal-header {
                padding: 20px;
            }

            .modal-header h2 {
                font-size: 1.8rem;
            }

            .modal-body {
                padding: 20px;
            }

            .text-controls {
                flex-direction: column;
                gap: 15px;
            }

            .modal-ayah {
                font-size: 1.5rem;
                padding: 20px;
            }

            .modal-ayah-number {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }

            .modal-ayah-text {
                margin-right: 60px;
            }

            .audio-controls {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .filters-container {
                justify-content: center;
            }

            .filter-btn {
                font-size: 0.9rem;
                padding: 10px 20px;
            }

            .surah-card {
                padding: 20px;
            }

            .modal-bismillah {
                font-size: 1.6rem;
                padding: 20px;
            }

            .modal-ayah {
                font-size: 1.3rem;
                line-height: 2.4;
            }
        }
    </style>
</head>
<body>
    <!-- خلفية النجوم والأشكال -->
    <div class="cosmic-bg" id="cosmicBg"></div>

    <div class="container">
        <!-- الرأس -->
        <header class="header">
            <div class="header-content">
                <h1>
                    <i class="fas fa-mosque header-icon"></i>
                    المصحف الشريف الكامل
                    <i class="fas fa-star-and-crescent header-icon"></i>
                </h1>
                <p>اقرأ واستمع إلى القرآن الكريم كاملاً • ابحث في السور والآيات • تجربة تفاعلية شاملة</p>
                
                <!-- شريط البحث -->
                <div class="search-container">
                    <input type="text" class="search-box" id="searchInput" placeholder="ابحث عن سورة أو آية أو كلمة...">
                    <i class="fas fa-search search-icon"></i>
                </div>

                <!-- فلاتر البحث -->
                <div class="filters-container">
                    <button class="filter-btn active" onclick="filterSurahs('all')">
                        <i class="fas fa-list"></i>
                        جميع السور
                    </button>
                    <button class="filter-btn" onclick="filterSurahs('meccan')">
                        <i class="fas fa-kaaba"></i>
                        مكية
                    </button>
                    <button class="filter-btn" onclick="filterSurahs('medinan')">
                        <i class="fas fa-mosque"></i>
                       مدنية
                   </button>
               </div>
           </div>
       </header>

       <!-- التبويبات الرئيسية -->
       <div class="main-tabs">
           <button class="main-tab active" onclick="showSection('surahs')">
               <i class="fas fa-book-open"></i>
               تصفح السور
           </button>
           <button class="main-tab" onclick="showSection('audio')">
               <i class="fas fa-headphones"></i>
               الاستماع للقرآن
           </button>
       </div>

       <!-- قسم السور -->
       <section class="surahs-section" id="surahsSection">
           <div class="surahs-grid" id="surahsGrid">
               <!-- السور ستظهر هنا -->
           </div>
           <div class="no-results" id="noResults" style="display: none;">
               <i class="fas fa-search"></i>
               <p>لم يتم العثور على نتائج مطابقة لبحثك</p>
           </div>
       </section>

       <!-- قسم الصوت -->
       <section class="audio-section" id="audioSection">
           <div class="audio-controls">
               <div class="control-group">
                   <label for="reciters">
                       <i class="fas fa-user-tie"></i>
                       اختر القارئ المفضل:
                   </label>
                   <select id="reciters">
                       <option value="">جاري التحميل...</option>
                   </select>
               </div>

               <div class="control-group">
                   <label for="audioSurahs">
                       <i class="fas fa-list-ol"></i>
                       اختر السورة الكريمة:
                   </label>
                   <select id="audioSurahs">
                       <option value="">اختر القارئ أولاً</option>
                   </select>
               </div>
           </div>

           <div id="selectedSurahInfo" class="selected-surah-info">
               <h3 id="selectedSurahName">
                   <i class="fas fa-star"></i>
                   <span></span>
                   <i class="fas fa-star"></i>
               </h3>
               <p id="selectedReciterName"></p>
           </div>

           <div class="audio-player-container">
               <audio id="audioPlayer" class="audio-player" controls style="display: none;">
                   متصفحك لا يدعم تشغيل الصوت
               </audio>
           </div>
       </section>

       <!-- حالة التحميل -->
       <div id="loading" class="loading" style="display: none;">
           <i class="fas fa-spinner"></i>
           <span class="loading-text">جاري التحميل</span>
       </div>
   </div>

   <!-- مودال عرض نص السورة -->
   <div class="surah-text-modal" id="surahModal">
       <div class="modal-content">
           <div class="modal-header">
               <h2 id="modalSurahName"></h2>
               <p id="modalSurahInfo"></p>
               <button class="close-modal" onclick="closeSurahModal()">
                   <i class="fas fa-times"></i>
               </button>
           </div>
           <div class="modal-body">
               <div class="text-controls">
                   <button class="font-control-btn" onclick="changeFontSize(-2)">
                       <i class="fas fa-search-minus"></i>
                       تصغير الخط
                   </button>
                   <div class="font-size-display" id="fontSizeDisplay">22px</div>
                   <button class="font-control-btn" onclick="changeFontSize(2)">
                       <i class="fas fa-search-plus"></i>
                       تكبير الخط
                   </button>
               </div>
               <div id="modalSurahText">
                   <!-- نص السورة سيظهر هنا -->
               </div>
           </div>
       </div>
   </div>

   <!-- التذييل -->
   <footer class="footer">
       <div class="footer-content">
           <div class="developer-info">
               <i class="fas fa-code"></i>
               <span>تطوير: عبد الصمد بوركيبات</span>
               <i class="fas fa-heart" style="color: #ff6b85;"></i>
           </div>
           <div class="copyright">
               <i class="fas fa-copyright"></i>
               <span>جميع الحقوق محفوظة © 2025</span>
               <i class="fas fa-shield-alt"></i>
           </div>
       </div>
   </footer>

   <script>
       // المتغيرات العامة
       let allSurahs = [];
       let filteredSurahs = [];
       let recitersData = [];
       let currentFilter = 'all';
       let currentFontSize = 22;

       // URLs للـ APIs
       const QURAN_API = 'https://api.alquran.cloud/v1';
       const MP3_QURAN_API = 'https://www.mp3quran.net/api/v3';

       // بيانات السور مع المعلومات
       const surahsInfo = [
           {id: 1, name: 'الفاتحة', englishName: 'Al-Fatiha', verses: 7, type: 'meccan', order: 5},
           {id: 2, name: 'البقرة', englishName: 'Al-Baqarah', verses: 286, type: 'medinan', order: 87},
           {id: 3, name: 'آل عمران', englishName: 'Ali \'Imran', verses: 200, type: 'medinan', order: 89},
           {id: 4, name: 'النساء', englishName: 'An-Nisa', verses: 176, type: 'medinan', order: 92},
           {id: 5, name: 'المائدة', englishName: 'Al-Ma\'idah', verses: 120, type: 'medinan', order: 112},
           {id: 6, name: 'الأنعام', englishName: 'Al-An\'am', verses: 165, type: 'meccan', order: 55},
           {id: 7, name: 'الأعراف', englishName: 'Al-A\'raf', verses: 206, type: 'meccan', order: 39},
           {id: 8, name: 'الأنفال', englishName: 'Al-Anfal', verses: 75, type: 'medinan', order: 88},
           {id: 9, name: 'التوبة', englishName: 'At-Tawbah', verses: 129, type: 'medinan', order: 113},
           {id: 10, name: 'يونس', englishName: 'Yunus', verses: 109, type: 'meccan', order: 51},
           {id: 11, name: 'هود', englishName: 'Hud', verses: 123, type: 'meccan', order: 52},
           {id: 12, name: 'يوسف', englishName: 'Yusuf', verses: 111, type: 'meccan', order: 53},
           {id: 13, name: 'الرعد', englishName: 'Ar-Ra\'d', verses: 43, type: 'medinan', order: 96},
           {id: 14, name: 'إبراهيم', englishName: 'Ibrahim', verses: 52, type: 'meccan', order: 72},
           {id: 15, name: 'الحجر', englishName: 'Al-Hijr', verses: 99, type: 'meccan', order: 54},
           {id: 16, name: 'النحل', englishName: 'An-Nahl', verses: 128, type: 'meccan', order: 70},
           {id: 17, name: 'الإسراء', englishName: 'Al-Isra', verses: 111, type: 'meccan', order: 50},
           {id: 18, name: 'الكهف', englishName: 'Al-Kahf', verses: 110, type: 'meccan', order: 69},
           {id: 19, name: 'مريم', englishName: 'Maryam', verses: 98, type: 'meccan', order: 44},
           {id: 20, name: 'طه', englishName: 'Taha', verses: 135, type: 'meccan', order: 45},
           {id: 21, name: 'الأنبياء', englishName: 'Al-Anbya', verses: 112, type: 'meccan', order: 73},
           {id: 22, name: 'الحج', englishName: 'Al-Hajj', verses: 78, type: 'medinan', order: 103},
           {id: 23, name: 'المؤمنون', englishName: 'Al-Mu\'minun', verses: 118, type: 'meccan', order: 74},
           {id: 24, name: 'النور', englishName: 'An-Nur', verses: 64, type: 'medinan', order: 102},
           {id: 25, name: 'الفرقان', englishName: 'Al-Furqan', verses: 77, type: 'meccan', order: 42},
           {id: 26, name: 'الشعراء', englishName: 'Ash-Shu\'ara', verses: 227, type: 'meccan', order: 47},
           {id: 27, name: 'النمل', englishName: 'An-Naml', verses: 93, type: 'meccan', order: 48},
           {id: 28, name: 'القصص', englishName: 'Al-Qasas', verses: 88, type: 'meccan', order: 49},
           {id: 29, name: 'العنكبوت', englishName: 'Al-\'Ankabut', verses: 69, type: 'meccan', order: 85},
           {id: 30, name: 'الروم', englishName: 'Ar-Rum', verses: 60, type: 'meccan', order: 84},
           {id: 31, name: 'لقمان', englishName: 'Luqman', verses: 34, type: 'meccan', order: 57},
           {id: 32, name: 'السجدة', englishName: 'As-Sajdah', verses: 30, type: 'meccan', order: 75},
           {id: 33, name: 'الأحزاب', englishName: 'Al-Ahzab', verses: 73, type: 'medinan', order: 90},
           {id: 34, name: 'سبأ', englishName: 'Saba', verses: 54, type: 'meccan', order: 58},
           {id: 35, name: 'فاطر', englishName: 'Fatir', verses: 45, type: 'meccan', order: 43},
           {id: 36, name: 'يس', englishName: 'Ya-Sin', verses: 83, type: 'meccan', order: 41},
           {id: 37, name: 'الصافات', englishName: 'As-Saffat', verses: 182, type: 'meccan', order: 56},
           {id: 38, name: 'ص', englishName: 'Sad', verses: 88, type: 'meccan', order: 38},
           {id: 39, name: 'الزمر', englishName: 'Az-Zumar', verses: 75, type: 'meccan', order: 59},
           {id: 40, name: 'غافر', englishName: 'Ghafir', verses: 85, type: 'meccan', order: 60},
           {id: 41, name: 'فصلت', englishName: 'Fussilat', verses: 54, type: 'meccan', order: 61},
           {id: 42, name: 'الشورى', englishName: 'Ash-Shuraa', verses: 53, type: 'meccan', order: 62},
           {id: 43, name: 'الزخرف', englishName: 'Az-Zukhruf', verses: 89, type: 'meccan', order: 63},
           {id: 44, name: 'الدخان', englishName: 'Ad-Dukhan', verses: 59, type: 'meccan', order: 64},
           {id: 45, name: 'الجاثية', englishName: 'Al-Jathiyah', verses: 37, type: 'meccan', order: 65},
           {id: 46, name: 'الأحقاف', englishName: 'Al-Ahqaf', verses: 35, type: 'meccan', order: 66},
           {id: 47, name: 'محمد', englishName: 'Muhammad', verses: 38, type: 'medinan', order: 95},
           {id: 48, name: 'الفتح', englishName: 'Al-Fath', verses: 29, type: 'medinan', order: 111},
           {id: 49, name: 'الحجرات', englishName: 'Al-Hujurat', verses: 18, type: 'medinan', order: 106},
           {id: 50, name: 'ق', englishName: 'Qaf', verses: 45, type: 'meccan', order: 34},
           {id: 51, name: 'الذاريات', englishName: 'Adh-Dhariyat', verses: 60, type: 'meccan', order: 67},
           {id: 52, name: 'الطور', englishName: 'At-Tur', verses: 49, type: 'meccan', order: 76},
           {id: 53, name: 'النجم', englishName: 'An-Najm', verses: 62, type: 'meccan', order: 23},
           {id: 54, name: 'القمر', englishName: 'Al-Qamar', verses: 55, type: 'meccan', order: 37},
           {id: 55, name: 'الرحمن', englishName: 'Ar-Rahman', verses: 78, type: 'medinan', order: 97},
           {id: 56, name: 'الواقعة', englishName: 'Al-Waqi\'ah', verses: 96, type: 'meccan', order: 46},
           {id: 57, name: 'الحديد', englishName: 'Al-Hadid', verses: 29, type: 'medinan', order: 94},
           {id: 58, name: 'المجادلة', englishName: 'Al-Mujadila', verses: 22, type: 'medinan', order: 105},
           {id: 59, name: 'الحشر', englishName: 'Al-Hashr', verses: 24, type: 'medinan', order: 101},
           {id: 60, name: 'الممتحنة', englishName: 'Al-Mumtahanah', verses: 13, type: 'medinan', order: 91},
           {id: 61, name: 'الصف', englishName: 'As-Saff', verses: 14, type: 'medinan', order: 109},
           {id: 62, name: 'الجمعة', englishName: 'Al-Jumu\'ah', verses: 11, type: 'medinan', order: 110},
           {id: 63, name: 'المنافقون', englishName: 'Al-Munafiqun', verses: 11, type: 'medinan', order: 104},
           {id: 64, name: 'التغابن', englishName: 'At-Taghabun', verses: 18, type: 'medinan', order: 108},
           {id: 65, name: 'الطلاق', englishName: 'At-Talaq', verses: 12, type: 'medinan', order: 99},
           {id: 66, name: 'التحريم', englishName: 'At-Tahrim', verses: 12, type: 'medinan', order: 107},
           {id: 67, name: 'الملك', englishName: 'Al-Mulk', verses: 30, type: 'meccan', order: 77},
           {id: 68, name: 'القلم', englishName: 'Al-Qalam', verses: 52, type: 'meccan', order: 2},
           {id: 69, name: 'الحاقة', englishName: 'Al-Haqqah', verses: 52, type: 'meccan', order: 78},
           {id: 70, name: 'المعارج', englishName: 'Al-Ma\'arij', verses: 44, type: 'meccan', order: 79},
           {id: 71, name: 'نوح', englishName: 'Nuh', verses: 28, type: 'meccan', order: 71},
           {id: 72, name: 'الجن', englishName: 'Al-Jinn', verses: 28, type: 'meccan', order: 40},
           {id: 73, name: 'المزمل', englishName: 'Al-Muzzammil', verses: 20, type: 'meccan', order: 3},
           {id: 74, name: 'المدثر', englishName: 'Al-Muddaththir', verses: 56, type: 'meccan', order: 4},
           {id: 75, name: 'القيامة', englishName: 'Al-Qiyamah', verses: 40, type: 'meccan', order: 31},
           {id: 76, name: 'الإنسان', englishName: 'Al-Insan', verses: 31, type: 'medinan', order: 98},
           {id: 77, name: 'المرسلات', englishName: 'Al-Mursalat', verses: 50, type: 'meccan', order: 33},
           {id: 78, name: 'النبأ', englishName: 'An-Naba', verses: 40, type: 'meccan', order: 80},
           {id: 79, name: 'النازعات', englishName: 'An-Nazi\'at', verses: 46, type: 'meccan', order: 81},
           {id: 80, name: 'عبس', englishName: 'Abasa', verses: 42, type: 'meccan', order: 24},
           {id: 81, name: 'التكوير', englishName: 'At-Takwir', verses: 29, type: 'meccan', order: 7},
           {id: 82, name: 'الانفطار', englishName: 'Al-Infitar', verses: 19, type: 'meccan', order: 82},
           {id: 83, name: 'المطففين', englishName: 'Al-Mutaffifin', verses: 36, type: 'meccan', order: 86},
           {id: 84, name: 'الانشقاق', englishName: 'Al-Inshiqaq', verses: 25, type: 'meccan', order: 83},
           {id: 85, name: 'البروج', englishName: 'Al-Buruj', verses: 22, type: 'meccan', order: 27},
           {id: 86, name: 'الطارق', englishName: 'At-Tariq', verses: 17, type: 'meccan', order: 36},
           {id: 87, name: 'الأعلى', englishName: 'Al-A\'la', verses: 19, type: 'meccan', order: 8},
           {id: 88, name: 'الغاشية', englishName: 'Al-Ghashiyah', verses: 26, type: 'meccan', order: 68},
           {id: 89, name: 'الفجر', englishName: 'Al-Fajr', verses: 30, type: 'meccan', order: 10},
           {id: 90, name: 'البلد', englishName: 'Al-Balad', verses: 20, type: 'meccan', order: 35},
           {id: 91, name: 'الشمس', englishName: 'Ash-Shams', verses: 15, type: 'meccan', order: 26},
           {id: 92, name: 'الليل', englishName: 'Al-Layl', verses: 21, type: 'meccan', order: 9},
           {id: 93, name: 'الضحى', englishName: 'Ad-Duhaa', verses: 11, type: 'meccan', order: 11},
           {id: 94, name: 'الشرح', englishName: 'Ash-Sharh', verses: 8, type: 'meccan', order: 12},
           {id: 95, name: 'التين', englishName: 'At-Tin', verses: 8, type: 'meccan', order: 28},
           {id: 96, name: 'العلق', englishName: 'Al-Alaq', verses: 19, type: 'meccan', order: 1},
           {id: 97, name: 'القدر', englishName: 'Al-Qadr', verses: 5, type: 'meccan', order: 25},
           {id: 98, name: 'البينة', englishName: 'Al-Bayyinah', verses: 8, type: 'medinan', order: 100},
           {id: 99, name: 'الزلزلة', englishName: 'Az-Zalzalah', verses: 8, type: 'medinan', order: 93},
           {id: 100, name: 'العاديات', englishName: 'Al-Adiyat', verses: 11, type: 'meccan', order: 14},
           {id: 101, name: 'القارعة', englishName: 'Al-Qari\'ah', verses: 11, type: 'meccan', order: 30},
           {id: 102, name: 'التكاثر', englishName: 'At-Takathur', verses: 8, type: 'meccan', order: 16},
           {id: 103, name: 'العصر', englishName: 'Al-Asr', verses: 3, type: 'meccan', order: 13},
           {id: 104, name: 'الهمزة', englishName: 'Al-Humazah', verses: 9, type: 'meccan', order: 32},
           {id: 105, name: 'الفيل', englishName: 'Al-Fil', verses: 5, type: 'meccan', order: 19},
           {id: 106, name: 'قريش', englishName: 'Quraysh', verses: 4, type: 'meccan', order: 29},
           {id: 107, name: 'الماعون', englishName: 'Al-Ma\'un', verses: 7, type: 'meccan', order: 17},
           {id: 108, name: 'الكوثر', englishName: 'Al-Kawthar', verses: 3, type: 'meccan', order: 15},
           {id: 109, name: 'الكافرون', englishName: 'Al-Kafirun', verses: 6, type: 'meccan', order: 18},
           {id: 110, name: 'النصر', englishName: 'An-Nasr', verses: 3, type: 'medinan', order: 114},
           {id: 111, name: 'المسد', englishName: 'Al-Masad', verses: 5, type: 'meccan', order: 6},
           {id: 112, name: 'الإخلاص', englishName: 'Al-Ikhlas', verses: 4, type: 'meccan', order: 22},
           {id: 113, name: 'الفلق', englishName: 'Al-Falaq', verses: 5, type: 'meccan', order: 20},
           {id: 114, name: 'الناس', englishName: 'An-Nas', verses: 6, type: 'meccan', order: 21}
       ];

       // إنشاء الخلفية الكونية
       function createCosmicBackground() {
           const cosmicBg = document.getElementById('cosmicBg');
           const numStars = window.innerWidth < 768 ? 40 : 80;
           const numShapes = window.innerWidth < 768 ? 10 : 20;
           
           // إنشاء النجوم
           for (let i = 0; i < numStars; i++) {
               const star = document.createElement('div');
               star.className = 'star';
               
               const size = Math.random() * 4 + 2;
               star.style.width = size + 'px';
               star.style.height = size + 'px';
               star.style.left = Math.random() * 100 + '%';
               star.style.top = Math.random() * 100 + '%';
               star.style.animationDelay = Math.random() * 4 + 's';
               star.style.animationDuration = (Math.random() * 4 + 3) + 's';
               
               cosmicBg.appendChild(star);
           }

           // إنشاء الأشكال الهندسية
           for (let i = 0; i < numShapes; i++) {
               const shape = document.createElement('div');
               shape.className = 'floating-shape';
               
               const shapes = ['⬟', '◆', '●', '★', '✧', '◊'];
               shape.innerHTML = shapes[Math.floor(Math.random() * shapes.length)];
               shape.style.fontSize = (Math.random() * 20 + 15) + 'px';
               shape.style.color = 'var(--primary-gold)';
               shape.style.left = Math.random() * 100 + '%';
               shape.style.top = Math.random() * 100 + '%';
               shape.style.animationDelay = Math.random() * 8 + 's';
               shape.style.animationDuration = (Math.random() * 8 + 8) + 's';
               
               cosmicBg.appendChild(shape);
           }
       }

       // تهيئة الصفحة
       document.addEventListener('DOMContentLoaded', function() {
           createCosmicBackground();
           allSurahs = surahsInfo;
           filteredSurahs = allSurahs;
           displaySurahs();
           loadReciters();
           setupEventListeners();
       });

       // إعداد مستمعي الأحداث
       function setupEventListeners() {
           // البحث
           const searchInput = document.getElementById('searchInput');
           searchInput.addEventListener('input', debounce(handleSearch, 300));

           // تغيير حجم النافذة
           window.addEventListener('resize', function() {
               const cosmicBg = document.getElementById('cosmicBg');
               cosmicBg.innerHTML = '';
               createCosmicBackground();
           });

           // إغلاق المودال عند النقر خارجه
           document.getElementById('surahModal').addEventListener('click', function(e) {
               if (e.target === this) {
                   closeSurahModal();
               }
           });

           // اختصارات لوحة المفاتيح
           document.addEventListener('keydown', handleKeyboardShortcuts);
       }

       // تأخير تنفيذ البحث
       function debounce(func, wait) {
           let timeout;
           return function executedFunction(...args) {
               const later = () => {
                   clearTimeout(timeout);
                   func(...args);
               };
               clearTimeout(timeout);
               timeout = setTimeout(later, wait);
           };
       }

       // معالجة البحث
       function handleSearch() {
           const query = document.getElementById('searchInput').value.trim().toLowerCase();
           
           if (query === '') {
               filteredSurahs = allSurahs.filter(surah => 
                   currentFilter === 'all' || surah.type === currentFilter
               );
           } else {
               filteredSurahs = allSurahs.filter(surah => {
                   const matchesFilter = currentFilter === 'all' || surah.type === currentFilter;
                   const matchesSearch = surah.name.includes(query) || 
                                       surah.englishName.toLowerCase().includes(query) ||
                                       surah.id.toString().includes(query);
                   return matchesFilter && matchesSearch;
               });
           }
           
           displaySurahs();
       }

       // فلترة السور
       function filterSurahs(type) {
           currentFilter = type;
           
           // تحديث أزرار الفلتر
           document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
           event.target.classList.add('active');
           
           handleSearch(); // إعادة تطبيق البحث مع الفلتر الجديد
       }

       // عرض السور
       function displaySurahs() {
           const grid = document.getElementById('surahsGrid');
           const noResults = document.getElementById('noResults');
           
           if (filteredSurahs.length === 0) {
               grid.style.display = 'none';
               noResults.style.display = 'block';
               return;
           }
           
           grid.style.display = 'grid';
           noResults.style.display = 'none';
           
grid.innerHTML = filteredSurahs.map(surah => `
               <div class="surah-card" onclick="openSurahModal(${surah.id})">
                   <div class="surah-header">
                       <div class="surah-number">${surah.id}</div>
                       <div class="surah-name">${surah.name}</div>
                       <div class="surah-type ${surah.type}">
                           ${surah.type === 'meccan' ? 'مكية' : 'مدنية'}
                       </div>
                   </div>
                   <div class="surah-info">
                       <i class="fas fa-book"></i>
                       ${surah.verses} آية • 
                       <i class="fas fa-sort-numeric-down"></i>
                       ترتيب النزول: ${surah.order}
                   </div>
                   <div class="surah-actions">
                       <button class="action-btn" onclick="event.stopPropagation(); openSurahModal(${surah.id})">
                           <i class="fas fa-book-reader"></i>
                           قراءة
                       </button>
                       <button class="action-btn" onclick="event.stopPropagation(); playSurahAudio(${surah.id})">
                           <i class="fas fa-play"></i>
                           استماع
                       </button>
                   </div>
               </div>
           `).join('');
       }

       // تبديل الأقسام
       function showSection(section) {
           // تحديث أزرار التبويب
           document.querySelectorAll('.main-tab').forEach(tab => tab.classList.remove('active'));
           event.target.classList.add('active');
           
           // إظهار/إخفاء الأقسام
           if (section === 'surahs') {
               document.getElementById('surahsSection').style.display = 'block';
               document.getElementById('audioSection').style.display = 'none';
           } else {
               document.getElementById('surahsSection').style.display = 'none';
               document.getElementById('audioSection').style.display = 'block';
           }
       }

       // فتح مودال السورة
       async function openSurahModal(surahId) {
           const surah = surahsInfo.find(s => s.id === surahId);
           if (!surah) return;

           // تحديث معلومات المودال
           document.getElementById('modalSurahName').textContent = surah.name;
           document.getElementById('modalSurahInfo').textContent = 
               `${surah.verses} آية • ${surah.type === 'meccan' ? 'مكية' : 'مدنية'} • ترتيب النزول: ${surah.order}`;
           
           // إظهار المودال
           document.getElementById('surahModal').style.display = 'block';
           document.body.style.overflow = 'hidden';
           
           // تحميل نص السورة
           await loadSurahText(surahId);
       }

       // إغلاق مودال السورة
       function closeSurahModal() {
           document.getElementById('surahModal').style.display = 'none';
           document.body.style.overflow = 'auto';
       }

       // تحميل نص السورة
       async function loadSurahText(surahId) {
           const textContainer = document.getElementById('modalSurahText');
           textContainer.innerHTML = '<div class="loading"><i class="fas fa-spinner"></i><span class="loading-text">جاري تحميل النص</span></div>';
           
           try {
               const response = await fetch(`${QURAN_API}/surah/${surahId}`);
               const data = await response.json();
               
               if (data.code === 200) {
                   displaySurahTextInModal(data.data);
               } else {
                   throw new Error('فشل في تحميل النص');
               }
           } catch (error) {
               console.error('خطأ في تحميل نص السورة:', error);
               textContainer.innerHTML = `
                   <div style="text-align: center; color: var(--primary-gold); padding: 40px;">
                       <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 20px;"></i>
                       <p>عذراً، حدث خطأ في تحميل النص</p>
                       <button class="font-control-btn" onclick="loadSurahText(${surahId})" style="margin-top: 20px;">
                           <i class="fas fa-redo"></i>
                           إعادة المحاولة
                       </button>
                   </div>
               `;
           }
       }

       // عرض نص السورة في المودال
       function displaySurahTextInModal(surahData) {
           const container = document.getElementById('modalSurahText');
           let html = '';

           // إضافة البسملة للسور غير الفاتحة والتوبة
           if (surahData.number !== 1 && surahData.number !== 9) {
               html += `
                   <div class="modal-bismillah">
                       <i class="fas fa-star" style="font-size: 0.8em; margin-left: 15px; opacity: 0.7;"></i>
                       بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ
                       <i class="fas fa-star" style="font-size: 0.8em; margin-right: 15px; opacity: 0.7;"></i>
                   </div>
               `;
           }

           // إضافة الآيات
           surahData.ayahs.forEach(ayah => {
               html += `
                   <div class="modal-ayah" onclick="highlightAyah(this)" data-ayah="${ayah.numberInSurah}">
                       <span class="modal-ayah-number">${ayah.numberInSurah}</span>
                       <span class="modal-ayah-text">${ayah.text}</span>
                   </div>
               `;
           });

           container.innerHTML = html;
           updateModalFontSize();
       }

       // تمييز الآية
       function highlightAyah(element) {
           // إزالة التمييز من الآيات الأخرى
           document.querySelectorAll('.modal-ayah').forEach(ayah => {
               ayah.classList.remove('highlighted');
           });
           
           // تمييز الآية المحددة
           element.classList.add('highlighted');
           
           // تأثير بصري
           element.style.transform = 'translateX(-15px) scale(1.02)';
           setTimeout(() => {
               element.style.transform = '';
           }, 300);

           // إنشاء تأثير الموجة
           createRippleEffect(element, event);
       }

       // إنشاء تأثير الموجة
       function createRippleEffect(element, event) {
           const ripple = document.createElement('div');
           const rect = element.getBoundingClientRect();
           const size = Math.max(rect.width, rect.height);
           
           ripple.style.position = 'absolute';
           ripple.style.borderRadius = '50%';
           ripple.style.background = 'rgba(212, 175, 55, 0.4)';
           ripple.style.width = ripple.style.height = size + 'px';
           ripple.style.left = (event.clientX - rect.left - size / 2) + 'px';
           ripple.style.top = (event.clientY - rect.top - size / 2) + 'px';
           ripple.style.transform = 'scale(0)';
           ripple.style.animation = 'ripple 0.8s linear';
           ripple.style.pointerEvents = 'none';
           ripple.style.zIndex = '1';
           
           element.style.position = 'relative';
           element.appendChild(ripple);
           
           setTimeout(() => ripple.remove(), 800);
       }

       // تغيير حجم الخط
       function changeFontSize(change) {
           currentFontSize += change;
           if (currentFontSize < 16) currentFontSize = 16;
           if (currentFontSize > 40) currentFontSize = 40;
           
           document.getElementById('fontSizeDisplay').textContent = currentFontSize + 'px';
           updateModalFontSize();
       }

       // تحديث حجم الخط في المودال
       function updateModalFontSize() {
           document.querySelectorAll('.modal-ayah').forEach(ayah => {
               ayah.style.fontSize = currentFontSize + 'px';
           });
           
           const bismillah = document.querySelector('.modal-bismillah');
           if (bismillah) {
               bismillah.style.fontSize = (currentFontSize + 6) + 'px';
           }
       }

       // تحميل القراء للقسم الصوتي
       async function loadReciters() {
           showLoading(true);
           try {
               const response = await fetch(`${MP3_QURAN_API}/reciters?language=ar`);
               const data = await response.json();
               recitersData = data.reciters;
               populateReciters();
           } catch (error) {
               console.error('خطأ في تحميل القراء:', error);
               document.getElementById('reciters').innerHTML = '<option value="">خطأ في التحميل</option>';
           }
           showLoading(false);
       }

       // ملء قائمة القراء
       function populateReciters() {
           const select = document.getElementById('reciters');
           select.innerHTML = '<option value="">اختر القارئ المفضل</option>';
           
           recitersData.forEach(reciter => {
               const option = document.createElement('option');
               option.value = reciter.id;
               option.textContent = reciter.name;
               select.appendChild(option);
           });

           select.addEventListener('change', onReciterChange);
       }

       // عند تغيير القارئ
       function onReciterChange() {
           const reciterId = document.getElementById('reciters').value;
           const selectedReciter = recitersData.find(r => r.id == reciterId);
           
           if (selectedReciter) {
               populateAudioSurahs(selectedReciter);
               hideAudioInfo();
           }
       }

       // ملء قائمة السور للصوت
       function populateAudioSurahs(reciter) {
           const select = document.getElementById('audioSurahs');
           select.innerHTML = '<option value="">اختر السورة الكريمة</option>';

           if (!reciter.moshaf || reciter.moshaf.length === 0) return;

           const moshaf = reciter.moshaf[0];
           const availableSurahs = moshaf.surah_list.split(',').map(Number);

           surahsInfo.forEach(surah => {
               if (availableSurahs.includes(surah.id)) {
                   const option = document.createElement('option');
                   option.value = surah.id;
                   option.textContent = `${surah.id}. ${surah.name}`;
                   select.appendChild(option);
               }
           });

           select.addEventListener('change', onAudioSurahChange);
       }

       // عند تغيير السورة في قسم الصوت
       function onAudioSurahChange() {
           const surahId = document.getElementById('audioSurahs').value;
           const reciterId = document.getElementById('reciters').value;
           
           if (surahId && reciterId) {
               const surah = surahsInfo.find(s => s.id == surahId);
               const reciter = recitersData.find(r => r.id == reciterId);
               
               playAudioForSurah(surah, reciter);
           }
       }

       // تشغيل الصوت للسورة
       function playAudioForSurah(surah, reciter) {
           const moshaf = reciter.moshaf[0];
           const audioUrl = `${moshaf.server}${String(surah.id).padStart(3, '0')}.mp3`;
           
           // إظهار معلومات السورة المختارة
           document.getElementById('selectedSurahName').querySelector('span').textContent = surah.name;
           document.getElementById('selectedReciterName').textContent = `بصوت القارئ: ${reciter.name}`;
           document.getElementById('selectedSurahInfo').style.display = 'block';
           
           // تشغيل الصوت
           const audioPlayer = document.getElementById('audioPlayer');
           audioPlayer.src = audioUrl;
           audioPlayer.style.display = 'block';
           
           // التمرير إلى المشغل
           audioPlayer.scrollIntoView({ behavior: 'smooth', block: 'center' });
           
           // معالجة أحداث التحميل
           audioPlayer.addEventListener('loadstart', () => showLoading(true));
           audioPlayer.addEventListener('canplaythrough', () => showLoading(false));
           audioPlayer.addEventListener('error', () => {
               showLoading(false);
               alert('عذراً، حدث خطأ في تحميل الصوت');
           });
       }

       // تشغيل صوت السورة من البطاقة
       function playS3urahAudio(surahId) {
           // التبديل إلى قسم الصوت
           showSection('audio');
           document.querySelector('.main-tab:last-child').click();
           
           // إذا كان هناك قارئ محدد، تشغيل السورة مباشرة
           const reciterId = document.getElementById('reciters').value;
           if (reciterId) {
               document.getElementById('audioSurahs').value = surahId;
               onAudioSurahChange();
           } else {
               // إذا لم يكن هناك قارئ محدد، اختيار أول قارئ
               if (recitersData.length > 0) {
                   document.getElementById('reciters').value = recitersData[0].id;
                   onReciterChange();
                   setTimeout(() => {
                       document.getElementById('audioSurahs').value = surahId;
                       onAudioSurahChange();
                   }, 500);
               }
           }
       }

       // إخفاء معلومات الصوت
       function hideAudioInfo() {
           document.getElementById('selectedSurahInfo').style.display = 'none';
           document.getElementById('audioPlayer').style.display = 'none';
       }

       // إظهار/إخفاء حالة التحميل
       function showLoading(show) {
           document.getElementById('loading').style.display = show ? 'block' : 'none';
       }

       // معالجة اختصارات لوحة المفاتيح
       function handleKeyboardShortcuts(e) {
           // ESC لإغلاق المودال
           if (e.key === 'Escape') {
               closeSurahModal();
           }
           
           // مسافة للتشغيل/الإيقاف
           if (e.code === 'Space' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'SELECT') {
               e.preventDefault();
               const audio = document.getElementById('audioPlayer');
               if (audio.style.display !== 'none') {
                   if (audio.paused) {
                       audio.play();
                   } else {
                       audio.pause();
                   }
               }
           }
           
           // + و - لتغيير حجم الخط
           if ((e.key === '+' || e.key === '=') && document.getElementById('surahModal').style.display === 'block') {
               e.preventDefault();
               changeFontSize(2);
           }
           if (e.key === '-' && document.getElementById('surahModal').style.display === 'block') {
               e.preventDefault();
               changeFontSize(-2);
           }
           
           // أسهم للتنقل بين الآيات
           if ((e.key === 'ArrowDown' || e.key === 'ArrowUp') && document.getElementById('surahModal').style.display === 'block') {
               const ayahs = document.querySelectorAll('.modal-ayah');
               const highlighted = document.querySelector('.modal-ayah.highlighted');
               
               if (ayahs.length > 0) {
                   e.preventDefault();
                   let index = 0;
                   
                   if (highlighted) {
                       index = Array.from(ayahs).indexOf(highlighted);
                       if (e.key === 'ArrowDown' && index < ayahs.length - 1) {
                           index++;
                       } else if (e.key === 'ArrowUp' && index > 0) {
                           index--;
                       }
                   }
                   
                   // إنشاء حدث وهمي للنقر
                   const fakeEvent = { clientX: 0, clientY: 0 };
                   highlightAyah(ayahs[index]);
                   ayahs[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
               }
           }
           
           // F للبحث
           if (e.key === 'f' && e.ctrlKey) {
               e.preventDefault();
               document.getElementById('searchInput').focus();
           }
       }

       // إضافة تأثيرات الحركة عند التمرير
       function addScrollAnimations() {
           const observer = new IntersectionObserver((entries) => {
               entries.forEach(entry => {
                   if (entry.isIntersecting) {
                       entry.target.style.opacity = '1';
                       entry.target.style.transform = 'translateY(0)';
                   }
               });
           }, { threshold: 0.1 });

           document.querySelectorAll('.surah-card').forEach(card => {
               card.style.opacity = '0';
               card.style.transform = 'translateY(30px)';
               card.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
               observer.observe(card);
           });
       }

       // تطبيق الحركات عند عرض السور
       function displaySurahsWithAnimation() {
           displaySurahs();
           setTimeout(addScrollAnimations, 100);
       }

       // إعادة تعريف displaySurahs لتشمل الحركات
       const originalDisplaySurahs = displaySurahs;
       displaySurahs = function() {
           originalDisplaySurahs();
           setTimeout(addScrollAnimations, 100);
       };

       // إضافة CSS للتأثيرات
       const additionalCSS = `
           @keyframes ripple {
               to {
                   transform: scale(2);
                   opacity: 0;
               }
           }
           
           .surah-card {
               transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
           }
           
           .modal-ayah {
               transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
           }
           
           .loading {
               animation: fadeInOut 2s ease-in-out infinite;
           }
           
           @keyframes fadeInOut {
               0%, 100% { opacity: 0.7; }
               50% { opacity: 1; }
           }
       `;
       
       const style = document.createElement('style');
       style.textContent = additionalCSS;
       document.head.appendChild(style);

       // تحسين الأداء بإضافة lazy loading للبطاقات
       function setupLazyLoading() {
           const cards = document.querySelectorAll('.surah-card');
           const cardObserver = new IntersectionObserver((entries) => {
               entries.forEach(entry => {
                   if (entry.isIntersecting) {
                       entry.target.classList.add('visible');
                       cardObserver.unobserve(entry.target);
                   }
               });
           }, { rootMargin: '50px' });

           cards.forEach(card => cardObserver.observe(card));
       }

       // تحديث النافذة عند تغيير الحجم
       window.addEventListener('resize', debounce(() => {
           const cosmicBg = document.getElementById('cosmicBg');
           cosmicBg.innerHTML = '';
           createCosmicBackground();
       }, 250));

       // تحسين الذاكرة بإزالة المستمعين غير المستخدمين
       window.addEventListener('beforeunload', () => {
           document.querySelectorAll('audio').forEach(audio => {
               audio.pause();
               audio.src = '';
           });
       });
   </script>
</body>
</html>