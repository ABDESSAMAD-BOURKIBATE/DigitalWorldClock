
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المصحف الشريف - القرآن الكريم كاملاً</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;600;700&family=Scheherazade+New:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gold: #d4af37;
            --secondary-gold: #b8860b;
            --dark-gold: #9a7c0c;
            --light-gold: #f5e987;
            --accent-gold: #ffd700;
            --bg-dark: #0d1421;
            --bg-secondary: #1a1f35;
            --bg-tertiary: #252b42;
            --bg-card: #2a3046;
            --text-light: #f8f9fa;
            --text-gold: #d4af37;
            --text-muted: #adb5bd;
            --shadow-gold: 0 0 30px rgba(212, 175, 55, 0.3);
            --shadow-card: 0 8px 32px rgba(0, 0, 0, 0.3);
            --gradient-gold: linear-gradient(135deg, #d4af37, #b8860b, #daa520);
            --gradient-bg: linear-gradient(135deg, #0d1421 0%, #1a1f35 50%, #252b42 100%);
            --gradient-card: linear-gradient(145deg, #2a3046 0%, #1f2438 100%);
            --glassmorphism: backdrop-filter: blur(20px) saturate(180%);
            --neon-glow: 0 0 20px rgba(212, 175, 55, 0.6), 0 0 40px rgba(212, 175, 55, 0.4), 0 0 60px rgba(212, 175, 55, 0.2);
            --modern-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', 'Inter', sans-serif;
            background: var(--gradient-bg);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            will-change: scroll-position;
        }

        /* تحسين الأداء - CSS للتسريع */
        .surah-card, .action-btn, .filter-btn, .main-tab, .control-button {
            will-change: transform;
            backface-visibility: hidden;
            transform: translateZ(0);
        }

        /* خلفية النجوم المحسنة للأداء */
        .cosmic-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: var(--primary-gold);
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            animation: twinkle 4s ease-in-out infinite alternate;
            filter: drop-shadow(0 0 3px rgba(212, 175, 55, 0.8));
        }

        .floating-shape {
            position: absolute;
            opacity: 0.08;
            animation: float 8s ease-in-out infinite;
            background: linear-gradient(45deg, var(--primary-gold), var(--accent-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        @keyframes twinkle {
            0% { opacity: 0.3; transform: scale(0.8) rotate(0deg); }
            100% { opacity: 1; transform: scale(1.2) rotate(180deg); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        /* الحاوي الرئيسي */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* الرأس المحسن */
        .header {
            text-align: center;
            margin-bottom: 50px;
            padding: 60px 40px;
            background: linear-gradient(145deg, rgba(212, 175, 55, 0.12), rgba(184, 134, 11, 0.08));
            border: 2px solid var(--primary-gold);
            border-radius: 30px;
            box-shadow: var(--modern-shadow), inset 0 0 30px rgba(212, 175, 55, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px) saturate(180%);
        }

        .header h1 {
            font-family: 'Amiri', serif;
            font-size: clamp(2.5rem, 6vw, 5rem);
            color: var(--primary-gold);
            text-shadow: 3px 3px 8px rgba(0,0,0,0.8), 0 0 20px rgba(212, 175, 55, 0.5);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 25px;
        }

        .header-icon {
            font-size: 0.8em;
            animation: pulse-glow 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.8));
        }

        @keyframes pulse-glow {
            0%, 100% { 
                transform: scale(1); 
                filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.8));
            }
            50% { 
                transform: scale(1.2); 
                filter: drop-shadow(0 0 20px rgba(212, 175, 55, 1)) drop-shadow(0 0 30px rgba(255, 215, 0, 0.6));
            }
        }

        .header p {
            font-size: clamp(1.1rem, 2.5vw, 1.6rem);
            color: var(--secondary-gold);
            font-weight: 400;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        /* شريط البحث المحسن */
        .search-container {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .search-box {
            width: 100%;
            padding: 20px 60px 20px 25px;
            background: rgba(26, 31, 53, 0.9);
            border: 2px solid var(--primary-gold);
            border-radius: 50px;
            color: var(--text-light);
            font-size: 1.1rem;
            font-family: 'Cairo', sans-serif;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .search-box:focus {
            outline: none;
            box-shadow: var(--neon-glow), 0 15px 40px rgba(0, 0, 0, 0.3);
            border-color: var(--light-gold);
            transform: translateY(-2px);
        }

        .search-icon {
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-gold);
            font-size: 1.3rem;
            transition: all 0.3s ease;
            filter: drop-shadow(0 0 5px rgba(212, 175, 55, 0.5));
        }

        /* فلاتر البحث المحسنة */
        .filters-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 12px 25px;
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid var(--primary-gold);
            border-radius: 25px;
            color: var(--primary-gold);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px) saturate(180%);
        }

        .filter-btn.active {
            background: var(--gradient-gold);
            color: var(--bg-dark);
            transform: translateY(-3px) scale(1.05);
            box-shadow: var(--neon-glow);
        }

        .filter-btn:hover:not(.active) {
            background: rgba(212, 175, 55, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
        }

        /* التبويبات الرئيسية المحسنة */
        .main-tabs {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 50px 0;
            flex-wrap: wrap;
        }

        .main-tab {
            padding: 18px 35px;
            background: var(--gradient-card);
            border: 2px solid var(--primary-gold);
            border-radius: 30px;
            color: var(--primary-gold);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 700;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: var(--modern-shadow);
            position: relative;
            overflow: hidden;
            text-decoration: none;
        }

        .main-tab.active {
            background: var(--gradient-gold);
            color: var(--bg-dark);
            transform: translateY(-5px) scale(1.05);
            box-shadow: var(--neon-glow), var(--modern-shadow);
        }

        .main-tab:hover:not(.active) {
            background: rgba(212, 175, 55, 0.15);
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(212, 175, 55, 0.3);
        }

        /* بطاقات السور المحسنة */
        .surahs-section {
            display: block;
        }

        .surahs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }

        .surah-card {
            background: var(--gradient-card);
            border: 2px solid var(--primary-gold);
            border-radius: 25px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--modern-shadow);
            position: relative;
            overflow: hidden;
            backdrop-filter: var(--glassmorphism);
        }

        .surah-card:hover {
            transform: translateY(-15px) scale(1.03);
            box-shadow: var(--neon-glow), var(--modern-shadow);
            border-color: var(--light-gold);
        }

        .surah-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            position: relative;
            z-index: 2;
        }

        .surah-number {
            background: var(--gradient-gold);
            color: var(--bg-dark);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.3rem;
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.5);
        }

        .surah-name {
            font-family: 'Amiri', serif;
            color: var(--primary-gold);
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            flex: 1;
            margin: 0 20px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .surah-type {
            padding: 10px 18px;
            border-radius: 25px;
            font-size: 0.95rem;
            font-weight: 600;
            text-align: center;
            min-width: 80px;
        }

        .surah-type.meccan {
            background: linear-gradient(135deg, rgba(220, 20, 60, 0.3), rgba(255, 107, 133, 0.2));
            color: #ff6b85;
            border: 2px solid #ff6b85;
            box-shadow: 0 5px 15px rgba(255, 107, 133, 0.3);
        }

        .surah-type.medinan {
            background: linear-gradient(135deg, rgba(34, 139, 34, 0.3), rgba(92, 184, 92, 0.2));
            color: #5cb85c;
            border: 2px solid #5cb85c;
            box-shadow: 0 5px 15px rgba(92, 184, 92, 0.3);
        }

        .surah-info {
            text-align: center;
            color: var(--text-muted);
            font-size: 1rem;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
        }

        .surah-info i {
            color: var(--primary-gold);
            margin: 0 5px;
        }

        /* أزرار العمل المحسنة */
        .surah-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            position: relative;
            z-index: 2;
        }

        .action-btn {
            padding: 12px 24px;
            border: 2px solid var(--primary-gold);
            background: rgba(212, 175, 55, 0.1);
            color: var(--primary-gold);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px) saturate(180%);
        }

        .action-btn:hover {
            background: var(--primary-gold);
            color: var(--bg-dark);
            transform: scale(1.08) translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.5);
        }

        /* أزرار التشغيل داخل البطاقات */
        .quick-play-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.9), rgba(184, 134, 11, 0.9));
            border: none;
            border-radius: 50%;
            color: var(--bg-dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
            opacity: 0;
            transform: scale(0.8);
            z-index: 3;
        }

        .surah-card:hover .quick-play-btn {
            opacity: 1;
            transform: scale(1);
        }

        .quick-play-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.6);
        }

        /* مشغل الصوت المتطور محسن للهاتف */
        .floating-audio-player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 400px;
            background: linear-gradient(145deg, rgba(42, 48, 70, 0.95), rgba(31, 36, 56, 0.95));
            border: 2px solid var(--primary-gold);
            border-radius: 20px;
            padding: 20px;
            box-shadow: var(--neon-glow), var(--modern-shadow);
            backdrop-filter: var(--glassmorphism);
            z-index: 1000;
            transform: translateX(450px);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .floating-audio-player.active {
            transform: translateX(0);
        }

        .floating-audio-player.minimized {
            transform: translateX(380px);
        }

        /* زر الإخفاء/الإظهار للهاتف */
        .player-toggle-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: var(--gradient-gold);
            border: none;
            border-radius: 50%;
            color: var(--bg-dark);
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: var(--neon-glow);
            z-index: 1001;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .player-toggle-btn:hover {
            transform: scale(1.1);
        }

        .player-toggle-btn.playing {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(212, 175, 55, 0); }
            100% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0); }
        }

        .audio-player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .audio-player-title {
            font-family: 'Amiri', serif;
            color: var(--primary-gold);
            font-size: 1.2rem;
            font-weight: 700;
        }

        .audio-player-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .audio-player-close:hover {
            color: var(--primary-gold);
            transform: scale(1.2);
        }

        /* زر التنزيل */
        .download-btn {
            background: rgba(52, 152, 219, 0.2);
            border: 2px solid #3498db;
            color: #3498db;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 10px;
        }

        .download-btn:hover {
            background: #3498db;
            color: white;
            transform: scale(1.05);
        }

        .download-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .download-progress {
            margin-top: 10px;
            padding: 8px;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 10px;
            border: 1px solid #3498db;
            display: none;
        }

        .download-progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(52, 152, 219, 0.3);
            border-radius: 3px;
            overflow: hidden;
        }

        .download-progress-fill {
            height: 100%;
            background: #3498db;
            width: 0%;
            transition: width 0.3s ease;
        }

        .download-progress-text {
            text-align: center;
            color: #3498db;
            font-size: 0.8rem;
            margin-top: 5px;
        }

        .audio-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .audio-surah-name {
            font-family: 'Amiri', serif;
            color: var(--primary-gold);
            font-size: 1.4rem;
            margin-bottom: 5px;
        }

        .audio-reciter-name {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* شريط التقدم المتطور */
        .progress-container {
            margin: 20px 0;
            position: relative;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            cursor: pointer;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-gold);
            width: 0%;
            transition: width 0.1s ease;
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 5px;
        }

        /* أزرار التحكم المتطورة */
        .audio-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
        }

        .control-button {
            width: 45px;
            height: 45px;
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid var(--primary-gold);
            border-radius: 50%;
            color: var(--primary-gold);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .control-button:hover {
            background: var(--primary-gold);
            color: var(--bg-dark);
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
        }

        .play-pause-btn {
            width: 55px;
            height: 55px;
            font-size: 1.3rem;
            background: var(--gradient-gold);
            color: var(--bg-dark);
        }

        .play-pause-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.6);
        }

        /* قسم الصوت المحسن */
        .audio-section {
            display: none;
        }

        .audio-controls-main {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .control-group {
            background: var(--gradient-card);
            padding: 30px;
            border-radius: 25px;
            border: 2px solid var(--primary-gold);
            box-shadow: var(--modern-shadow);
            transition: all 0.4s ease;
        }

        .control-group:hover {
            transform: translateY(-8px);
            box-shadow: var(--neon-glow), var(--modern-shadow);
        }

        .control-group label {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 18px;
            color: var(--primary-gold);
            font-weight: 700;
            font-size: 1.2rem;
        }

        .control-group select {
            width: 100%;
            padding: 18px;
            background: rgba(26, 31, 53, 0.8);
            color: var(--text-light);
            border: 2px solid var(--primary-gold);
            border-radius: 15px;
            font-size: 1.1rem;
            font-family: 'Cairo', sans-serif;
            transition: all 0.3s ease;
            backdrop-filter: var(--glassmorphism);
        }

        .control-group select:focus {
            outline: none;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
            border-color: var(--light-gold);
            transform: translateY(-2px);
        }

        /* معلومات السورة المختارة */
        .selected-surah-info {
            background: var(--gradient-card);
            border: 2px solid var(--primary-gold);
            border-radius: 25px;
            padding: 35px;
            margin: 35px 0;
            text-align: center;
            box-shadow: var(--modern-shadow);
            display: none;
        }

        .selected-surah-info h3 {
            font-family: 'Amiri', serif;
            color: var(--primary-gold);
            font-size: clamp(2rem, 4vw, 3rem);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }

        /* مودال عرض النص المحسن - نمط الصفحات */
        .surah-text-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            display: none;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 1000px;
            max-height: 90%;
            background: linear-gradient(145deg, var(--bg-dark), var(--bg-secondary));
            border: 3px solid var(--primary-gold);
            border-radius: 25px;
            box-shadow: var(--neon-glow), var(--modern-shadow);
            overflow: hidden;
            animation: modalAppear 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes modalAppear {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .modal-header {
            background: var(--gradient-gold);
            color: var(--bg-dark);
            padding: 25px;
            text-align: center;
            position: relative;
        }

        .modal-header h2 {
            font-family: 'Amiri', serif;
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .close-modal {
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--bg-dark);
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            transform: translateY(-50%) scale(1.2) rotate(90deg);
        }

        .modal-body {
            padding: 30px;
            max-height: 70vh;
            overflow-y: auto;
            position: relative;
        }

        /* أزرار التحكم في النص والصفحات */
        .text-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            position: sticky;
            top: 0;
            background: var(--bg-dark);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 10;
        }

        .font-control-btn {
            padding: 12px 20px;
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid var(--primary-gold);
            border-radius: 15px;
            color: var(--primary-gold);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .font-control-btn:hover {
            background: var(--primary-gold);
            color: var(--bg-dark);
            transform: scale(1.05);
        }

        .font-size-display {
            color: var(--primary-gold);
            font-weight: 700;
            font-size: 1.2rem;
            padding: 12px 20px;
            background: rgba(212, 175, 55, 0.1);
            border-radius: 15px;
            border: 2px solid var(--primary-gold);
            min-width: 80px;
            text-align: center;
        }

        /* أزرار التنقل بين الصفحات */
        .page-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .page-btn {
            padding: 10px 20px;
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid var(--primary-gold);
            border-radius: 15px;
            color: var(--primary-gold);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .page-btn:hover:not(:disabled) {
            background: var(--primary-gold);
            color: var(--bg-dark);
            transform: scale(1.05);
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-info {
            color: var(--primary-gold);
            font-weight: 700;
            font-size: 1.1rem;
            padding: 10px 20px;
            background: rgba(212, 175, 55, 0.1);
            border-radius: 15px;
            border: 2px solid var(--primary-gold);
            min-width: 150px;
            text-align: center;
        }

        /* البسملة في المودال */
        .modal-bismillah {
            text-align: center;
            font-family: 'Scheherazade New', serif;
            font-size: 2rem;
            color: var(--primary-gold);
            margin-bottom: 40px;
            padding: 25px;
            background: rgba(212, 175, 55, 0.08);
            border-radius: 20px;
            border: 1px solid var(--primary-gold);
            page-break-inside: avoid;
        }

        /* صفحة الآيات */
        .page-container {
            display: none;
            min-height: 400px;
            padding: 20px;
            background: rgba(212, 175, 55, 0.02);
            border-radius: 15px;
            margin: 20px 0;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .page-container.active {
            display: block;
            animation: fadeInPage 0.5s ease-in-out;
        }

        @keyframes fadeInPage {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        /* الآيات في الصفحات */
        .modal-ayah {
            font-family: 'Scheherazade New', serif;
            font-size: 1.8rem;
            line-height: 2.8;
            margin-bottom: 25px;
            padding: 25px;
            background: rgba(212, 175, 55, 0.03);
            border-radius: 15px;
            border-right: 4px solid var(--primary-gold);
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            text-align: justify;
            page-break-inside: avoid;
        }

        .modal-ayah:hover {
            background: rgba(212, 175, 55, 0.08);
            transform: translateX(-10px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.2);
        }

        .modal-ayah.highlighted {
            background: rgba(212, 175, 55, 0.15);
            border-right-color: var(--light-gold);
            box-shadow: var(--neon-glow);
            transform: translateX(-15px) scale(1.02);
        }

        .modal-ayah-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient-gold);
            color: var(--bg-dark);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            font-size: 1.1rem;
            font-weight: 700;
            margin-left: 15px;
            float: left;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
        }

        .modal-ayah-text {
            display: block;
            margin-right: 70px;
            color: var(--text-light);
        }

        /* حالة التحميل المحسنة */
        .loading {
            text-align: center;
            color: var(--primary-gold);
            font-size: 1.4rem;
            margin: 40px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .loading i {
            animation: spin 1.5s linear infinite;
            filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.8));
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            background: linear-gradient(45deg, var(--primary-gold), var(--accent-gold), var(--primary-gold));
            background-size: 200% 200%;
            animation: gradient-text 2s ease-in-out infinite;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        @keyframes gradient-text {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* رسالة عدم وجود نتائج */
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
            font-size: 1.3rem;
        }

        .no-results i {
            font-size: 4rem;
            color: var(--primary-gold);
            margin-bottom: 20px;
            opacity: 0.5;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        /* تخصيص شريط التمرير */
        .modal-body::-webkit-scrollbar {
            width: 12px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: rgba(26, 31, 53, 0.5);
            border-radius: 10px;
        }

        .modal-body::-webkit-scrollbar-thumb {
            background: var(--gradient-gold);
            border-radius: 10px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.3);
        }

        .modal-body::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-gold);
        }

        /* التذييل المحسن */
        .footer {
            background: var(--gradient-card);
            border-top: 3px solid var(--primary-gold);
            padding: 50px 20px;
            text-align: center;
            margin-top: 80px;
            backdrop-filter: var(--glassmorphism);
            box-shadow: 0 -10px 30px rgba(212, 175, 55, 0.2);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .developer-info {
            color: var(--primary-gold);
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .copyright {
            color: var(--secondary-gold);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            opacity: 0.8;
        }

        /* إشعار المشغل */
        .audio-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary-gold), var(--secondary-gold));
            color: var(--bg-dark);
            padding: 15px 20px;
            border-radius: 15px;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.5);
            transform: translateX(450px);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1001;
        }

        .audio-notification.show {
            transform: translateX(0);
        }

        /* تحسينات الاستجابة للأجهزة المحمولة */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header {
                padding: 40px 25px;
                margin-bottom: 30px;
            }

            .header h1 {
                flex-direction: column;
                gap: 15px;
            }

            .search-box {
                padding: 18px 55px 18px 20px;
                font-size: 1rem;
            }

            .main-tabs {
                flex-direction: column;
                align-items: center;
            }

            .main-tab {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }

            .surahs-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .surah-header {
                flex-direction: column;
                gap: 15px;
            }

            .surah-name {
                margin: 0;
            }

            .modal-content {
                width: 95%;
                max-height: 95%;
            }

            .modal-header {
                padding: 20px;
            }

            .modal-header h2 {
                font-size: 1.8rem;
            }

            .modal-body {
                padding: 20px;
            }

            .text-controls {
                flex-direction: column;
                gap: 15px;
            }

            .page-controls {
                flex-wrap: wrap;
                gap: 10px;
            }

            .modal-ayah {
                font-size: 1.5rem;
                padding: 20px;
            }

            .modal-ayah-number {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }

            .modal-ayah-text {
                margin-right: 60px;
            }

            .audio-controls-main {
                grid-template-columns: 1fr;
            }

            /* تحسين المشغل للهاتف */
            .floating-audio-player {
                width: calc(100% - 40px);
                right: 20px;
                left: 20px;
                transform: translateY(150px);
            }

            .floating-audio-player.active {
                transform: translateY(0);
            }

            .floating-audio-player.minimized {
                transform: translateY(120px);
            }

            .player-toggle-btn {
                display: flex;
                bottom: 20px;
                right: 20px;
            }

            .quick-play-btn {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
        }

        @media (max-width: 480px) {
            .filters-container {
                justify-content: center;
            }

            .filter-btn {
                font-size: 0.9rem;
                padding: 10px 20px;
            }

            .surah-card {
                padding: 20px;
            }

            .modal-bismillah {
                font-size: 1.6rem;
                padding: 20px;
            }

            .modal-ayah {
                font-size: 1.3rem;
                line-height: 2.4;
            }

            .surah-number {
                width: 50px;
                height: 50px;
                font-size: 1.1rem;
            }

            .page-info {
                min-width: 120px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- خلفية النجوم والأشكال -->
    <div class="cosmic-bg" id="cosmicBg"></div>

    <!-- إشعار المشغل -->
    <div class="audio-notification" id="audioNotification">
        <i class="fas fa-music"></i>
        <span id="notificationText">جاري تشغيل السورة...</span>
    </div>

    <!-- زر إظهار/إخفاء المشغل للهاتف -->
    <button class="player-toggle-btn" id="playerToggleBtn" onclick="togglePlayerVisibility()">
        <i class="fas fa-music"></i>
    </button>

    <!-- مشغل الصوت المتطور -->
    <div class="floating-audio-player" id="floatingPlayer">
        <div class="audio-player-header">
            <div class="audio-player-title">
                <i class="fas fa-headphones"></i>
                مشغل القرآن الكريم
            </div>
            <div style="display: flex; align-items: center;">
                <button class="download-btn" id="downloadBtn" onclick="downloadCurrentSurah()" disabled>
                    <i class="fas fa-download"></i>
                    تنزيل
                </button>
                <button class="audio-player-close" onclick="closeFloatingPlayer()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        
        <div class="download-progress" id="downloadProgress">
            <div class="download-progress-bar">
                <div class="download-progress-fill" id="downloadProgressFill"></div>
            </div>
            <div class="download-progress-text" id="downloadProgressText">جاري التنزيل...</div>
        </div>
        
        <div class="audio-info">
            <div class="audio-surah-name" id="floatingPlayerSurah">السورة</div>
            <div class="audio-reciter-name" id="floatingPlayerReciter">القارئ</div>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progressBar" onclick="seekAudio(event)">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="time-display">
                <span id="currentTime">0:00</span>
                <span id="totalTime">0:00</span>
            </div>
        </div>
        
        <div class="audio-controls">
            <button class="control-button" onclick="previousSurah()" title="السورة السابقة">
                <i class="fas fa-step-backward"></i>
            </button>
            <button class="control-button" onclick="rewindAudio()" title="ترجيع 10 ثوان">
                <i class="fas fa-backward"></i>
            </button>
            <button class="control-button play-pause-btn" id="mainPlayPause" onclick="toggleMainPlayPause()" title="تشغيل/إيقاف مؤقت">
                <i class="fas fa-play"></i>
            </button>
            <button class="control-button" onclick="forwardAudio()" title="تقديم 10 ثوان">
                <i class="fas fa-forward"></i>
            </button>
            <button class="control-button" onclick="nextSurah()" title="السورة التالية">
                <i class="fas fa-step-forward"></i>
            </button>
        </div>
        
        <audio id="mainAudioPlayer" preload="metadata"></audio>
    </div>

    <div class="container">
        <!-- الرأس -->
        <header class="header">
            <div class="header-content">
                <h1>
                    <i class="fas fa-mosque header-icon"></i>
                    المصحف الشريف الكامل
                    <i class="fas fa-star-and-crescent header-icon"></i>
                </h1>
                <p>اقرأ واستمع إلى القرآن الكريم كاملاً • ابحث في السور والآيات • تجربة تفاعلية شاملة</p>
                
                <!-- شريط البحث -->
                <div class="search-container">
                    <input type="text" class="search-box" id="searchInput" placeholder="ابحث عن سورة أو آية أو كلمة...">
                    <i class="fas fa-search search-icon"></i>
                </div>

                <!-- فلاتر البحث -->
                <div class="filters-container">
                    <button class="filter-btn active" onclick="filterSurahs('all')">
                        <i class="fas fa-list"></i>
                        جميع السور
                    </button>
                    <button class="filter-btn" onclick="filterSurahs('meccan')">
                        <i class="fas fa-kaaba"></i>
                        مكية
                    </button>
                    <button class="filter-btn" onclick="filterSurahs('medinan')">
                        <i class="fas fa-mosque"></i>
                        مدنية
                    </button>
                </div>
            </div>
        </header>

    <!-- زر إظهار/إخفاء المشغل للجوال -->
    <button id="togglePlayerBtn" style="display:none; position:fixed; bottom:90px; right:20px; z-index:1100; background:var(--primary-gold); color:var(--bg-dark); border:none; border-radius:50%; width:55px; height:55px; box-shadow:0 5px 15px rgba(212,175,55,0.5); font-size:1.7rem;">
        <i class="fas fa-headphones"></i>
    </button>
    <!-- مشغل الصوت المتطور -->
    <div class="floating-audio-player" id="floatingPlayer">
        <div class="audio-player-header">
            <div class="audio-player-title">
                <i class="fas fa-headphones"></i>
                مشغل القرآن الكريم
            </div>
            <div style="display: flex; align-items: center;">
                <button class="control-button" id="downloadBtn" onclick="downloadCurrentSurah()" title="تنزيل السورة">
                    <i class="fas fa-download"></i>
                </button>
                <button class="audio-player-close" onclick="closeFloatingPlayer()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="audio-info">
            <div class="audio-surah-name" id="floatingPlayerSurah">السورة</div>
            <div class="audio-reciter-name" id="floatingPlayerReciter">القارئ</div>
        </div>
        <div class="progress-container">
            <div class="progress-bar" id="progressBar" onclick="seekAudio(event)">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="time-display">
                <span id="currentTime">0:00</span>
                <span id="totalTime">0:00</span>
            </div>
        </div>
        <div class="audio-controls">
            <button class="control-button" onclick="previousSurah()" title="السورة السابقة">
                <i class="fas fa-step-backward"></i>
            </button>
            <button class="control-button" onclick="rewindAudio()" title="ترجيع 10 ثوان">
                <i class="fas fa-backward"></i>
            </button>
            <button class="control-button play-pause-btn" id="mainPlayPause" onclick="toggleMainPlayPause()" title="تشغيل/إيقاف مؤقت">
                <i class="fas fa-play"></i>
            </button>
            <button class="control-button" onclick="forwardAudio()" title="تقديم 10 ثوان">
                <i class="fas fa-forward"></i>
            </button>
            <button class="control-button" onclick="nextSurah()" title="السورة التالية">
                <i class="fas fa-step-forward"></i>
            </button>
        </div>
        <audio id="mainAudioPlayer" preload="metadata"></audio>
    </div>
                    </select>
                </div>
            </div>

            <div id="selectedSurahInfo" class="selected-surah-info">
                <h3 id="selectedSurahName">
                    <i class="fas fa-star"></i>
                    <span></span>
                    <i class="fas fa-star"></i>
                </h3>
                <p id="selectedReciterName"></p>
            </div>
        </section>

        <!-- حالة التحميل -->
        <div id="loading" class="loading" style="display: none;">
            <i class="fas fa-spinner"></i>
            <span class="loading-text">جاري التحميل</span>
        </div>
    </div>

    <!-- مودال عرض نص السورة -->
    <div class="surah-text-modal" id="surahModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalSurahName"></h2>
                <p id="modalSurahInfo"></p>
                <button class="close-modal" onclick="closeSurahModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="text-controls">
                    <button class="font-control-btn" onclick="changeFontSize(-2)">
                        <i class="fas fa-search-minus"></i>
                        تصغير الخط
                    </button>
                    <div class="font-size-display" id="fontSizeDisplay">22px</div>
                    <button class="font-control-btn" onclick="changeFontSize(2)">
                        <i class="fas fa-search-plus"></i>
                        تكبير الخط
                    </button>
                </div>

                <div class="page-controls">
                    <button class="page-btn" id="prevPageBtn" onclick="previousPage()" disabled>
                        <i class="fas fa-chevron-right"></i>
                        السابق
                    </button>
                    <div class="page-info" id="pageInfo">
                        صفحة 1 من 1
                    </div>
                    <button class="page-btn" id="nextPageBtn" onclick="nextPage()" disabled>
                        التالي
                        <i class="fas fa-chevron-left"></i>
                    </button>
                </div>
                
                <div id="modalSurahText">
                    <!-- صفحات السورة ستظهر هنا -->
                </div>
            </div>
        </div>
    </div>

    <!-- التذييل -->
    <footer class="footer">
        <div class="footer-content">
            <div class="developer-info">
                <i class="fas fa-code"></i>
                <span>تطوير: عبد الصمد بوركيبات</span>
                <i class="fas fa-heart" style="color: #ffc400;"></i>
            </div>
            <div class="copyright">
                <i class="fas fa-copyright"></i>
                <span>جميع الحقوق محفوظة © 2025</span>
                <i class="fas fa-shield-alt"></i>
            </div>
        </div>
    </footer>

    <script>
        // المتغيرات العامة
        let allSurahs = [];
        let filteredSurahs = [];
        let recitersData = [];
        let currentFilter = 'all';
        let currentFontSize = 22;
        let currentAudio = null;
        let currentSurahIndex = 0;
        let currentReciterData = null;
        let isFloatingPlayerActive = false;
        let modalCurrentPage = 1;
        let modalAyatPerPage = 10;
        let modalAyatPages = 1;
        // إظهار زر المشغل للجوال فقط
        function handlePlayerBtnVisibility() {
            const btn = document.getElementById('togglePlayerBtn');
            if(window.innerWidth <= 768) {
                btn.style.display = 'block';
            } else {
                btn.style.display = 'none';
            }
        }
        window.addEventListener('resize', handlePlayerBtnVisibility);
        window.addEventListener('DOMContentLoaded', handlePlayerBtnVisibility);

        // زر إظهار/إخفاء المشغل
        document.getElementById('togglePlayerBtn').onclick = function() {
            const player = document.getElementById('floatingPlayer');
            player.classList.toggle('active');
        };

        // زر تنزيل السورة الحالية
        function downloadCurrentSurah() {
            const audio = document.getElementById('mainAudioPlayer');
            if(audio && audio.src) {
                const a = document.createElement('a');
                a.href = audio.src;
                a.download = document.getElementById('floatingPlayerSurah').textContent + '.mp3';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }
        }

        // عرض آيات السورة في صفحات داخل المودال
        function renderModalAyat(ayatArr) {
            const modalText = document.getElementById('modalSurahText');
            modalText.innerHTML = '';
            if(!ayatArr || ayatArr.length === 0) return;
            modalAyatPages = Math.ceil(ayatArr.length / modalAyatPerPage);
            let start = (modalCurrentPage-1)*modalAyatPerPage;
            let end = Math.min(start+modalAyatPerPage, ayatArr.length);
            for(let i=start; i<end; i++) {
                const ayah = ayatArr[i];
                let ayahDiv = document.createElement('div');
                ayahDiv.className = 'modal-ayah';
                ayahDiv.innerHTML = `<span class='modal-ayah-number'>${ayah.numberInSurah}</span><span class='modal-ayah-text' style='font-size:${currentFontSize}px; text-shadow:0 2px 8px #d4af37;'>${ayah.text}</span>`;
                modalText.appendChild(ayahDiv);
            }
            // أزرار التنقل بين الصفحات
            let controls = document.querySelector('.text-controls');
            controls.innerHTML = '';
            if(modalAyatPages > 1) {
                let prevBtn = document.createElement('button');
                prevBtn.className = 'font-control-btn';
                prevBtn.innerHTML = '<i class="fas fa-arrow-right"></i> السابق';
                prevBtn.onclick = function(){ if(modalCurrentPage>1){modalCurrentPage--; renderModalAyat(ayatArr);} };
                controls.appendChild(prevBtn);
                let pageInfo = document.createElement('span');
                pageInfo.className = 'font-size-display';
                pageInfo.textContent = `صفحة ${modalCurrentPage} من ${modalAyatPages}`;
                controls.appendChild(pageInfo);
                let nextBtn = document.createElement('button');
                nextBtn.className = 'font-control-btn';
                nextBtn.innerHTML = 'التالي <i class="fas fa-arrow-left"></i>';
                nextBtn.onclick = function(){ if(modalCurrentPage<modalAyatPages){modalCurrentPage++; renderModalAyat(ayatArr);} };
                controls.appendChild(nextBtn);
            }
        }

        // تسريع الموقع: تحميل السور عند الحاجة فقط
        async function fetchSurahAyat(surahId) {
            document.getElementById('loading').style.display = 'flex';
            try {
                let res = await fetch(`${QURAN_API}/surah/${surahId}/ar`);
                let data = await res.json();
                document.getElementById('loading').style.display = 'none';
                if(data && data.data && data.data.ayahs) {
                    modalCurrentPage = 1;
                    renderModalAyat(data.data.ayahs);
                }
            } catch(e) {
                document.getElementById('loading').style.display = 'none';
            }
        }

        // تحسين عرض كتابة السور عند فتح المودال
        function openSurahModal(surahId, surahName) {
            document.getElementById('modalSurahName').textContent = surahName;
            document.getElementById('surahModal').style.display = 'block';
            fetchSurahAyat(surahId);
        }

        // إغلاق المودال
        function closeSurahModal() {
            document.getElementById('surahModal').style.display = 'none';
        }
        let isPlayerMinimized = false;
        let currentSurahData = null;
        let currentPages = [];
        let currentPageIndex = 0;
        let ayahsPerPage = 10; // عدد الآيات في كل صفحة

        // URLs للـ APIs
        const QURAN_API = 'https://api.alquran.cloud/v1';
        const MP3_QURAN_API = 'https://www.mp3quran.net/api/v3';

        // بيانات السور مع المعلومات
        const surahsInfo = [
    {id: 1, name: 'سورة الفاتحة', englishName: 'Al-Fatiha', verses: 7, type: 'meccan', order: 5},
    {id: 2, name: 'سورة البقرة', englishName: 'Al-Baqarah', verses: 286, type: 'medinan', order: 87},
    {id: 3, name: 'سورة آل عمران', englishName: 'Ali \'Imran', verses: 200, type: 'medinan', order: 89},
    {id: 4, name: 'سورة النساء', englishName: 'An-Nisa', verses: 176, type: 'medinan', order: 92},
    {id: 5, name: 'سورة المائدة', englishName: 'Al-Ma\'idah', verses: 120, type: 'medinan', order: 112},
    {id: 6, name: 'سورة الأنعام', englishName: 'Al-An\'am', verses: 165, type: 'meccan', order: 55},
    {id: 7, name: 'سورة الأعراف', englishName: 'Al-A\'raf', verses: 206, type: 'meccan', order: 39},
    {id: 8, name: 'سورة الأنفال', englishName: 'Al-Anfal', verses: 75, type: 'medinan', order: 88},
    {id: 9, name: 'سورة التوبة', englishName: 'At-Tawbah', verses: 129, type: 'medinan', order: 113},
    {id: 10, name: 'سورة يونس', englishName: 'Yunus', verses: 109, type: 'meccan', order: 51},
    {id: 11, name: 'سورة هود', englishName: 'Hud', verses: 123, type: 'meccan', order: 52},
    {id: 12, name: 'سورة يوسف', englishName: 'Yusuf', verses: 111, type: 'meccan', order: 53},
    {id: 13, name: 'سورة الرعد', englishName: 'Ar-Ra\'d', verses: 43, type: 'medinan', order: 96},
    {id: 14, name: 'سورة إبراهيم', englishName: 'Ibrahim', verses: 52, type: 'meccan', order: 72},
    {id: 15, name: 'سورة الحجر', englishName: 'Al-Hijr', verses: 99, type: 'meccan', order: 54},
    {id: 16, name: 'سورة النحل', englishName: 'An-Nahl', verses: 128, type: 'meccan', order: 70},
    {id: 17, name: 'سورة الإسراء', englishName: 'Al-Isra', verses: 111, type: 'meccan', order: 50},
    {id: 18, name: 'سورة الكهف', englishName: 'Al-Kahf', verses: 110, type: 'meccan', order: 69},
    {id: 19, name: 'سورة مريم', englishName: 'Maryam', verses: 98, type: 'meccan', order: 44},
    {id: 20, name: 'سورة طه', englishName: 'Taha', verses: 135, type: 'meccan', order: 45},
    {id: 21, name: 'سورة الأنبياء', englishName: 'Al-Anbya', verses: 112, type: 'meccan', order: 73},
    {id: 22, name: 'سورة الحج', englishName: 'Al-Hajj', verses: 78, type: 'medinan', order: 103},
    {id: 23, name: 'سورة المؤمنون', englishName: 'Al-Mu\'minun', verses: 118, type: 'meccan', order: 74},
    {id: 24, name: 'سورة النور', englishName: 'An-Nur', verses: 64, type: 'medinan', order: 102},
    {id: 25, name: 'سورة الفرقان', englishName: 'Al-Furqan', verses: 77, type: 'meccan', order: 42},
    {id: 26, name: 'سورة الشعراء', englishName: 'Ash-Shu\'ara', verses: 227, type: 'meccan', order: 47},
    {id: 27, name: 'سورة النمل', englishName: 'An-Naml', verses: 93, type: 'meccan', order: 48},
    {id: 28, name: 'سورة القصص', englishName: 'Al-Qasas', verses: 88, type: 'meccan', order: 49},
    {id: 29, name: 'سورة العنكبوت', englishName: 'Al-\'Ankabut', verses: 69, type: 'meccan', order: 85},
    {id: 30, name: 'سورة الروم', englishName: 'Ar-Rum', verses: 60, type: 'meccan', order: 84},
    {id: 31, name: 'سورة لقمان', englishName: 'Luqman', verses: 34, type: 'meccan', order: 57},
    {id: 32, name: 'سورة السجدة', englishName: 'As-Sajdah', verses: 30, type: 'meccan', order: 75},
    {id: 33, name: 'سورة الأحزاب', englishName: 'Al-Ahzab', verses: 73, type: 'medinan', order: 90},
    {id: 34, name: 'سورة سبأ', englishName: 'Saba', verses: 54, type: 'meccan', order: 58},
    {id: 35, name: 'سورة فاطر', englishName: 'Fatir', verses: 45, type: 'meccan', order: 43},
    {id: 36, name: 'سورة يس', englishName: 'Ya-Sin', verses: 83, type: 'meccan', order: 41},
    {id: 37, name: 'سورة الصافات', englishName: 'As-Saffat', verses: 182, type: 'meccan', order: 56},
    {id: 38, name: 'سورة ص', englishName: 'Sad', verses: 88, type: 'meccan', order: 38},
    {id: 39, name: 'سورة الزمر', englishName: 'Az-Zumar', verses: 75, type: 'meccan', order: 59},
    {id: 40, name: 'سورة غافر', englishName: 'Ghafir', verses: 85, type: 'meccan', order: 60},
    {id: 41, name: 'سورة فصلت', englishName: 'Fussilat', verses: 54, type: 'meccan', order: 61},
    {id: 42, name: 'سورة الشورى', englishName: 'Ash-Shuraa', verses: 53, type: 'meccan', order: 62},
    {id: 43, name: 'سورة الزخرف', englishName: 'Az-Zukhruf', verses: 89, type: 'meccan', order: 63},
    {id: 44, name: 'سورة الدخان', englishName: 'Ad-Dukhan', verses: 59, type: 'meccan', order: 64},
    {id: 45, name: 'سورة الجاثية', englishName: 'Al-Jathiyah', verses: 37, type: 'meccan', order: 65},
    {id: 46, name: 'سورة الأحقاف', englishName: 'Al-Ahqaf', verses: 35, type: 'meccan', order: 66},
    {id: 47, name: 'سورة محمد', englishName: 'Muhammad', verses: 38, type: 'medinan', order: 95},
    {id: 48, name: 'سورة الفتح', englishName: 'Al-Fath', verses: 29, type: 'medinan', order: 111},
    {id: 49, name: 'سورة الحجرات', englishName: 'Al-Hujurat', verses: 18, type: 'medinan', order: 106},
    {id: 50, name: 'سورة ق', englishName: 'Qaf', verses: 45, type: 'meccan', order: 34},
    {id: 51, name: 'سورة الذاريات', englishName: 'Adh-Dhariyat', verses: 60, type: 'meccan', order: 67},
    {id: 52, name: 'سورة الطور', englishName: 'At-Tur', verses: 49, type: 'meccan', order: 76},
    {id: 53, name: 'سورة النجم', englishName: 'An-Najm', verses: 62, type: 'meccan', order: 23},
    {id: 54, name: 'سورة القمر', englishName: 'Al-Qamar', verses: 55, type: 'meccan', order: 37},
    {id: 55, name: 'سورة الرحمن', englishName: 'Ar-Rahman', verses: 78, type: 'medinan', order: 97},
    {id: 56, name: 'سورة الواقعة', englishName: 'Al-Waqi\'ah', verses: 96, type: 'meccan', order: 46},
    {id: 57, name: 'سورة الحديد', englishName: 'Al-Hadid', verses: 29, type: 'medinan', order: 94},
    {id: 58, name: 'سورة المجادلة', englishName: 'Al-Mujadila', verses: 22, type: 'medinan', order: 105},
    {id: 59, name: 'سورة الحشر', englishName: 'Al-Hashr', verses: 24, type: 'medinan', order: 101},
    {id: 60, name: 'سورة الممتحنة', englishName: 'Al-Mumtahanah', verses: 13, type: 'medinan', order: 91},
    {id: 61, name: 'سورة الصف', englishName: 'As-Saff', verses: 14, type: 'medinan', order: 109},
    {id: 62, name: 'سورة الجمعة', englishName: 'Al-Jumu\'ah', verses: 11, type: 'medinan', order: 110},
    {id: 63, name: 'سورة المنافقون', englishName: 'Al-Munafiqun', verses: 11, type: 'medinan', order: 104},
    {id: 64, name: 'سورة التغابن', englishName: 'At-Taghabun', verses: 18, type: 'medinan', order: 108},
    {id: 65, name: 'سورة الطلاق', englishName: 'At-Talaq', verses: 12, type: 'medinan', order: 99},
    {id: 66, name: 'سورة التحريم', englishName: 'At-Tahrim', verses: 12, type: 'medinan', order: 107},
    {id: 67, name: 'سورة الملك', englishName: 'Al-Mulk', verses: 30, type: 'meccan', order: 77},
    {id: 68, name: 'سورة القلم', englishName: 'Al-Qalam', verses: 52, type: 'meccan', order: 2},
    {id: 69, name: 'سورة الحاقة', englishName: 'Al-Haqqah', verses: 52, type: 'meccan', order: 78},
    {id: 70, name: 'سورة المعارج', englishName: 'Al-Ma\'arij', verses: 44, type: 'meccan', order: 79},
    {id: 71, name: 'سورة نوح', englishName: 'Nuh', verses: 28, type: 'meccan', order: 71},
    {id: 72, name: 'سورة الجن', englishName: 'Al-Jinn', verses: 28, type: 'meccan', order: 40},
    {id: 73, name: 'سورة المزمل', englishName: 'Al-Muzzammil', verses: 20, type: 'meccan', order: 3},
    {id: 74, name: 'سورة المدثر', englishName: 'Al-Muddaththir', verses: 56, type: 'meccan', order: 4},
    {id: 75, name: 'سورة القيامة', englishName: 'Al-Qiyamah', verses: 40, type: 'meccan', order: 31},
    {id: 76, name: 'سورة الإنسان', englishName: 'Al-Insan', verses: 31, type: 'medinan', order: 98},
    {id: 77, name: 'سورة المرسلات', englishName: 'Al-Mursalat', verses: 50, type: 'meccan', order: 33},
    {id: 78, name: 'سورة النبأ', englishName: 'An-Naba', verses: 40, type: 'meccan', order: 80},
    {id: 79, name: 'سورة النازعات', englishName: 'An-Nazi\'at', verses: 46, type: 'meccan', order: 81},
    {id: 80, name: 'سورة عبس', englishName: 'Abasa', verses: 42, type: 'meccan', order: 24},
    {id: 81, name: 'سورة التكوير', englishName: 'At-Takwir', verses: 29, type: 'meccan', order: 7},
    {id: 82, name: 'سورة الانفطار', englishName: 'Al-Infitar', verses: 19, type: 'meccan', order: 82},
    {id: 83, name: 'سورة المطففين', englishName: 'Al-Mutaffifin', verses: 36, type: 'meccan', order: 86},
    {id: 84, name: 'سورة الانشقاق', englishName: 'Al-Inshiqaq', verses: 25, type: 'meccan', order: 83},
    {id: 85, name: 'سورة البروج', englishName: 'Al-Buruj', verses: 22, type: 'meccan', order: 27},
    {id: 86, name: 'سورة الطارق', englishName: 'At-Tariq', verses: 17, type: 'meccan', order: 36},
    {id: 87, name: 'سورة الأعلى', englishName: 'Al-A\'la', verses: 19, type: 'meccan', order: 8},
    {id: 88, name: 'سورة الغاشية', englishName: 'Al-Ghashiyah', verses: 26, type: 'meccan', order: 68},
    {id: 89, name: 'سورة الفجر', englishName: 'Al-Fajr', verses: 30, type: 'meccan', order: 10},
    {id: 90, name: 'سورة البلد', englishName: 'Al-Balad', verses: 20, type: 'meccan', order: 35},
    {id: 91, name: 'سورة الشمس', englishName: 'Ash-Shams', verses: 15, type: 'meccan', order: 26},
    {id: 92, name: 'سورة الليل', englishName: 'Al-Layl', verses: 21, type: 'meccan', order: 9},
    {id: 93, name: 'سورة الضحى', englishName: 'Ad-Duhaa', verses: 11, type: 'meccan', order: 11},
    {id: 94, name: 'سورة الشرح', englishName: 'Ash-Sharh', verses: 8, type: 'meccan', order: 12},
    {id: 95, name: 'سورة التين', englishName: 'At-Tin', verses: 8, type: 'meccan', order: 28},
    {id: 96, name: 'سورة العلق', englishName: 'Al-Alaq', verses: 19, type: 'meccan', order: 1},
    {id: 97, name: 'سورة القدر', englishName: 'Al-Qadr', verses: 5, type: 'meccan', order: 25},
    {id: 98, name: 'سورة البينة', englishName: 'Al-Bayyinah', verses: 8, type: 'medinan', order: 100},
    {id: 99, name: 'سورة الزلزلة', englishName: 'Az-Zalzalah', verses: 8, type: 'medinan', order: 93},
    {id: 100, name: 'سورة العاديات', englishName: 'Al-Adiyat', verses: 11, type: 'meccan', order: 14},
    {id: 101, name: 'سورة القارعة', englishName: 'Al-Qari\'ah', verses: 11, type: 'meccan', order: 30},
    {id: 102, name: 'سورة التكاثر', englishName: 'At-Takathur', verses: 8, type: 'meccan', order: 16},
    {id: 103, name: 'سورة العصر', englishName: 'Al-Asr', verses: 3, type: 'meccan', order: 13},
    {id: 104, name: 'سورة الهمزة', englishName: 'Al-Humazah', verses: 9, type: 'meccan', order: 32},
    {id: 105, name: 'سورة الفيل', englishName: 'Al-Fil', verses: 5, type: 'meccan', order: 19},
    {id: 106, name: 'سورة قريش', englishName: 'Quraysh', verses: 4, type: 'meccan', order: 29},
    {id: 107, name: 'سورة الماعون', englishName: 'Al-Ma\'un', verses: 7, type: 'meccan', order: 17},
    {id: 108, name: 'سورة الكوثر', englishName: 'Al-Kawthar', verses: 3, type: 'meccan', order: 15},
    {id: 109, name: 'سورة الكافرون', englishName: 'Al-Kafirun', verses: 6, type: 'meccan', order: 18},
    {id: 110, name: 'سورة النصر', englishName: 'An-Nasr', verses: 3, type: 'medinan', order: 114},
    {id: 111, name: 'سورة المسد', englishName: 'Al-Masad', verses: 5, type: 'meccan', order: 6},
    {id: 112, name: 'سورة الإخلاص', englishName: 'Al-Ikhlas', verses: 4, type: 'meccan', order: 22},
    {id: 113, name: 'سورة الفلق', englishName: 'Al-Falaq', verses: 5, type: 'meccan', order: 20},
    {id: 114, name: 'سورة الناس', englishName: 'An-Nas', verses: 6, type: 'meccan', order: 21}
];
        // إنشاء الخلفية الكونية المحسنة
        function createCosmicBackground() {
            const cosmicBg = document.getElementById('cosmicBg');
            cosmicBg.innerHTML = '';
            
            const numStars = window.innerWidth < 768 ? 50 : 100;
            const numShapes = window.innerWidth < 768 ? 15 : 30;
            const numGeometric = window.innerWidth < 768 ? 5 : 10;
            
            // إنشاء النجوم
            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                const size = Math.random() * 6 + 2;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 4 + 's';
                star.style.animationDuration = (Math.random() * 4 + 3) + 's';
                
                cosmicBg.appendChild(star);
            }

            // إنشاء الأشكال الهندسية العائمة
            for (let i = 0; i < numShapes; i++) {
                const shape = document.createElement('div');
                shape.className = 'floating-shape';
                
                const shapes = ['⬟', '◆', '●', '★', '✧', '◊', '⟐', '◈', '◉', '⬢'];
                shape.innerHTML = shapes[Math.floor(Math.random() * shapes.length)];
                shape.style.fontSize = (Math.random() * 25 + 15) + 'px';
                shape.style.left = Math.random() * 100 + '%';
                shape.style.top = Math.random() * 100 + '%';
                shape.style.animationDelay = Math.random() * 8 + 's';
                shape.style.animationDuration = (Math.random() * 10 + 8) + 's';
                
                cosmicBg.appendChild(shape);
            }

            // إنشاء الأشكال الهندسية الدائرية
            for (let i = 0; i < numGeometric; i++) {
                const geometric = document.createElement('div');
                geometric.className = 'floating-geometric';
                
                const size = Math.random() * 100 + 50;
                geometric.style.width = size + 'px';
                geometric.style.height = size + 'px';
                geometric.style.left = Math.random() * 100 + '%';
                geometric.style.top = Math.random() * 100 + '%';
                geometric.style.animationDelay = Math.random() * 15 + 's';
                geometric.style.animationDuration = (Math.random() * 20 + 15) + 's';
                
                cosmicBg.appendChild(geometric);
            }
        }

        // تهيئة الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            createCosmicBackground();
            allSurahs = surahsInfo;
            filteredSurahs = allSurahs;
            displaySurahs();
            loadReciters();
            setupEventListeners();
            setupAudioPlayer();
        });

        // إعداد مستمعي الأحداث
        function setupEventListeners() {
            // البحث
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', debounce(handleSearch, 300));

            // تغيير حجم النافذة
            window.addEventListener('resize', debounce(() => {
                createCosmicBackground();
            }, 250));

            // إغلاق المودال عند النقر خارجه
            document.getElementById('surahModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeSurahModal();
                }
            });

            // اختصارات لوحة المفاتيح
            document.addEventListener('keydown', handleKeyboardShortcuts);
        }

        // إعداد مشغل الصوت
        function setupAudioPlayer() {
            const audio = document.getElementById('mainAudioPlayer');
            
            audio.addEventListener('loadstart', () => showLoading(true));
            audio.addEventListener('canplay', () => showLoading(false));
            audio.addEventListener('timeupdate', updateProgress);
            audio.addEventListener('ended', onAudioEnded);
            audio.addEventListener('play', updatePlayPauseButtons);
            audio.addEventListener('pause', updatePlayPauseButtons);
            audio.addEventListener('error', onAudioError);
        }

        // تأخير تنفيذ البحث
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // معالجة البحث
        function handleSearch() {
            const query = document.getElementById('searchInput').value.trim().toLowerCase();
            
            if (query === '') {
                filteredSurahs = allSurahs.filter(surah => 
                    currentFilter === 'all' || surah.type === currentFilter
                );
            } else {
                filteredSurahs = allSurahs.filter(surah => {
                    const matchesFilter = currentFilter === 'all' || surah.type === currentFilter;
                    const matchesSearch = surah.name.includes(query) || 
                                        surah.englishName.toLowerCase().includes(query) ||
                                        surah.id.toString().includes(query);
                    return matchesFilter && matchesSearch;
                });
            }
            
            displaySurahs();
        }

        // فلترة السور
        function filterSurahs(type) {
            currentFilter = type;
            
            // تحديث أزرار الفلتر
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            handleSearch();
        }

        // عرض السور
        function displaySurahs() {
            const grid = document.getElementById('surahsGrid');
            const noResults = document.getElementById('noResults');
            
            if (filteredSurahs.length === 0) {
                grid.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }
            
            grid.style.display = 'grid';
            noResults.style.display = 'none';
            
            grid.innerHTML = filteredSurahs.map(surah => `
                <div class="surah-card" onclick="openSurahModal(${surah.id})">
                    <button class="quick-play-btn" onclick="event.stopPropagation(); quickPlaySurah(${surah.id})" title="تشغيل سريع">
                        <i class="fas fa-play"></i>
                    </button>
                    <div class="surah-header">
                        <div class="surah-number">${surah.id}</div>
                        <div class="surah-name" style="font-size:2.2rem; color:#d4af37; font-weight:bold; text-shadow:0 2px 8px #b8860b;">${surah.name}</div>
                        <div class="surah-type ${surah.type}">
                            ${surah.type === 'meccan' ? 'مكية' : 'مدنية'}
                        </div>
                    </div>
                    <div class="surah-info">
                        <i class="fas fa-book"></i>
                        ${surah.verses} آية • 
                        <i class="fas fa-sort-numeric-down"></i>
                        ترتيب النزول: ${surah.order}
                    </div>
                    <div class="surah-actions">
                        <button class="action-btn" onclick="event.stopPropagation(); openSurahModal(${surah.id})">
                            <i class="fas fa-book-reader"></i>
                            قراءة
                        </button>
                        <button class="action-btn" onclick="event.stopPropagation(); playSurahAudio(${surah.id})">
                            <i class="fas fa-headphones"></i>
                            استماع
                        </button>
                    </div>
                </div>
            `).join('');

            // إضافة تأثيرات الظهور
            setTimeout(addScrollAnimations, 100);
        }

        // تشغيل سريع للسورة
        function quickPlaySurah(surahId) {
            const surah = surahsInfo.find(s => s.id === surahId);
            if (!surah) return;

            // تحديث اسم السورة في المشغل
            document.getElementById('floatingPlayerSurah').textContent = surah.name;

            // إذا كان هناك قارئ محدد مسبقاً
            if (currentReciterData) {
                playAudioForSurah(surah, currentReciterData);
            } else {
                // اختيار أول قارئ متاح
                if (recitersData.length > 0) {
                    currentReciterData = recitersData[0];
                    playAudioForSurah(surah, currentReciterData);
                } else {
                    showNotification('يرجى انتظار تحميل قائمة القراء', 'warning');
                }
            }
        }

        // تبديل الأقسام
        function showSection(section) {
            // تحديث أزرار التبويب
            document.querySelectorAll('.main-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // إظهار/إخفاء الأقسام
            if (section === 'surahs') {
                document.getElementById('surahsSection').style.display = 'block';
                document.getElementById('audioSection').style.display = 'none';
            } else {
                document.getElementById('surahsSection').style.display = 'none';
                document.getElementById('audioSection').style.display = 'block';
            }
        }

        // فتح مودال السورة
        async function openSurahModal(surahId) {
            const surah = surahsInfo.find(s => s.id === surahId);
            if (!surah) return;

            document.getElementById('modalSurahName').textContent = surah.name;
            document.getElementById('modalSurahInfo').textContent = 
                `${surah.verses} آية • ${surah.type === 'meccan' ? 'مكية' : 'مدنية'} • ترتيب النزول: ${surah.order}`;
            
            document.getElementById('surahModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            await loadSurahText(surahId);
        }

        // إغلاق مودال السورة
        function closeSurahModal() {
            document.getElementById('surahModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // تحميل نص السورة
        async function loadSurahText(surahId) {
            const textContainer = document.getElementById('modalSurahText');
            textContainer.innerHTML = '<div class="loading"><i class="fas fa-spinner"></i><span class="loading-text">جاري تحميل النص</span></div>';
            
            try {
                const response = await fetch(`${QURAN_API}/surah/${surahId}`);
                const data = await response.json();
                
                if (data.code === 200) {
                    displaySurahTextInModal(data.data);
                } else {
                    throw new Error('فشل في تحميل النص');
                }
            } catch (error) {
                console.error('خطأ في تحميل نص السورة:', error);
                textContainer.innerHTML = `
                    <div style="text-align: center; color: var(--primary-gold); padding: 40px;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 20px;"></i>
                        <p>عذراً، حدث خطأ في تحميل النص</p>
                        <button class="font-control-btn" onclick="loadSurahText(${surahId})" style="margin-top: 20px;">
                            <i class="fas fa-redo"></i>
                            إعادة المحاولة
                        </button>
                    </div>
                `;
            }
        }

        // عرض نص السورة في المودال
        function displaySurahTextInModal(surahData) {
            const container = document.getElementById('modalSurahText');
            let html = '';

            if (surahData.number !== 1 && surahData.number !== 9) {
                html += `
                    <div class="modal-bismillah">
                        <i class="fas fa-star" style="font-size: 0.8em; margin-left: 15px; opacity: 0.7;"></i>
                        بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ
                        <i class="fas fa-star" style="font-size: 0.8em; margin-right: 15px; opacity: 0.7;"></i>
                    </div>
                `;
            }

            surahData.ayahs.forEach(ayah => {
                html += `
                    <div class="modal-ayah" onclick="highlightAyah(this)" data-ayah="${ayah.numberInSurah}">
                        <span class="modal-ayah-number">${ayah.numberInSurah}</span>
                        <span class="modal-ayah-text">${ayah.text}</span>
                    </div>
                `;
            });

            container.innerHTML = html;
            updateModalFontSize();
        }

        // تمييز الآية
        function highlightAyah(element) {
            document.querySelectorAll('.modal-ayah').forEach(ayah => {
                ayah.classList.remove('highlighted');
            });
            
            element.classList.add('highlighted');
            element.style.transform = 'translateX(-15px) scale(1.02)';
            setTimeout(() => {
                element.style.transform = '';
            }, 300);

            createRippleEffect(element, event);
        }

        // إنشاء تأثير الموجة
        function createRippleEffect(element, event) {
            const ripple = document.createElement('div');
            const rect = element.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            
            ripple.style.position = 'absolute';
            ripple.style.borderRadius = '50%';
            ripple.style.background = 'rgba(212, 175, 55, 0.4)';
            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = (event.clientX - rect.left - size / 2) + 'px';
            ripple.style.top = (event.clientY - rect.top - size / 2) + 'px';
            ripple.style.transform = 'scale(0)';
            ripple.style.animation = 'ripple 0.8s linear';
            ripple.style.pointerEvents = 'none';
            ripple.style.zIndex = '1';
            
            element.style.position = 'relative';
            element.appendChild(ripple);
            
            setTimeout(() => ripple.remove(), 800);
        }

        // تغيير حجم الخط
        function changeFontSize(change) {
            currentFontSize += change;
            if (currentFontSize < 16) currentFontSize = 16;
            if (currentFontSize > 40) currentFontSize = 40;
            
            document.getElementById('fontSizeDisplay').textContent = currentFontSize + 'px';
            updateModalFontSize();
        }

        // تحديث حجم الخط في المودال
        function updateModalFontSize() {
            document.querySelectorAll('.modal-ayah').forEach(ayah => {
                ayah.style.fontSize = currentFontSize + 'px';
            });
            
            const bismillah = document.querySelector('.modal-bismillah');
            if (bismillah) {
                bismillah.style.fontSize = (currentFontSize + 6) + 'px';
            }
        }

        // تحميل القراء
        async function loadReciters() {
            showLoading(true);
            try {
                const response = await fetch(`${MP3_QURAN_API}/reciters?language=ar`);
                const data = await response.json();
                recitersData = data.reciters;
                populateReciters();
            } catch (error) {
                console.error('خطأ في تحميل القراء:', error);
                document.getElementById('reciters').innerHTML = '<option value="">خطأ في التحميل</option>';
            }
            showLoading(false);
        }

        // ملء قائمة القراء
        function populateReciters() {
            const select = document.getElementById('reciters');
            select.innerHTML = '<option value="">اختر القارئ المفضل</option>';
            
            recitersData.forEach(reciter => {
                const option = document.createElement('option');
                option.value = reciter.id;
                option.textContent = reciter.name;
                select.appendChild(option);
            });

            select.addEventListener('change', onReciterChange);
        }

        // عند تغيير القارئ
        function onReciterChange() {
            const reciterId = document.getElementById('reciters').value;
            const selectedReciter = recitersData.find(r => r.id == reciterId);
            
            if (selectedReciter) {
                currentReciterData = selectedReciter;
                populateAudioSurahs(selectedReciter);
                hideAudioInfo();
            }
        }

        // ملء قائمة السور للصوت
        function populateAudioSurahs(reciter) {
            const select = document.getElementById('audioSurahs');
            select.innerHTML = '<option value="">اختر السورة الكريمة</option>';

            if (!reciter.moshaf || reciter.moshaf.length === 0) return;

            const moshaf = reciter.moshaf[0];
            const availableSurahs = moshaf.surah_list.split(',').map(Number);

            surahsInfo.forEach(surah => {
                if (availableSurahs.includes(surah.id)) {
                    const option = document.createElement('option');
                    option.value = surah.id;
                    option.textContent = `${surah.id}. ${surah.name}`;
                    select.appendChild(option);
                }
            });

            select.addEventListener('change', onAudioSurahChange);
        }

        // عند تغيير السورة في قسم الصوت
        function onAudioSurahChange() {
            const surahId = document.getElementById('audioSurahs').value;
            const reciterId = document.getElementById('reciters').value;
            
            if (surahId && reciterId) {
                const surah = surahsInfo.find(s => s.id == surahId);
                const reciter = recitersData.find(r => r.id == reciterId);
                
                playAudioForSurah(surah, reciter);
            }
        }

        // تشغيل الصوت للسورة
        function playAudioForSurah(surah, reciter) {
            const moshaf = reciter.moshaf[0];
            const audioUrl = `${moshaf.server}${String(surah.id).padStart(3, '0')}.mp3`;
            
            currentSurahIndex = surah.id - 1;
            currentReciterData = reciter;
            
            // تحديث المشغل العائم
            document.getElementById('floatingPlayerSurah').textContent = surah.name;
            document.getElementById('floatingPlayerReciter').textContent = `بصوت: ${reciter.name}`;
            
            // إظهار المشغل العائم
            const floatingPlayer = document.getElementById('floatingPlayer');
            floatingPlayer.classList.add('active');
            isFloatingPlayerActive = true;
            
            // تحديث معلومات السورة في القسم الرئيسي
            document.getElementById('selectedSurahName').querySelector('span').textContent = surah.name;
            document.getElementById('selectedReciterName').textContent = `بصوت القارئ: ${reciter.name}`;
            document.getElementById('selectedSurahInfo').style.display = 'block';
            
            // تشغيل الصوت
            const audioPlayer = document.getElementById('mainAudioPlayer');
            audioPlayer.src = audioUrl;
            currentAudio = audioPlayer;
            
            // إظهار إشعار
            showNotification(`جاري تشغيل سورة ${surah.name}`, 'success');
            
            audioPlayer.play().catch(e => {
                console.log('التشغيل التلقائي محظور');
                showNotification('اضغط على زر التشغيل لبدء الاستماع', 'info');
            });
        }

        // تشغيل صوت السورة من البطاقة
        function playSurahAudio(surahId) {
            showSection('audio');
            
            // تحديث التبويبات
            document.querySelectorAll('.main-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('.main-tab:nth-child(2)').classList.add('active');
            
            if (currentReciterData) {
                const surah = surahsInfo.find(s => s.id === surahId);
                playAudioForSurah(surah, currentReciterData);
            } else if (recitersData.length > 0) {
                document.getElementById('reciters').value = recitersData[0].id;
                onReciterChange();
                setTimeout(() => {
                    document.getElementById('audioSurahs').value = surahId;
                    onAudioSurahChange();
                }, 500);
            }
        }

        // وظائف المشغل العائم
        function toggleMainPlayPause() {
            if (!currentAudio) return;
            
            if (currentAudio.paused) {
                currentAudio.play();
            } else {
                currentAudio.pause();
            }
        }

        function previousSurah() {
            if (!currentReciterData) return;
            
            const currentSurah = surahsInfo[currentSurahIndex];
            let prevIndex = currentSurahIndex - 1;
            
            if (prevIndex < 0) prevIndex = surahsInfo.length - 1;
            
            const prevSurah = surahsInfo[prevIndex];
            playAudioForSurah(prevSurah, currentReciterData);
        }

        function nextSurah() {
            if (!currentReciterData) return;
            
            let nextIndex = currentSurahIndex + 1;
            
            if (nextIndex >= surahsInfo.length) nextIndex = 0;
            
            const nextSurah = surahsInfo[nextIndex];
            playAudioForSurah(nextSurah, currentReciterData);
        }

        function rewindAudio() {
            if (!currentAudio) return;
            currentAudio.currentTime = Math.max(0, currentAudio.currentTime - 10);
        }

        function forwardAudio() {
            if (!currentAudio) return;
            currentAudio.currentTime = Math.min(currentAudio.duration, currentAudio.currentTime + 10);
        }

        function seekAudio(event) {
            if (!currentAudio) return;
            
            const progressBar = document.getElementById('progressBar');
            const rect = progressBar.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const percentage = clickX / rect.width;
            
            currentAudio.currentTime = percentage * currentAudio.duration;
        }

        function closeFloatingPlayer() {
            const floatingPlayer = document.getElementById('floatingPlayer');
            floatingPlayer.classList.remove('active');
            isFloatingPlayerActive = false;
            
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.src = '';
            }
            
            hideAudioInfo();
        }

        // تحديث شريط التقدم
        function updateProgress() {
            if (!currentAudio || !currentAudio.duration) return;
            
            const percentage = (currentAudio.currentTime / currentAudio.duration) * 100;
            document.getElementById('progressFill').style.width = percentage + '%';
            
            document.getElementById('currentTime').textContent = formatTime(currentAudio.currentTime);
            document.getElementById('totalTime').textContent = formatTime(currentAudio.duration);
        }

        // تحديث أزرار التشغيل
        function updatePlayPauseButtons() {
            const mainBtn = document.getElementById('mainPlayPause');
            if (!currentAudio || !mainBtn) return;
            
            if (currentAudio.paused) {
                mainBtn.innerHTML = '<i class="fas fa-play"></i>';
            } else {
                mainBtn.innerHTML = '<i class="fas fa-pause"></i>';
            }
        }

        // عند انتهاء الصوت
        function onAudioEnded() {
            // تشغيل السورة التالية تلقائياً
            nextSurah();
        }

        // عند حدوث خطأ في الصوت
        function onAudioError() {
            showNotification('حدث خطأ في تشغيل الصوت', 'error');
            showLoading(false);
        }

        // تنسيق الوقت
        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00';
            
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        // إظهار الإشعارات
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('audioNotification');
            const textSpan = document.getElementById('notificationText');
            
            textSpan.textContent = message;
            
            // تغيير الأيقونة حسب النوع
            const icon = notification.querySelector('i');
            switch(type) {
                case 'success':
                    icon.className = 'fas fa-check-circle';
                    break;
                case 'error':
                    icon.className = 'fas fa-exclamation-triangle';
                    break;
                case 'warning':
                    icon.className = 'fas fa-exclamation-circle';
                    break;
                default:
                    icon.className = 'fas fa-info-circle';
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // إخفاء معلومات الصوت
        function hideAudioInfo() {
            document.getElementById('selectedSurahInfo').style.display = 'none';
        }

        // إظهار/إخفاء حالة التحميل
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        // معالجة اختصارات لوحة المفاتيح
        function handleKeyboardShortcuts(e) {
            if (e.key === 'Escape') {
                closeSurahModal();
            }
            
            if (e.code === 'Space' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'SELECT') {
                e.preventDefault();
                if (currentAudio && isFloatingPlayerActive) {
                    toggleMainPlayPause();
                }
            }
            
            if ((e.key === '+' || e.key === '=') && document.getElementById('surahModal').style.display === 'block') {
                e.preventDefault();
                changeFontSize(2);
            }
            if (e.key === '-' && document.getElementById('surahModal').style.display === 'block') {
                e.preventDefault();
                changeFontSize(-2);
            }
            
            // التنقل بين السور
            if (e.key === 'ArrowLeft' && isFloatingPlayerActive) {
                e.preventDefault();
                nextSurah();
            }
            if (e.key === 'ArrowRight' && isFloatingPlayerActive) {
                e.preventDefault();
                previousSurah();
            }
            
            if ((e.key === 'ArrowDown' || e.key === 'ArrowUp') && document.getElementById('surahModal').style.display === 'block') {
                const ayahs = document.querySelectorAll('.modal-ayah');
                const highlighted = document.querySelector('.modal-ayah.highlighted');
                
                if (ayahs.length > 0) {
                    e.preventDefault();
                    let index = 0;
                    
                    if (highlighted) {
                        index = Array.from(ayahs).indexOf(highlighted);
                        if (e.key === 'ArrowDown' && index < ayahs.length - 1) {
                            index++;
                        } else if (e.key === 'ArrowUp' && index > 0) {
                            index--;
                        }
                    }
                    
                    highlightAyah(ayahs[index]);
                    ayahs[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
            
            if (e.key === 'f' && e.ctrlKey) {
                e.preventDefault();
                document.getElementById('searchInput').focus();
            }
        }

        // إضافة تأثيرات الحركة عند التمرير
        function addScrollAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.surah-card').forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                card.style.transition = `all 0.6s cubic-bezier(0.4, 0, 0.2, 1) ${index * 0.1}s`;
                observer.observe(card);
            });
        }

        // إنشاء تأثيرات البريق
        function createSparkles() {
            const sparkleContainer = document.body;
            
            setInterval(() => {
                if (Math.random() > 0.7) {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'sparkle';
                    sparkle.style.left = Math.random() * window.innerWidth + 'px';
                    sparkle.style.top = Math.random() * window.innerHeight + 'px';
                    sparkle.style.animationDelay = Math.random() * 2 + 's';
                    
                    sparkleContainer.appendChild(sparkle);
                    
                    setTimeout(() => sparkle.remove(), 2000);
                }
            }, 1000);
        }

        // تحسين الذاكرة
        window.addEventListener('beforeunload', () => {
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.src = '';
            }
        });

        // بدء تأثيرات البريق
        setTimeout(createSparkles, 2000);
    </script>
</body>
</html>