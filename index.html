<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ساعة رقمية عالمية </title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/flag-icons@6.11.1/css/flag-icons.min.css" rel="stylesheet">
  <style>
    /* أنماط CSS (نفس الأنماط السابقة دون تغيير) */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
      color: #fff;
      min-height: 100vh;
      overflow-x: hidden;
    }

    [lang="en"] {
      direction: ltr;
      font-family: Arial, sans-serif;
    }

    .header {
      text-align: center;
      padding: 20px;
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
      border-bottom: 2px solid rgba(255,215,0,0.3);
    }

    .project-title {
      font-size: 2.5rem;
      font-weight: bold;
      background: linear-gradient(45deg, #FFD700, #FFA500, #FF8C00);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 20px rgba(255,215,0,0.5);
      margin-bottom: 10px;
      animation: titleGlow 3s ease-in-out infinite alternate;
    }

    @keyframes titleGlow {
      0% { filter: brightness(1); }
      100% { filter: brightness(1.3); }
    }

    .subtitle {
      font-size: 1.1rem;
      color: #ccc;
      margin-bottom: 20px;
    }

    .controls {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    .btn {
      padding: 12px 24px;
      background: linear-gradient(45deg, #FFD700, #FFA500);
      color: #000;
      font-weight: bold;
      border: none;
      border-radius: 25px;
      text-decoration: none;
      transition: all 0.3s ease;
      cursor: pointer;
      font-size: 0.9rem;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn:hover {
      background: linear-gradient(45deg, #FFA500, #FF8C00);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(255,165,0,0.4);
    }

    .search-container {
      display: flex;
      justify-content: center;
      margin-bottom: 30px;
    }

    .search-input {
      padding: 12px 20px;
      border: 2px solid rgba(255,215,0,0.3);
      border-radius: 25px;
      background: rgba(0,0,0,0.3);
      color: #fff;
      font-size: 1rem;
      width: 300px;
      max-width: 90%;
      transition: all 0.3s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: #FFD700;
      box-shadow: 0 0 20px rgba(255,215,0,0.3);
    }

    .search-input::placeholder {
      color: #aaa;
    }

    .stats-bar {
      display: flex;
      justify-content: center;
      gap: 30px;
      flex-wrap: wrap;
      margin-bottom: 30px;
      padding: 15px;
    }

    .stat-item {
      text-align: center;
      background: rgba(255,255,255,0.1);
      padding: 15px 25px;
      border-radius: 15px;
      backdrop-filter: blur(5px);
    }

    .stat-number {
      font-size: 1.5rem;
      font-weight: bold;
      color: #FFD700;
    }

    .stat-label {
      font-size: 0.9rem;
      color: #ccc;
    }

    .clock-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .clock-box {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      border: 2px solid rgba(255,255,255,0.15);
      border-radius: 25px;
      padding: 25px;
      text-align: center;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(15px);
      animation: fadeInUp 0.6s ease forwards;
      opacity: 0;
      transform: translateY(20px);
      box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    .clock-box::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
      border-radius: 25px;
      z-index: -1;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .clock-box:hover::before {
      opacity: 1;
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .clock-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 0.6s ease;
    }

    .clock-box:hover::before {
      left: 100%;
    }

    .clock-box:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow: 
        0 20px 60px rgba(255,255,255,0.15),
        0 0 30px rgba(255,215,0,0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
      border-color: rgba(255,215,0,0.6);
    }

    .country-header {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-bottom: 20px;
      padding: 15px;
      background: rgba(255,255,255,0.05);
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .country-flag {
      font-size: 2.5rem;
      line-height: 1;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
      transition: transform 0.3s ease;
    }

    .clock-box:hover .country-flag {
      transform: scale(1.1);
    }

    .flag-icon {
      width: 48px;
      height: 36px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      border: 2px solid rgba(255,255,255,0.2);
      transition: transform 0.3s ease;
    }

    .clock-box:hover .flag-icon {
      transform: scale(1.05);
    }

    .country-name {
      font-size: 1.3rem;
      font-weight: 700;
      color: #fff;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
      margin: 0;
    }

    .location-info {
      font-size: 0.9rem;
      color: #bbb;
      margin-bottom: 15px;
      padding: 8px 12px;
      background: rgba(255,255,255,0.05);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: all 0.3s ease;
    }

    .location-info:hover {
      background: rgba(255,255,255,0.1);
      color: #fff;
    }

    .location-info i {
      color: #FFD700;
      font-size: 0.8rem;
    }

    .clock-display {
      font-size: 2.2rem;
      font-weight: 900;
      margin: 20px 0;
      text-shadow: 0 0 20px currentColor;
      animation: clockPulse 2s infinite;
      background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      padding: 15px;
      border-radius: 15px;
      border: 2px solid rgba(255,255,255,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      position: relative;
      overflow: hidden;
    }

    .clock-display::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 1s ease;
    }

    .clock-box:hover .clock-display::before {
      left: 100%;
    }

    @keyframes clockPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    .time-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin: 15px 0;
    }

    .time-item {
      background: rgba(0,0,0,0.2);
      padding: 8px;
      border-radius: 10px;
      font-size: 0.85rem;
    }

    .prayer-info {
      background: linear-gradient(135deg, rgba(255,215,0,0.15), rgba(255,165,0,0.1));
      padding: 15px;
      border-radius: 15px;
      margin-top: 15px;
      font-size: 0.9rem;
      border: 1px solid rgba(255,215,0,0.3);
      box-shadow: 0 4px 12px rgba(255,215,0,0.1);
    }

    .prayer-header {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-bottom: 12px;
      font-weight: 700;
      color: #FFD700;
      font-size: 1rem;
    }

    .prayer-times-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      gap: 8px;
    }

    .prayer-item {
      background: rgba(0,0,0,0.3);
      padding: 8px 6px;
      border-radius: 10px;
      text-align: center;
      transition: all 0.3s ease;
      border: 1px solid rgba(255,255,255,0.1);
      position: relative;
      overflow: hidden;
    }

    .prayer-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 0.6s ease;
    }

    .prayer-item:hover::before {
      left: 100%;
    }

    .prayer-item:hover {
      background: rgba(255,215,0,0.2);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(255,215,0,0.2);
    }

    .prayer-name {
      font-size: 0.75rem;
      font-weight: 600;
      margin-bottom: 2px;
      color: #FFD700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
    }

    .prayer-time {
      font-size: 0.8rem;
      font-weight: 700;
      color: #fff;
    }

    .weather-info {
      background: linear-gradient(135deg, rgba(0,191,255,0.15), rgba(30,144,255,0.1));
      padding: 12px;
      border-radius: 12px;
      margin-top: 10px;
      font-size: 0.9rem;
      border: 1px solid rgba(0,191,255,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.3s ease;
    }

    .weather-info:hover {
      background: linear-gradient(135deg, rgba(0,191,255,0.25), rgba(30,144,255,0.2));
      transform: translateY(-1px);
    }

    .weather-icon {
      font-size: 1.2rem;
      color: #00BFFF;
    }

    .time-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin: 15px 0;
    }

    .time-item {
      background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      padding: 10px;
      border-radius: 12px;
      font-size: 0.85rem;
      border: 1px solid rgba(255,255,255,0.1);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .time-item:hover {
      background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
      transform: translateY(-1px);
    }

    .time-icon {
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(5px);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: linear-gradient(135deg, #1a1a2e, #16213e);
      padding: 40px;
      border-radius: 20px;
      max-width: 800px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      border: 1px solid rgba(255,215,0,0.3);
      text-align: right;
    }

    [lang="en"] .modal-content {
      text-align: left;
    }

    .modal-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .modal-title {
      font-size: 1.8rem;
      color: #FFD700;
      margin-bottom: 10px;
    }

    .country-details {
      display: grid;
      gap: 15px;
    }

    .detail-item {
      background: rgba(255,255,255,0.05);
      padding: 15px;
      border-radius: 10px;
      border-left: 4px solid #FFD700;
    }

    [lang="en"] .detail-item {
      border-left: none;
      border-right: 4px solid #FFD700;
    }

    .detail-label {
      font-weight: bold;
      color: #FFD700;
      margin-bottom: 5px;
    }

    .detail-value {
      color: #ccc;
    }

    .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      background: rgba(255,0,0,0.2);
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .close-btn:hover {
      background: rgba(255,0,0,0.4);
      transform: rotate(90deg);
    }

    .copyright {
      text-align: center;
      padding: 30px 20px;
      color: #666;
      border-top: 1px solid rgba(255,255,255,0.1);
      margin-top: 40px;
    }

    .floating-clock {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(10px);
      padding: 15px;
      border-radius: 15px;
      border: 1px solid rgba(255,215,0,0.3);
      z-index: 100;
    }

    @media (max-width: 768px) {
      .project-title {
        font-size: 2rem;
      }
      
      .clock-container {
        grid-template-columns: 1fr;
        padding: 10px;
      }
      
      .stats-bar {
        flex-direction: column;
        gap: 15px;
      }
      
      .floating-clock {
        position: static;
        margin: 20px auto;
        width: fit-content;
      }

      .prayer-info {
        grid-template-columns: 1fr;
      }
    }

    .continent-filter {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      max-width: 1200px;
      margin: 0 auto 30px auto;
      padding: 20px;
    }

    .continent-btn {
      padding: 15px 20px;
      background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      color: #fff;
      border: 2px solid rgba(255,255,255,0.2);
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.4s ease;
      font-size: 1rem;
      font-weight: 600;
      text-align: center;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .continent-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 0.6s ease;
    }

    .continent-btn:hover::before {
      left: 100%;
    }

    .continent-btn:hover {
      transform: translateY(-5px) scale(1.05);
      background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,165,0,0.15));
      border-color: #FFD700;
      color: #FFD700;
      box-shadow: 0 8px 25px rgba(255,215,0,0.3);
    }

    .continent-btn.active {
      background: linear-gradient(135deg, rgba(255,215,0,0.3), rgba(255,165,0,0.2));
      border-color: #FFD700;
      color: #FFD700;
      transform: scale(1.05);
      box-shadow: 0 0 30px rgba(255,215,0,0.4);
    }

    .continent-icon {
      font-size: 2rem;
      line-height: 1;
    }

    .continent-name {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .continent-count {
      font-size: 0.75rem;
      opacity: 0.8;
      background: rgba(0,0,0,0.3);
      padding: 2px 8px;
      border-radius: 10px;
      margin-top: 4px;
    }

    .day-night-indicator {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 1.8rem;
      animation: float 3s ease-in-out infinite;
      padding: 8px;
      background: rgba(0,0,0,0.3);
      border-radius: 50%;
      backdrop-filter: blur(5px);
      border: 2px solid rgba(255,255,255,0.2);
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-8px) rotate(5deg); }
    }

    .timezone-offset {
      color: #888;
      font-size: 0.8rem;
      margin-top: 5px;
    }

    .loading {
      display: none;
      text-align: center;
      padding: 40px 20px;
      color: #FFD700;
      font-size: 1.2rem;
      background: rgba(255,255,255,0.05);
      border-radius: 15px;
      margin: 20px auto;
      max-width: 400px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,215,0,0.3);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 1; }
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(255,215,0,0.9);
      color: #000;
      padding: 15px 20px;
      border-radius: 10px;
      z-index: 1001;
      transform: translateX(400px);
      transition: transform 0.3s ease;
    }

    .notification.show {
      transform: translateX(0);
    }

    .about-content h2 {
      color: #FFA500;
      margin-top: 30px;
    }

    .about-content p, .about-content ul {
      font-size: 1.1rem;
      line-height: 1.9;
      color: #ccc;
    }

    .about-content ul {
      padding-right: 20px;
      list-style-position: outside;
    }

    [lang="en"] .about-content ul {
      padding-right: 0;
      padding-left: 20px;
    }

    .about-content a {
      color: #00BFFF;
      text-decoration: none;
    }

    .about-content a:hover {
      text-decoration: underline;
    }

    .lang-switch {
      margin-top: 20px;
      text-align: center;
    }

    .lang-switch button {
      background-color: #FFD700;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      color: #000;
    }

    .lang-switch button:hover {
      background-color: #FFA500;
    }

    .no-results {
      text-align: center;
      padding: 20px;
      color: #FFD700;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/luxon/3.4.4/luxon.min.js"></script>

  <div class="floating-clock" id="local-clock">
    <div class="local-label" style="font-size: 0.8rem; color: #FFD700;"> التوقيت المحلي</div>
    <div style="font-size: 1.1rem; font-weight: bold;" id="local-time">--:--:--</div>
  </div>

  <div class="notification" id="notification"></div>

  <header class="header">
    <h1 class="project-title">🌍ساعة رقمية عالمية </h1>
    <p class="subtitle">استكشف أوقات العالم مع المعلومات الجغرافية والثقافية</p>
    
    <div class="controls">
      <button class="btn" onclick="openAboutModal()"> نبذة عن المشروع</button>
      <button class="btn" onclick="toggleFullscreen()"> ملء الشاشة</button>
      <button class="btn" onclick="exportData()"> تصدير البيانات</button>
      <button class="btn" onclick="refreshClocks()"> تحديث</button>
      <button class="btn" onclick="toggleLanguage()"> تغيير اللغة</button>
    </div>

    <div class="search-container">
      <input type="text" class="search-input" id="search-input" placeholder=" البحث عن دولة..." oninput="filterCountries()">
    </div>

    <div class="continent-filter" id="continent-filter">
      <button class="continent-btn active" onclick="filterByContinent('all')">
        <div class="continent-icon">🌍</div>
        <div class="continent-name">الكل</div>
        <div class="continent-count" id="all-count">0</div>
      </button>
      <button class="continent-btn" onclick="filterByContinent('asia')">
        <div class="continent-icon">🏯</div>
        <div class="continent-name">آسيا</div>
        <div class="continent-count" id="asia-count">0</div>
      </button>
      <button class="continent-btn" onclick="filterByContinent('africa')">
        <div class="continent-icon">🦒</div>
        <div class="continent-name">أفريقيا</div>
        <div class="continent-count" id="africa-count">0</div>
      </button>
      <button class="continent-btn" onclick="filterByContinent('europe')">
        <div class="continent-icon">🏰</div>
        <div class="continent-name">أوروبا</div>
        <div class="continent-count" id="europe-count">0</div>
      </button>
      <button class="continent-btn" onclick="filterByContinent('america')">
        <div class="continent-icon">🗽</div>
        <div class="continent-name">الأمريكتان</div>
        <div class="continent-count" id="america-count">0</div>
      </button>
      <button class="continent-btn" onclick="filterByContinent('oceania')">
        <div class="continent-icon">🏄</div>
        <div class="continent-name">أوقيانوسيا</div>
        <div class="continent-count" id="oceania-count">0</div>
      </button>
    </div>

    <div class="stats-bar">
      <div class="stat-item">
        <div class="stat-number" id="total-countries">0</div>
        <div class="stat-label">إجمالي الدول</div>
      </div>
      <div class="stat-item">
        <div class="stat-number" id="day-countries">0</div>
        <div class="stat-label">دول في النهار</div>
      </div>
      <div class="stat-item">
        <div class="stat-number" id="night-countries">0</div>
        <div class="stat-label">دول في الليل</div>
      </div>
      <div class="stat-item">
        <div class="stat-number" id="timezones-count">0</div>
        <div class="stat-label">المناطق الزمنية</div>
      </div>
    </div>
  </header>

  <main>
    <div class="loading" id="loading">⏳ جاري تحديث البيانات...</div>
    <div class="clock-container" id="clocks"></div>
  </main>

  <div class="modal" id="country-modal">
    <div class="modal-content">
      <button class="close-btn" onclick="closeModal()">×</button>
      <div class="modal-header">
        <h2 class="modal-title" id="modal-country-name"></h2>
        <div id="modal-country-flag" style="font-size: 3rem;"></div>
      </div>
      <div class="country-details" id="country-details"></div>
    </div>
  </div>

  <div class="modal" id="about-modal">
    <div class="modal-content">
      <button class="close-btn" onclick="closeModal()">×</button>
      <div class="modal-header">
        <h2 class="modal-title"> نبذة عن المشروع</h2>
      </div>
      <div class="about-content" id="about-content-ar">
        <p>
          هذا المشروع هو مبادرة تقنية إبداعية من تطوير <strong>عبد الصمد بوركيبات</strong>، باحث في <strong>فقه الأمن السيبراني الأسري</strong>، وطالب في:
        </p>
        <ul>
          <li>🎓 بكالوريوس علوم الحاسوب – <strong>جامعة الشعب الأمريكية</strong></li>
          <li>🕋 بكالوريوس علوم القرآن الكريم – <strong>جامعة المدينة العالمية بماليزيا</strong></li>
        </ul>
        <h2> فكرة المشروع:</h2>
        <p>
          تم تطوير هذا المشروع لعرض التوقيت العالمي الحقيقي لأكثر من 40 دولة، مع دعم كامل للتقويمين <strong>الميلادي والهجري</strong>، وتحديد حالة <strong>الليل والنهار</strong>، وأوقات الصلاة لكل دولة بدقة، في واجهة مرئية متقدمة وسهلة الاستخدام.
        </p>
        <h2>أهداف المشروع:</h2>
        <ul>
          <li>التوعية بالزمن العالمي وترسيخ احترام الوقت.</li>
          <li>تعزيز الهوية السيبرانية الثقافية والأخلاقية.</li>
          <li>دمج القيم الإسلامية في تصميمات رقمية عصرية.</li>
          <li>نشر وعي الأسرة بأهمية الزمن في السياق السيبراني.</li>
        </ul>
        <h2>⚙️ مميزات تقنية:</h2>
        <ul>
          <li>يعرض الوقت الحقيقي لكل دولة بتنسيق سهل القراءة.</li>
          <li>يدمج التقويم الميلادي والهجري في كل بطاقة زمنية.</li>
          <li>يعرض أوقات الصلاة باستخدام Aladhan API.</li>
          <li>تمييز تلقائي بين الليل والنهار حسب التوقيت المحلي للدولة.</li>
          <li>تصميم متجاوب، مرن، ومناسب لجميع الأجهزة.</li>
          <li>معلومات الطقس في الوقت الحقيقي باستخدام OpenWeatherMap API.</li>
        </ul>
        <p>
          يمكن الوصول إلى الكود المصدري للمشروع على منصة GitHub:
          <a href="https://github.com/ABDESSAMAD-BOURKIBATE/DigitalWorldClock" target="_blank">
            DigitalWorldClock على GitHub
          </a>
        </p>
        <div class="lang-switch">
          <button onclick="toggleAboutLang('en')">🌐 English Version</button>
        </div>
      </div>
      <div class="about-content" id="about-content-en" style="display: none;">
        <p>
          This project is a creative and technical initiative developed by <strong>Abdessamad Bourkibate</strong>, a researcher in <strong>Family Cybersecurity Jurisprudence</strong>, and a student of:
        </p>
        <ul>
          <li>🎓 Bachelor in Computer Science – <strong>University of the People (USA)</strong></li>
          <li>🕋 Bachelor in Quranic Sciences – <strong>Al-Madinah International University (Malaysia)</strong></li>
        </ul>
        <h2> Project Concept:</h2>
        <p>
          A visual web application that displays the real-time clocks of over 40 countries, with integrated <strong>Gregorian and Hijri calendars</strong>, a dynamic indicator of <strong>day or night</strong>, and prayer times for each country.
        </p>
        <h2> Project Goals:</h2>
        <ul>
          <li>Promote awareness of global time and its ethical significance.</li>
          <li>Bridge Islamic values with digital design practices.</li>
          <li>Promote family-based time mindfulness in cyberspace.</li>
          <li>Reinforce ethical cyber identity in a modern interface.</li>
        </ul>
        <h2>⚙️ Technical Features:</h2>
        <ul>
          <li>Real-time display for each selected country.</li>
          <li>Dual calendar support (Gregorian and Hijri).</li>
          <li>Prayer times integration using Aladhan API.</li>
          <li>Visual differentiation between day and night per timezone.</li>
          <li>Responsive and user-friendly interface.</li>
          <li>Real-time weather information using OpenWeatherMap API.</li>
        </ul>
        <p>
          Source code available on GitHub:
          <a href="https://github.com/ABDESSAMAD-BOURKIBATE/DigitalWorldClock" target="_blank">
            DigitalWorldClock on GitHub
          </a>
        </p>
        <div class="lang-switch">
          <button onclick="toggleAboutLang('ar')">🌐 النسخة العربية</button>
        </div>
      </div>
    </div>
  </div>

  <footer class="copyright">
    <p>حقوق النشر © عبد الصمد بوركيبات - 2025</p>
  </footer>

  <script>
    const { DateTime } = luxon;

    // Language settings
    let currentLanguage = 'ar';
    const translations = {
      ar: {
        title: 'ساعة رقمية عالمية  ',
        subtitle: 'استكشف أوقات العالم مع المعلومات الجغرافية والثقافية',
        localClock: ' التوقيت المحلي',
        aboutBtn: ' نبذة عن المشروع',
        fullscreenBtn: ' ملء الشاشة',
        exportBtn: ' تصدير البيانات',
        refreshBtn: ' تحديث',
        langBtn: ' تغيير اللغة',
        searchPlaceholder: ' البحث عن دولة...',
        noResults: 'لم يتم العثور على دول تطابق البحث',
        allContinents: 'الكل',
        all: 'الكل',
        asia: 'آسيا',
        africa: 'أفريقيا',
        europe: 'أوروبا',
        america: 'الأمريكتان',
        americas: 'الأمريكتان',
        oceania: 'أوقيانوسيا',
        countries: 'دولة',
        showingCountries: 'عرض دول',
        totalCountries: 'إجمالي الدول',
        dayCountries: 'دول في النهار',
        nightCountries: 'دول في الليل',
        timezones: 'المناطق الزمنية',
        loading: '⏳ جاري تحديث البيانات...',
        aboutTitle: ' نبذة عن المشروع',
        copyright: 'حقوق النشر © عبد الصمد بوركيبات - 2025',
        capital: 'العاصمة',
        time: 'التوقيت',
        continent: 'القارة',
        weather: 'الطقس',
        description: 'الوصف',
        leader: 'القائد',
        population: 'السكان',
        timezone: 'المنطقة الزمنية',
        coordinates: 'الإحداثيات',
        area: 'المساحة',
        currency: 'العملة',
        language: 'اللغة',
        weatherTemp: 'درجة الحرارة',
        weatherCondition: 'الحالة',
        weatherHumidity: 'الرطوبة',
        weatherWind: 'الرياح',
        prayerTimes: 'أوقات الصلاة',
        fajr: 'الفجر',
        dhuhr: 'الظهر',
        asr: 'العصر',
        maghrib: 'المغرب',
        isha: 'العشاء',
        notifications: {
          fullscreenOn: 'تم تفعيل وضع ملء الشاشة',
          fullscreenOff: 'تم الخروج من وضع ملء الشاشة',
          fullscreenError: 'فشل تفعيل وضع ملء الشاشة',
          dataExported: 'تم تصدير البيانات بنجاح',
          clocksRefreshed: 'تم تحديث الساعات',
          langChanged: 'تم تغيير اللغة',
          weatherError: 'فشل تحميل بيانات الطقس: تحقق من مفتاح API أو الاتصال بالإنترنت',
          invalidApiKey: 'مفتاح API غير صالح، يرجى التسجيل في OpenWeatherMap',
          noResults: 'لم يتم العثور على نتائج',
          networkError: 'لا يوجد اتصال بالإنترنت'
        }
      },
      en: {
        title: ' Enhanced World Clock',
        subtitle: 'Explore world times with geographic and cultural information',
        localClock: ' Local Time',
        aboutBtn: ' About the Project',
        fullscreenBtn: ' Fullscreen',
        exportBtn: ' Export Data',
        refreshBtn: ' Refresh',
        langBtn: ' Change Language',
        searchPlaceholder: ' Search for a country...',
        noResults: 'No countries found matching the search',
        allContinents: 'All',
        all: 'All',
        asia: 'Asia',
        africa: 'Africa',
        europe: 'Europe',
        america: 'Americas',
        americas: 'Americas',
        oceania: 'Oceania',
        countries: 'countries',
        showingCountries: 'Showing countries in',
        totalCountries: 'Total Countries',
        dayCountries: 'Countries in Daytime',
        nightCountries: 'Countries at Night',
        timezones: 'Time Zones',
        loading: '⏳ Updating data...',
        aboutTitle: ' About the Project',
        copyright: 'Copyright © Abdessamad Bourkibate - 2025',
        capital: 'Capital',
        time: 'Time',
        continent: 'Continent',
        weather: 'Weather',
        description: 'Description',
        leader: 'Leader',
        population: 'Population',
        timezone: 'Time Zone',
        coordinates: 'Coordinates',
        area: 'Area',
        currency: 'Currency',
        language: 'Language',
        weatherTemp: 'Temperature',
        weatherCondition: 'Condition',
        weatherHumidity: 'Humidity',
        weatherWind: 'Wind',
        prayerTimes: 'Prayer Times',
        fajr: 'Fajr',
        dhuhr: 'Dhuhr',
        asr: 'Asr',
        maghrib: 'Maghrib',
        isha: 'Isha',
        notifications: {
          fullscreenOn: 'Fullscreen mode activated',
          fullscreenOff: 'Exited fullscreen mode',
          fullscreenError: 'Failed to activate fullscreen mode',
          dataExported: 'Data exported successfully',
          clocksRefreshed: 'Clocks updated',
          langChanged: 'Language changed',
          weatherError: 'Failed to load weather data: Check API key or internet connection',
          invalidApiKey: 'Invalid API key, please sign up at OpenWeatherMap',
          noResults: 'No results found',
          networkError: 'No internet connection'
        }
      }
    };

    // Countries array with weather coordinates
    const countries = [
      // Asian Countries
      {
        name: 'المملكة العربية السعودية',
        nameEn: 'Saudi Arabia',
        capital: 'الرياض',
        capitalEn: 'Riyadh',
        zone: 'Asia/Riyadh',
        coordinates: '24.7136,46.6753',
        color: '#00FF7F',
        continent: 'asia',
        leader: 'الملك سلمان بن عبد العزيز آل سعود',
        leaderEn: 'King Salman bin Abdulaziz Al Saud',
        population: '35 مليون نسمة',
        populationEn: '35 million',
        area: '2.15 مليون كم²',
        areaEn: '2.15 million km²',
        currency: 'الريال السعودي',
        currencyEn: 'Saudi Riyal',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'المملكة العربية السعودية، مهد الإسلام وموطن الحرمين الشريفين',
        descriptionEn: 'Saudi Arabia, birthplace of Islam and home to the Two Holy Mosques',
        flagCode: 'sa'
      },
      {
        name: 'دولة الإمارات العربية المتحدة',
        nameEn: 'United Arab Emirates',
        capital: 'أبو ظبي',
        capitalEn: 'Abu Dhabi',
        zone: 'Asia/Dubai',
        coordinates: '25.2048,55.2708',
        color: '#FF6B35',
        continent: 'asia',
        leader: 'الشيخ محمد بن زايد آل نهيان',
        leaderEn: 'Sheikh Mohamed bin Zayed Al Nahyan',
        population: '10 مليون نسمة',
        populationEn: '10 million',
        area: '83,600 كم²',
        areaEn: '83,600 km²',
        currency: 'الدرهم الإماراتي',
        currencyEn: 'UAE Dirham',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'دولة الإمارات العربية المتحدة، عاصمة التجارة والابتكار في الشرق الأوسط',
        descriptionEn: 'United Arab Emirates, capital of trade and innovation in the Middle East',
        flagCode: 'ae'
      },
      {
        name: 'دولة قطر',
        nameEn: 'Qatar',
        capital: 'الدوحة',
        capitalEn: 'Doha',
        zone: 'Asia/Qatar',
        coordinates: '25.3548,51.1839',
        color: '#8B0000',
        continent: 'asia',
        leader: 'الشيخ تميم بن حمد آل ثاني',
        leaderEn: 'Sheikh Tamim bin Hamad Al Thani',
        population: '2.9 مليون نسمة',
        populationEn: '2.9 million',
        area: '11,586 كم²',
        areaEn: '11,586 km²',
        currency: 'الريال القطري',
        currencyEn: 'Qatari Riyal',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'دولة قطر، لؤلؤة الخليج العربي ومضيفة كأس العالم 2022',
        descriptionEn: 'Qatar, pearl of the Arabian Gulf and host of FIFA World Cup 2022',
        flagCode: 'qa'
      },
      {
        name: 'دولة الكويت',
        nameEn: 'Kuwait',
        capital: 'مدينة الكويت',
        capitalEn: 'Kuwait City',
        zone: 'Asia/Kuwait',
        coordinates: '29.3117,47.4818',
        color: '#008000',
        continent: 'asia',
        leader: 'الشيخ مشعل الأحمد الجابر الصباح',
        leaderEn: 'Sheikh Mishal Al-Ahmad Al-Jaber Al-Sabah',
        population: '4.3 مليون نسمة',
        populationEn: '4.3 million',
        area: '17,818 كم²',
        areaEn: '17,818 km²',
        currency: 'الدينار الكويتي',
        currencyEn: 'Kuwaiti Dinar',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'دولة الكويت، إحدى أغنى دول العالم بالنفط',
        descriptionEn: 'Kuwait, one of the world\'s richest oil nations',
        flagCode: 'kw'
      },
      {
        name: 'مملكة البحرين',
        nameEn: 'Bahrain',
        capital: 'المنامة',
        capitalEn: 'Manama',
        zone: 'Asia/Bahrain',
        coordinates: '26.0667,50.5577',
        color: '#DC143C',
        continent: 'asia',
        leader: 'الملك حمد بن عيسى آل خليفة',
        leaderEn: 'King Hamad bin Isa Al Khalifa',
        population: '1.7 مليون نسمة',
        populationEn: '1.7 million',
        area: '765 كم²',
        areaEn: '765 km²',
        currency: 'الدينار البحريني',
        currencyEn: 'Bahraini Dinar',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'مملكة البحرين، لؤلؤة الخليج العربي',
        descriptionEn: 'Bahrain, pearl of the Arabian Gulf',
        flagCode: 'bh'
      },
      {
        name: 'سلطنة عُمان',
        nameEn: 'Oman',
        capital: 'مسقط',
        capitalEn: 'Muscat',
        zone: 'Asia/Muscat',
        coordinates: '23.5859,58.4059',
        color: '#FF69B4',
        continent: 'asia',
        leader: 'السلطان هيثم بن طارق آل سعيد',
        leaderEn: 'Sultan Haitham bin Tariq Al Said',
        population: '5.1 مليون نسمة',
        populationEn: '5.1 million',
        area: '309,500 كم²',
        areaEn: '309,500 km²',
        currency: 'الريال العُماني',
        currencyEn: 'Omani Rial',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'سلطنة عُمان، أرض الحضارة والتاريخ العريق',
        descriptionEn: 'Oman, land of civilization and ancient history',
        flagCode: 'om'
      },
      {
        name: 'المملكة الأردنية الهاشمية',
        nameEn: 'Jordan',
        capital: 'عمّان',
        capitalEn: 'Amman',
        zone: 'Asia/Amman',
        coordinates: '31.9539,35.9106',
        color: '#000000',
        continent: 'asia',
        leader: 'الملك عبد الله الثاني بن الحسين',
        leaderEn: 'King Abdullah II bin Al-Hussein',
        population: '10.2 مليون نسمة',
        populationEn: '10.2 million',
        area: '89,342 كم²',
        areaEn: '89,342 km²',
        currency: 'الدينار الأردني',
        currencyEn: 'Jordanian Dinar',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'المملكة الأردنية الهاشمية، حارسة المقدسات الإسلامية والمسيحية',
        descriptionEn: 'Jordan, guardian of Islamic and Christian holy sites',
        flagCode: 'jo'
      },
      {
        name: 'الجمهورية اللبنانية',
        nameEn: 'Lebanon',
        capital: 'بيروت',
        capitalEn: 'Beirut',
        zone: 'Asia/Beirut',
        coordinates: '33.8938,35.5018',
        color: '#228B22',
        continent: 'asia',
        leader: 'ميشال عون',
        leaderEn: 'Michel Aoun',
        population: '6.8 مليون نسمة',
        populationEn: '6.8 million',
        area: '10,452 كم²',
        areaEn: '10,452 km²',
        currency: 'الليرة اللبنانية',
        currencyEn: 'Lebanese Pound',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'الجمهورية اللبنانية، سويسرا الشرق الأوسط',
        descriptionEn: 'Lebanon, Switzerland of the Middle East',
        flagCode: 'lb'
      },
      {
        name: 'الجمهورية العربية السورية',
        nameEn: 'Syria',
        capital: 'دمشق',
        capitalEn: 'Damascus',
        zone: 'Asia/Damascus',
        coordinates: '33.5138,36.2765',
        color: '#FF0000',
        continent: 'asia',
        leader: 'بشار الأسد',
        leaderEn: 'Bashar al-Assad',
        population: '18 مليون نسمة',
        populationEn: '18 million',
        area: '185,180 كم²',
        areaEn: '185,180 km²',
        currency: 'الليرة السورية',
        currencyEn: 'Syrian Pound',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'الجمهورية العربية السورية، مهد الحضارات',
        descriptionEn: 'Syria, cradle of civilizations',
        flagCode: 'sy'
      },
      {
        name: 'جمهورية العراق',
        nameEn: 'Iraq',
        capital: 'بغداد',
        capitalEn: 'Baghdad',
        zone: 'Asia/Baghdad',
        coordinates: '33.3152,44.3661',
        color: '#8B0000',
        continent: 'asia',
        leader: 'عبد اللطيف رشيد',
        leaderEn: 'Abdul Latif Rashid',
        population: '40 مليون نسمة',
        populationEn: '40 million',
        area: '438,317 كم²',
        areaEn: '438,317 km²',
        currency: 'الدينار العراقي',
        currencyEn: 'Iraqi Dinar',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'جمهورية العراق، أرض الرافدين ومهد الحضارة',
        descriptionEn: 'Iraq, land of Mesopotamia and cradle of civilization',
        flagCode: 'iq'
      },
      {
        name: 'الجمهورية الإسلامية الإيرانية',
        nameEn: 'Iran',
        capital: 'طهران',
        capitalEn: 'Tehran',
        zone: 'Asia/Tehran',
        coordinates: '35.6892,51.3890',
        color: '#239B56',
        continent: 'asia',
        leader: 'علي خامنئي',
        leaderEn: 'Ali Khamenei',
        population: '84 مليون نسمة',
        populationEn: '84 million',
        area: '1,648,195 كم²',
        areaEn: '1,648,195 km²',
        currency: 'الريال الإيراني',
        currencyEn: 'Iranian Rial',
        language: 'الفارسية',
        languageEn: 'Persian',
        description: 'الجمهورية الإسلامية الإيرانية، أرض الحضارة الفارسية العريقة',
        descriptionEn: 'Iran, land of ancient Persian civilization',
        flagCode: 'ir'
      },
      {
        name: 'جمهورية أفغانستان الإسلامية',
        nameEn: 'Afghanistan',
        capital: 'كابول',
        capitalEn: 'Kabul',
        zone: 'Asia/Kabul',
        coordinates: '34.5553,69.2075',
        color: '#DC143C',
        continent: 'asia',
        leader: 'هبة الله أخوند زاده',
        leaderEn: 'Hibatullah Akhundzada',
        population: '39 مليون نسمة',
        populationEn: '39 million',
        area: '652,230 كم²',
        areaEn: '652,230 km²',
        currency: 'الأفغاني',
        currencyEn: 'Afghan Afghani',
        language: 'الداري والبشتو',
        languageEn: 'Dari and Pashto',
        description: 'جمهورية أفغانستان الإسلامية، مفترق طرق آسيا',
        descriptionEn: 'Afghanistan, crossroads of Asia',
        flagCode: 'af'
      },
      {
        name: 'جمهورية باكستان الإسلامية',
        nameEn: 'Pakistan',
        capital: 'إسلام أباد',
        capitalEn: 'Islamabad',
        zone: 'Asia/Karachi',
        coordinates: '30.3753,69.3451',
        color: '#228B22',
        continent: 'asia',
        leader: 'عارف علوي',
        leaderEn: 'Arif Alvi',
        population: '225 مليون نسمة',
        populationEn: '225 million',
        area: '881,913 كم²',
        areaEn: '881,913 km²',
        currency: 'الروبية الباكستانية',
        currencyEn: 'Pakistani Rupee',
        language: 'الأردية والإنجليزية',
        languageEn: 'Urdu and English',
        description: 'جمهورية باكستان الإسلامية، أرض الطهر والإيمان',
        descriptionEn: 'Pakistan, land of the pure and faithful',
        flagCode: 'pk'
      },
      {
        name: 'جمهورية الهند',
        nameEn: 'India',
        capital: 'نيودلهي',
        capitalEn: 'New Delhi',
        zone: 'Asia/Kolkata',
        coordinates: '20.5937,78.9629',
        color: '#FF6600',
        continent: 'asia',
        leader: 'نارندرا مودي',
        leaderEn: 'Narendra Modi',
        population: '1.4 مليار نسمة',
        populationEn: '1.4 billion',
        area: '3,287,263 كم²',
        areaEn: '3,287,263 km²',
        currency: 'الروبية الهندية',
        currencyEn: 'Indian Rupee',
        language: 'الهندية والإنجليزية',
        languageEn: 'Hindi and English',
        description: 'جمهورية الهند، أكبر ديمقراطية في العالم',
        descriptionEn: 'India, world\'s largest democracy',
        flagCode: 'in'
      },
      {
        name: 'جمهورية بنغلاديش الشعبية',
        nameEn: 'Bangladesh',
        capital: 'دكا',
        capitalEn: 'Dhaka',
        zone: 'Asia/Dhaka',
        coordinates: '23.6850,90.3563',
        color: '#006A4E',
        continent: 'asia',
        leader: 'محمد شهاب الدين',
        leaderEn: 'Mohammed Shahabuddin',
        population: '165 مليون نسمة',
        populationEn: '165 million',
        area: '147,570 كم²',
        areaEn: '147,570 km²',
        currency: 'التاكا البنغلاديشية',
        currencyEn: 'Bangladeshi Taka',
        language: 'البنغالية',
        languageEn: 'Bengali',
        description: 'جمهورية بنغلاديش الشعبية، أرض الأنهار والدلتا',
        descriptionEn: 'Bangladesh, land of rivers and deltas',
        flagCode: 'bd'
      },
      {
        name: 'جمهورية سريلانكا الديمقراطية الاشتراكية',
        nameEn: 'Sri Lanka',
        capital: 'كولومبو',
        capitalEn: 'Colombo',
        zone: 'Asia/Colombo',
        coordinates: '7.8731,80.7718',
        color: '#FFD700',
        continent: 'asia',
        leader: 'رانيل ويكرمسينغه',
        leaderEn: 'Ranil Wickremesinghe',
        population: '22 مليون نسمة',
        populationEn: '22 million',
        area: '65,610 كم²',
        areaEn: '65,610 km²',
        currency: 'الروبية السريلانكية',
        currencyEn: 'Sri Lankan Rupee',
        language: 'السنهالية والتاميلية',
        languageEn: 'Sinhala and Tamil',
        description: 'سريلانكا، لؤلؤة المحيط الهندي',
        descriptionEn: 'Sri Lanka, pearl of the Indian Ocean',
        flagCode: 'lk'
      },
      {
        name: 'جمهورية جزر المالديف',
        nameEn: 'Maldives',
        capital: 'ماليه',
        capitalEn: 'Male',
        zone: 'Indian/Maldives',
        coordinates: '3.2028,73.2207',
        color: '#0099CC',
        continent: 'asia',
        leader: 'محمد مويزو',
        leaderEn: 'Mohamed Muizzu',
        population: '540 ألف نسمة',
        populationEn: '540 thousand',
        area: '298 كم²',
        areaEn: '298 km²',
        currency: 'الروفيا المالديفية',
        currencyEn: 'Maldivian Rufiyaa',
        language: 'الديفيهي',
        languageEn: 'Dhivehi',
        description: 'جزر المالديف، جنة استوائية في المحيط الهندي',
        descriptionEn: 'Maldives, tropical paradise in the Indian Ocean',
        flagCode: 'mv'
      },
      {
        name: 'جمهورية الصين الشعبية',
        nameEn: 'China',
        capital: 'بكين',
        capitalEn: 'Beijing',
        zone: 'Asia/Shanghai',
        coordinates: '35.8617,104.1954',
        color: '#FF0000',
        continent: 'asia',
        leader: 'شي جين بينغ',
        leaderEn: 'Xi Jinping',
        population: '1.4 مليار نسمة',
        populationEn: '1.4 billion',
        area: '9,596,960 كم²',
        areaEn: '9,596,960 km²',
        currency: 'اليوان الصيني',
        currencyEn: 'Chinese Yuan',
        language: 'الصينية المنديرية',
        languageEn: 'Mandarin Chinese',
        description: 'جمهورية الصين الشعبية، أكبر دولة في العالم من حيث عدد السكان',
        descriptionEn: 'China, world\'s most populous country',
        flagCode: 'cn'
      },
      {
        name: 'اليابان',
        nameEn: 'Japan',
        capital: 'طوكيو',
        capitalEn: 'Tokyo',
        zone: 'Asia/Tokyo',
        coordinates: '36.2048,138.2529',
        color: '#FF0000',
        continent: 'asia',
        leader: 'فوميو كيشيدا',
        leaderEn: 'Fumio Kishida',
        population: '125 مليون نسمة',
        populationEn: '125 million',
        area: '377,975 كم²',
        areaEn: '377,975 km²',
        currency: 'الين الياباني',
        currencyEn: 'Japanese Yen',
        language: 'اليابانية',
        languageEn: 'Japanese',
        description: 'اليابان، أرض الشمس المشرقة والتكنولوجيا المتقدمة',
        descriptionEn: 'Japan, land of the rising sun and advanced technology',
        flagCode: 'jp'
      },
      {
        name: 'جمهورية كوريا',
        nameEn: 'South Korea',
        capital: 'سول',
        capitalEn: 'Seoul',
        zone: 'Asia/Seoul',
        coordinates: '35.9078,127.7669',
        color: '#0047AB',
        continent: 'asia',
        leader: 'يون سوك يول',
        leaderEn: 'Yoon Suk-yeol',
        population: '52 مليون نسمة',
        populationEn: '52 million',
        area: '100,210 كم²',
        areaEn: '100,210 km²',
        currency: 'الوون الكوري الجنوبي',
        currencyEn: 'South Korean Won',
        language: 'الكورية',
        languageEn: 'Korean',
        description: 'كوريا الجنوبية، قوة تكنولوجية وثقافية عالمية',
        descriptionEn: 'South Korea, global technological and cultural power',
        flagCode: 'kr'
      },
      {
        name: 'جمهورية كوريا الشعبية الديمقراطية',
        nameEn: 'North Korea',
        capital: 'بيونغ يانغ',
        capitalEn: 'Pyongyang',
        zone: 'Asia/Pyongyang',
        coordinates: '40.3399,127.5101',
        color: '#FF0000',
        continent: 'asia',
        leader: 'كيم جونغ أون',
        leaderEn: 'Kim Jong-un',
        population: '26 مليون نسمة',
        populationEn: '26 million',
        area: '120,540 كم²',
        areaEn: '120,540 km²',
        currency: 'الوون الكوري الشمالي',
        currencyEn: 'North Korean Won',
        language: 'الكورية',
        languageEn: 'Korean',
        description: 'كوريا الشمالية، الجمهورية الشعبية الديمقراطية',
        descriptionEn: 'North Korea, Democratic People\'s Republic',
        flagCode: 'kp'
      },
      {
        name: 'منغوليا',
        nameEn: 'Mongolia',
        capital: 'أولان باتور',
        capitalEn: 'Ulaanbaatar',
        zone: 'Asia/Ulaanbaatar',
        coordinates: '46.8625,103.8467',
        color: '#0033A0',
        continent: 'asia',
        leader: 'أوخناغين خورلسوخ',
        leaderEn: 'Ukhnaagiin Khürelsükh',
        population: '3.3 مليون نسمة',
        populationEn: '3.3 million',
        area: '1,564,110 كم²',
        areaEn: '1,564,110 km²',
        currency: 'التوغريك المنغولي',
        currencyEn: 'Mongolian Tugrik',
        language: 'المنغولية',
        languageEn: 'Mongolian',
        description: 'منغوليا، أرض السهوب الواسعة والرعاة الرحل',
        descriptionEn: 'Mongolia, land of vast steppes and nomadic herders',
        flagCode: 'mn'
      },
      {
        name: 'مملكة تايلاند',
        nameEn: 'Thailand',
        capital: 'بانكوك',
        capitalEn: 'Bangkok',
        zone: 'Asia/Bangkok',
        coordinates: '15.8700,100.9925',
        color: '#FF0000',
        continent: 'asia',
        leader: 'سريثا ثافيسين',
        leaderEn: 'Srettha Thavisin',
        population: '70 مليون نسمة',
        populationEn: '70 million',
        area: '513,120 كم²',
        areaEn: '513,120 km²',
        currency: 'الباهت التايلاندي',
        currencyEn: 'Thai Baht',
        language: 'التايلاندية',
        languageEn: 'Thai',
        description: 'تايلاند، أرض الابتسامات والمعابد الذهبية',
        descriptionEn: 'Thailand, land of smiles and golden temples',
        flagCode: 'th'
      },
      {
        name: 'جمهورية فيتنام الاشتراكية',
        nameEn: 'Vietnam',
        capital: 'هانوي',
        capitalEn: 'Hanoi',
        zone: 'Asia/Ho_Chi_Minh',
        coordinates: '14.0583,108.2772',
        color: '#FF0000',
        continent: 'asia',
        leader: 'فو مينه تشينه',
        leaderEn: 'Pham Minh Chinh',
        population: '98 مليون نسمة',
        populationEn: '98 million',
        area: '331,212 كم²',
        areaEn: '331,212 km²',
        currency: 'الدونغ الفيتنامي',
        currencyEn: 'Vietnamese Dong',
        language: 'الفيتنامية',
        languageEn: 'Vietnamese',
        description: 'فيتنام، أرض التنين الصاعد والتاريخ العريق',
        descriptionEn: 'Vietnam, land of the rising dragon and ancient history',
        flagCode: 'vn'
      },
      {
        name: 'جمهورية الفلبين',
        nameEn: 'Philippines',
        capital: 'مانيلا',
        capitalEn: 'Manila',
        zone: 'Asia/Manila',
        coordinates: '12.8797,121.7740',
        color: '#0038A8',
        continent: 'asia',
        leader: 'فرديناند ماركوس جونيور',
        leaderEn: 'Ferdinand Marcos Jr.',
        population: '110 مليون نسمة',
        populationEn: '110 million',
        area: '300,000 كم²',
        areaEn: '300,000 km²',
        currency: 'البيزو الفلبيني',
        currencyEn: 'Philippine Peso',
        language: 'الفلبينية والإنجليزية',
        languageEn: 'Filipino and English',
        description: 'الفلبين، لؤلؤة المحيط الهادئ وأرض الجزر الألف',
        descriptionEn: 'Philippines, pearl of the Pacific and land of a thousand islands',
        flagCode: 'ph'
      },
      {
        name: 'جمهورية إندونيسيا',
        nameEn: 'Indonesia',
        capital: 'جاكرتا',
        capitalEn: 'Jakarta',
        zone: 'Asia/Jakarta',
        coordinates: '-0.7893,113.9213',
        color: '#FF0000',
        continent: 'asia',
        leader: 'جوكو ويدودو',
        leaderEn: 'Joko Widodo',
        population: '274 مليون نسمة',
        populationEn: '274 million',
        area: '1,904,569 كم²',
        areaEn: '1,904,569 km²',
        currency: 'الروبية الإندونيسية',
        currencyEn: 'Indonesian Rupiah',
        language: 'الإندونيسية',
        languageEn: 'Indonesian',
        description: 'إندونيسيا، أكبر دولة أرخبيلية في العالم',
        descriptionEn: 'Indonesia, world\'s largest archipelagic country',
        flagCode: 'id'
      },
      {
        name: 'ماليزيا',
        nameEn: 'Malaysia',
        capital: 'كوالالمبور',
        capitalEn: 'Kuala Lumpur',
        zone: 'Asia/Kuala_Lumpur',
        coordinates: '4.2105,101.9758',
        color: '#FF0000',
        continent: 'asia',
        leader: 'أنور إبراهيم',
        leaderEn: 'Anwar Ibrahim',
        population: '33 مليون نسمة',
        populationEn: '33 million',
        area: '329,847 كم²',
        areaEn: '329,847 km²',
        currency: 'الرينغيت الماليزي',
        currencyEn: 'Malaysian Ringgit',
        language: 'الماليزية',
        languageEn: 'Malay',
        description: 'ماليزيا، أرض التنوع الثقافي والطبيعة الخلابة',
        descriptionEn: 'Malaysia, land of cultural diversity and stunning nature',
        flagCode: 'my'
      },
      {
        name: 'جمهورية سنغافورة',
        nameEn: 'Singapore',
        capital: 'سنغافورة',
        capitalEn: 'Singapore',
        zone: 'Asia/Singapore',
        coordinates: '1.3521,103.8198',
        color: '#FF0000',
        continent: 'asia',
        leader: 'لي هسين لونغ',
        leaderEn: 'Lee Hsien Loong',
        population: '5.9 مليون نسمة',
        populationEn: '5.9 million',
        area: '728 كم²',
        areaEn: '728 km²',
        currency: 'الدولار السنغافوري',
        currencyEn: 'Singapore Dollar',
        language: 'الإنجليزية والماليزية والصينية والتاميلية',
        languageEn: 'English, Malay, Chinese, and Tamil',
        description: 'سنغافورة، أسد آسيا والمركز المالي العالمي',
        descriptionEn: 'Singapore, lion of Asia and global financial center',
        flagCode: 'sg'
      },
      {
        name: 'سلطنة بروناي دار السلام',
        nameEn: 'Brunei',
        capital: 'بندر سري بكاوان',
        capitalEn: 'Bandar Seri Begawan',
        zone: 'Asia/Brunei',
        coordinates: '4.5353,114.7277',
        color: '#FFD700',
        continent: 'asia',
        leader: 'السلطان حسن البلقية',
        leaderEn: 'Sultan Hassanal Bolkiah',
        population: '440 ألف نسمة',
        populationEn: '440 thousand',
        area: '5,765 كم²',
        areaEn: '5,765 km²',
        currency: 'الدولار البروناي',
        currencyEn: 'Brunei Dollar',
        language: 'الماليزية',
        languageEn: 'Malay',
        description: 'بروناي، سلطنة الثراء والسلام',
        descriptionEn: 'Brunei, sultanate of wealth and peace',
        flagCode: 'bn'
      },
      {
        name: 'جمهورية لاو الديمقراطية الشعبية',
        nameEn: 'Laos',
        capital: 'فيينتيان',
        capitalEn: 'Vientiane',
        zone: 'Asia/Vientiane',
        coordinates: '19.8563,102.4955',
        color: '#CE1126',
        continent: 'asia',
        leader: 'ثونغلون سيسوليث',
        leaderEn: 'Thongloun Sisoulith',
        population: '7.3 مليون نسمة',
        populationEn: '7.3 million',
        area: '236,800 كم²',
        areaEn: '236,800 km²',
        currency: 'الكيب اللاوسي',
        currencyEn: 'Lao Kip',
        language: 'اللاوسية',
        languageEn: 'Lao',
        description: 'لاوس، أرض مليون فيل والطبيعة البكر',
        descriptionEn: 'Laos, land of a million elephants and pristine nature',
        flagCode: 'la'
      },
      {
        name: 'مملكة كمبوديا',
        nameEn: 'Cambodia',
        capital: 'بنوم بنه',
        capitalEn: 'Phnom Penh',
        zone: 'Asia/Phnom_Penh',
        coordinates: '12.5657,104.9910',
        color: '#032EA1',
        continent: 'asia',
        leader: 'هون مانيت',
        leaderEn: 'Hun Manet',
        population: '17 مليون نسمة',
        populationEn: '17 million',
        area: '181,035 كم²',
        areaEn: '181,035 km²',
        currency: 'الريال الكمبودي',
        currencyEn: 'Cambodian Riel',
        language: 'الخمير',
        languageEn: 'Khmer',
        description: 'كمبوديا، أرض معابد أنغكور والحضارة الخمير',
        descriptionEn: 'Cambodia, land of Angkor temples and Khmer civilization',
        flagCode: 'kh'
      },
      {
        name: 'جمهورية ميانمار الاتحادية',
        nameEn: 'Myanmar',
        capital: 'نايبيداو',
        capitalEn: 'Naypyidaw',
        zone: 'Asia/Yangon',
        coordinates: '21.9162,95.9560',
        color: '#FFCD00',
        continent: 'asia',
        leader: 'مين أونغ هلاينغ',
        leaderEn: 'Min Aung Hlaing',
        population: '54 مليون نسمة',
        populationEn: '54 million',
        area: '676,578 كم²',
        areaEn: '676,578 km²',
        currency: 'الكيات الميانماري',
        currencyEn: 'Myanmar Kyat',
        language: 'البورمية',
        languageEn: 'Burmese',
        description: 'ميانمار، أرض الباغودات الذهبية والتقاليد العريقة',
        descriptionEn: 'Myanmar, land of golden pagodas and ancient traditions',
        flagCode: 'mm'
      },
      {
        name: 'جمهورية أوزبكستان',
        nameEn: 'Uzbekistan',
        capital: 'طشقند',
        capitalEn: 'Tashkent',
        zone: 'Asia/Tashkent',
        coordinates: '41.3775,64.5853',
        color: '#0099B5',
        continent: 'asia',
        leader: 'شوكت ميرزياييف',
        leaderEn: 'Shavkat Mirziyoyev',
        population: '35 مليون نسمة',
        populationEn: '35 million',
        area: '448,978 كم²',
        areaEn: '448,978 km²',
        currency: 'السوم الأوزبكي',
        currencyEn: 'Uzbek Som',
        language: 'الأوزبكية',
        languageEn: 'Uzbek',
        description: 'أوزبكستان، جوهرة طريق الحرير وأرض الحضارات القديمة',
        descriptionEn: 'Uzbekistan, jewel of the Silk Road and land of ancient civilizations',
        flagCode: 'uz'
      },
      {
        name: 'جمهورية كازاخستان',
        nameEn: 'Kazakhstan',
        capital: 'نور سلطان',
        capitalEn: 'Nur-Sultan',
        zone: 'Asia/Almaty',
        coordinates: '48.0196,66.9237',
        color: '#00AFCA',
        continent: 'asia',
        leader: 'قاسم جومارت توكاييف',
        leaderEn: 'Kassym-Jomart Tokayev',
        population: '19 مليون نسمة',
        populationEn: '19 million',
        area: '2,724,900 كم²',
        areaEn: '2,724,900 km²',
        currency: 'التينغه الكازاخستاني',
        currencyEn: 'Kazakhstani Tenge',
        language: 'الكازاخية والروسية',
        languageEn: 'Kazakh and Russian',
        description: 'كازاخستان، أكبر دولة غير ساحلية في العالم',
        descriptionEn: 'Kazakhstan, world\'s largest landlocked country',
        flagCode: 'kz'
      },
      {
        name: 'قيرغيزستان',
        nameEn: 'Kyrgyzstan',
        capital: 'بيشكك',
        capitalEn: 'Bishkek',
        zone: 'Asia/Bishkek',
        coordinates: '41.2044,74.7661',
        color: '#FF0000',
        continent: 'asia',
        leader: 'صدر جاباروف',
        leaderEn: 'Sadyr Japarov',
        population: '6.6 مليون نسمة',
        populationEn: '6.6 million',
        area: '199,951 كم²',
        areaEn: '199,951 km²',
        currency: 'السوم القيرغيزي',
        currencyEn: 'Kyrgyzstani Som',
        language: 'القيرغيزية والروسية',
        languageEn: 'Kyrgyz and Russian',
        description: 'قيرغيزستان، أرض الجبال الشاهقة والبحيرات الزرقاء',
        descriptionEn: 'Kyrgyzstan, land of high mountains and blue lakes',
        flagCode: 'kg'
      },
      {
        name: 'جمهورية طاجيكستان',
        nameEn: 'Tajikistan',
        capital: 'دوشانبه',
        capitalEn: 'Dushanbe',
        zone: 'Asia/Dushanbe',
        coordinates: '38.8610,71.2761',
        color: '#006600',
        continent: 'asia',
        leader: 'إمام علي رحمان',
        leaderEn: 'Emomali Rahmon',
        population: '9.7 مليون نسمة',
        populationEn: '9.7 million',
        area: '143,100 كم²',
        areaEn: '143,100 km²',
        currency: 'السوموني الطاجيكي',
        currencyEn: 'Tajikistani Somoni',
        language: 'الطاجيكية',
        languageEn: 'Tajik',
        description: 'طاجيكستان، سقف العالم وأرض الجبال الشامخة',
        descriptionEn: 'Tajikistan, roof of the world and land of towering mountains',
        flagCode: 'tj'
      },
      {
        name: 'تركمانستان',
        nameEn: 'Turkmenistan',
        capital: 'عشق آباد',
        capitalEn: 'Ashgabat',
        zone: 'Asia/Ashgabat',
        coordinates: '38.9697,59.5563',
        color: '#00B04F',
        continent: 'asia',
        leader: 'سردار بردي محمدوف',
        leaderEn: 'Serdar Berdimuhamedow',
        population: '6 مليون نسمة',
        populationEn: '6 million',
        area: '488,100 كم²',
        areaEn: '488,100 km²',
        currency: 'المانات التركماني',
        currencyEn: 'Turkmenistan Manat',
        language: 'التركمانية',
        languageEn: 'Turkmen',
        description: 'تركمانستان، أرض الغاز الطبيعي والصحاري الذهبية',
        descriptionEn: 'Turkmenistan, land of natural gas and golden deserts',
        flagCode: 'tm'
      },
      {
        name: 'جمهورية أذربيجان',
        nameEn: 'Azerbaijan',
        capital: 'باكو',
        capitalEn: 'Baku',
        zone: 'Asia/Baku',
        coordinates: '40.1431,47.5769',
        color: '#0081C9',
        continent: 'asia',
        leader: 'إلهام علييف',
        leaderEn: 'Ilham Aliyev',
        population: '10.1 مليون نسمة',
        populationEn: '10.1 million',
        area: '86,600 كم²',
        areaEn: '86,600 km²',
        currency: 'المانات الأذربيجاني',
        currencyEn: 'Azerbaijani Manat',
        language: 'الأذربيجانية',
        languageEn: 'Azerbaijani',
        description: 'أذربيجان، أرض النار والنفط',
        descriptionEn: 'Azerbaijan, land of fire and oil',
        flagCode: 'az'
      },
      {
        name: 'جمهورية أرمينيا',
        nameEn: 'Armenia',
        capital: 'يريفان',
        capitalEn: 'Yerevan',
        zone: 'Asia/Yerevan',
        coordinates: '40.0691,45.0382',
        color: '#FF0000',
        continent: 'asia',
        leader: 'نيكول باشينيان',
        leaderEn: 'Nikol Pashinyan',
        population: '3 مليون نسمة',
        populationEn: '3 million',
        area: '29,743 كم²',
        areaEn: '29,743 km²',
        currency: 'الدرام الأرميني',
        currencyEn: 'Armenian Dram',
        language: 'الأرمينية',
        languageEn: 'Armenian',
        description: 'أرمينيا، أول دولة تعتنق المسيحية رسمياً',
        descriptionEn: 'Armenia, first nation to officially adopt Christianity',
        flagCode: 'am'
      },
      {
        name: 'جمهورية جورجيا',
        nameEn: 'Georgia',
        capital: 'تبليسي',
        capitalEn: 'Tbilisi',
        zone: 'Asia/Tbilisi',
        coordinates: '42.3154,43.3569',
        color: '#FFFFFF',
        continent: 'asia',
        leader: 'سالومي زورابيشفيلي',
        leaderEn: 'Salome Zourabichvili',
        population: '3.7 مليون نسمة',
        populationEn: '3.7 million',
        area: '69,700 كم²',
        areaEn: '69,700 km²',
        currency: 'اللاري الجورجي',
        currencyEn: 'Georgian Lari',
        language: 'الجورجية',
        languageEn: 'Georgian',
        description: 'جورجيا، ملتقى أوروبا وآسيا',
        descriptionEn: 'Georgia, crossroads of Europe and Asia',
        flagCode: 'ge'
      },
      {
        name: 'قبرص',
        nameEn: 'Cyprus',
        capital: 'نيقوسيا',
        capitalEn: 'Nicosia',
        zone: 'Asia/Nicosia',
        coordinates: '35.1264,33.4299',
        color: '#D4AF37',
        continent: 'asia',
        leader: 'نيكوس أناستاسياديس',
        leaderEn: 'Nicos Anastasiades',
        population: '1.2 مليون نسمة',
        populationEn: '1.2 million',
        area: '9,251 كم²',
        areaEn: '9,251 km²',
        currency: 'اليورو',
        currencyEn: 'Euro',
        language: 'اليونانية والتركية',
        languageEn: 'Greek and Turkish',
        description: 'قبرص، جزيرة الحب والجمال في البحر المتوسط',
        descriptionEn: 'Cyprus, island of love and beauty in the Mediterranean',
        flagCode: 'cy'
      },
      {
        name: 'الجمهورية التركية',
        nameEn: 'Turkey',
        capital: 'أنقرة',
        capitalEn: 'Ankara',
        zone: 'Europe/Istanbul',
        coordinates: '38.9637,35.2433',
        color: '#E30A17',
        continent: 'asia',
        leader: 'رجب طيب أردوغان',
        leaderEn: 'Recep Tayyip Erdogan',
        population: '85 مليون نسمة',
        populationEn: '85 million',
        area: '783,562 كم²',
        areaEn: '783,562 km²',
        currency: 'الليرة التركية',
        currencyEn: 'Turkish Lira',
        language: 'التركية',
        languageEn: 'Turkish',
        description: 'تركيا، جسر بين أوروبا وآسيا',
        descriptionEn: 'Turkey, bridge between Europe and Asia',
        flagCode: 'tr'
      },
      {
        name: 'دولة فلسطين',
        nameEn: 'Palestine',
        capital: 'القدس الشرقية',
        capitalEn: 'East Jerusalem',
        zone: 'Asia/Gaza',
        coordinates: '31.9522,35.2332',
        color: '#000000',
        continent: 'asia',
        leader: 'محمود عباس',
        leaderEn: 'Mahmoud Abbas',
        population: '5.2 مليون نسمة',
        populationEn: '5.2 million',
        area: '6,220 كم²',
        areaEn: '6,220 km²',
        currency: 'الشيكل الإسرائيلي والدينار الأردني',
        currencyEn: 'Israeli Shekel and Jordanian Dinar',
        language: 'العربية',
        languageEn: 'Arabic',
        description: 'فلسطين، أرض الأنبياء والمقدسات',
        descriptionEn: 'Palestine, land of prophets and holy sites',
        flagCode: 'ps'
      }
    ];

// Function to get flag code from country name
function getFlagCode(countryName) {
  const flagCodes = {
    'Saudi Arabia': 'sa',
    'United Arab Emirates': 'ae', 
    'Japan': 'jp',
    'China': 'cn',
    'India': 'in',
    'Bangladesh': 'bd',
    'South Korea': 'kr',
    'Thailand': 'th',
    'Vietnam': 'vn',
    'Philippines': 'ph',
    'Qatar': 'qa',
    'Singapore': 'sg',
    'Malaysia': 'my',
    'Iran': 'ir',
    'Jordan': 'jo',
    'Kuwait': 'kw',
    'Morocco': 'ma',
    'Egypt': 'eg',
    'Nigeria': 'ng',
    'South Africa': 'za',
    'Ethiopia': 'et',
    'Kenya': 'ke',
    'Ghana': 'gh',
    'Algeria': 'dz',
    'Uganda': 'ug',
    'Senegal': 'sn',
    'Ivory Coast': 'ci',
    'Cameroon': 'cm',
    'Sudan': 'sd',
    'Tunisia': 'tn',
    'Tanzania': 'tz',
    'Mali': 'ml',
    'Burkina Faso': 'bf',
    'United States': 'us',
    'Brazil': 'br',
    'Canada': 'ca',
    'Mexico': 'mx',
    'Argentina': 'ar',
    'Turkey': 'tr',
    'Russia': 'ru',
    'Germany': 'de',
    'France': 'fr',
    'United Kingdom': 'gb',
    'Italy': 'it',
    'Spain': 'es',
    'Netherlands': 'nl',
    'Austria': 'at',
    'Czech Republic': 'cz',
    'Ireland': 'ie',
    'Finland': 'fi',
    'Bosnia and Herzegovina': 'ba',
    'Bulgaria': 'bg',
    'Croatia': 'hr',
    'Estonia': 'ee',
    'Barbados': 'bb',
    'Bolivia': 'bo',
    'Costa Rica': 'cr',
    'Cuba': 'cu',
    'Australia': 'au',
    'New Zealand': 'nz',
    'Fiji': 'fj',
    'Papua New Guinea': 'pg',
    'Samoa': 'ws',
    'Tonga': 'to',
    'Vanuatu': 'vu',
    'Cook Islands': 'ck'
  };
  return flagCodes[countryName] || null;
}

    // API settings
    const WEATHER_API_KEY = '42d984047a7d1cdbc1f04ff0e2bb10f4';
    const WEATHER_API_URL = 'https://api.openweathermap.org/data/2.5/weather';
    const PRAYER_API_URL = 'https://api.aladhan.com/v1/timings';    // Cache for weather and prayer data
    let weatherCache = {};
    let prayerCache = {};

    // Check internet connectivity
    function checkNetwork() {
      return navigator.onLine;
    }

    // Fetch weather data with extended caching
    async function fetchWeather(coordinates) {
      if (!checkNetwork()) {
        showNotification(translations[currentLanguage].notifications.networkError);
        return null;
      }
      const [lat, lon] = coordinates.split(',');
      const cacheKey = `${lat},${lon}`;
      if (weatherCache[cacheKey] && Date.now() - weatherCache[cacheKey].timestamp < 1800000) { // 30 minutes
        return weatherCache[cacheKey].data;
      }

      try {
        const response = await fetch(`${WEATHER_API_URL}?lat=${lat}&lon=${lon}&appid=${WEATHER_API_KEY}&units=metric&lang=${currentLanguage}`);
        if (!response.ok) {
          if (response.status === 401) {
            showNotification(translations[currentLanguage].notifications.invalidApiKey);
          } else {
            showNotification(translations[currentLanguage].notifications.weatherError);
          }
          throw new Error(`Weather API error: ${response.status} ${response.statusText}`);
        }
        const data = await response.json();
        weatherCache[cacheKey] = { data, timestamp: Date.now() };
        return data;
      } catch (error) {
        console.error('Error fetching weather:', error);
        return null;
      }
    }

    // Fetch prayer times with retry logic and optimized caching (no notification on failure)
    async function fetchPrayerTimes(coordinates, date) {
      if (!checkNetwork()) {
        return null; // Silently return null if offline
      }
      const [lat, lon] = coordinates.split(',');
      const cacheKey = `${lat},${lon}|${date}`;
      if (prayerCache[cacheKey] && Date.now() - prayerCache[cacheKey].timestamp < 172800000) { // 48 hours
        return prayerCache[cacheKey].data;
      }

      try {
        const response = await fetch(`${PRAYER_API_URL}/${date}?latitude=${lat}&longitude=${lon}&method=2&format=json`, {
          mode: 'cors',
          headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
          }
        });
        
        if (!response.ok) {
          throw new Error(`Prayer API error: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.code === 200 && data.data && data.data.timings) {
          prayerCache[cacheKey] = { data: data.data.timings, timestamp: Date.now() };
          return data.data.timings;
        } else {
          throw new Error('Invalid prayer data received');
        }
      } catch (error) {
        console.warn('Prayer API failed, using sample times:', error.message);
        // Return sample prayer times if API fails
        const sampleTimes = {
          Fajr: '05:30',
          Dhuhr: '12:30',
          Asr: '15:45',
          Maghrib: '18:20',
          Isha: '19:45'
        };
        prayerCache[cacheKey] = { data: sampleTimes, timestamp: Date.now() };
        return sampleTimes;
      }
    }

    // Format weather data
    function formatWeather(data) {
      if (!data) {
        return {
          temp: translations[currentLanguage].weather === 'الطقس' ? 'غير متوفر' : 'Not available',
          condition: translations[currentLanguage].weather === 'الطقس' ? 'غير متوفر' : 'Not available',
          humidity: translations[currentLanguage].weather === 'الطقس' ? 'غير متوفر' : 'Not available',
          wind: translations[currentLanguage].weather === 'الطقس' ? 'غير متوفر' : 'Not available'
        };
      }
      return {
        temp: `${Math.round(data.main.temp)}°C`,
        condition: data.weather[0].description,
        humidity: `${data.main.humidity}%`,
        wind: `${data.wind.speed} ${currentLanguage === 'ar' ? 'م/ث' : 'm/s'}`
      };
    }

    // Format prayer times
    function formatPrayerTimes(data) {
      if (!data) {
        const notAvailable = translations[currentLanguage].prayerTimes === 'أوقات الصلاة' ? 'غير متوفر' : 'Not available';
        return {
          fajr: notAvailable,
          dhuhr: notAvailable,
          asr: notAvailable,
          maghrib: notAvailable,
          isha: notAvailable
        };
      }
      
      // Function to format time from 24h to 12h format
      function formatTime(time) {
        if (!time || time === 'N/A') return time;
        try {
          const [hours, minutes] = time.split(':');
          const hour24 = parseInt(hours);
          const hour12 = hour24 === 0 ? 12 : hour24 > 12 ? hour24 - 12 : hour24;
          const ampm = hour24 >= 12 ? 'PM' : 'AM';
          return `${hour12}:${minutes} ${ampm}`;
        } catch (e) {
          return time;
        }
      }
      
      return {
        fajr: formatTime(data.Fajr) || 'N/A',
        dhuhr: formatTime(data.Dhuhr) || 'N/A',
        asr: formatTime(data.Asr) || 'N/A',
        maghrib: formatTime(data.Maghrib) || 'N/A',
        isha: formatTime(data.Isha) || 'N/A'
      };
    }

    // Show notification
    function showNotification(message) {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.classList.add('show');
      setTimeout(() => notification.classList.remove('show'), 3000);
    }

    // Update local clock
    function updateLocalClock() {
      const now = DateTime.local();
      document.getElementById('local-time').textContent = now.toFormat('hh:mm:ss a');
      document.querySelector('.local-label').textContent = translations[currentLanguage].localClock;
    }

    // Update statistics and continent counts
    function updateStats(filteredCountries) {
      const totalCountries = filteredCountries.length;
      let dayCountries = 0;
      let nightCountries = 0;
      const timezones = new Set();

      filteredCountries.forEach(country => {
        const now = DateTime.now().setZone(country.zone);
        const hour = now.hour;
        if (hour >= 6 && hour < 18) dayCountries++;
        else nightCountries++;
        timezones.add(country.zone);
      });

      document.getElementById('total-countries').textContent = totalCountries;
      document.getElementById('day-countries').textContent = dayCountries;
      document.getElementById('night-countries').textContent = nightCountries;
      document.getElementById('timezones-count').textContent = timezones.size;

      // Update continent counts
      updateContinentCounts();

      document.querySelector('#total-countries').parentElement.querySelector('.stat-label').textContent = translations[currentLanguage].totalCountries;
      document.querySelector('#day-countries').parentElement.querySelector('.stat-label').textContent = translations[currentLanguage].dayCountries;
      document.querySelector('#night-countries').parentElement.querySelector('.stat-label').textContent = translations[currentLanguage].nightCountries;
      document.querySelector('#timezones-count').parentElement.querySelector('.stat-label').textContent = translations[currentLanguage].timezones;
    }

    // Update continent counts
    function updateContinentCounts() {
      const continentCounts = {
        all: countries.length,
        asia: countries.filter(c => c.continent === 'asia').length,
        africa: countries.filter(c => c.continent === 'africa').length,
        europe: countries.filter(c => c.continent === 'europe').length,
        america: countries.filter(c => c.continent === 'america' || c.continent === 'americas').length,
        oceania: countries.filter(c => c.continent === 'oceania').length
      };

      Object.keys(continentCounts).forEach(continent => {
        const countElement = document.getElementById(`${continent}-count`);
        if (countElement) {
          countElement.textContent = `${continentCounts[continent]} ${translations[currentLanguage].countries || 'دولة'}`;
        }
      });
    }

    // Filter countries by search and continent
    let currentContinent = 'all';
    let currentSearch = '';

    function filterCountries() {
      currentSearch = document.getElementById('search-input').value.trim().toLowerCase();
      renderClocks();
    }

    function filterByContinent(continent) {
      currentContinent = continent;
      currentSearch = '';
      document.getElementById('search-input').value = '';
      
      // Update active button with smooth animation
      const buttons = document.querySelectorAll('.continent-btn');
      buttons.forEach(btn => {
        btn.classList.remove('active');
        btn.style.transform = 'scale(1)';
      });
      
      const activeButton = document.querySelector(`.continent-btn[onclick="filterByContinent('${continent}')"]`);
      activeButton.classList.add('active');
      activeButton.style.transform = 'scale(1.05)';
      
      // Add loading animation
      const container = document.getElementById('clocks');
      container.style.opacity = '0.5';
      container.style.transform = 'scale(0.95)';
      
      setTimeout(() => {
        renderClocks();
        container.style.opacity = '1';
        container.style.transform = 'scale(1)';
      }, 200);
      
      // Show notification for continent selection
      const continentNames = {
        all: translations[currentLanguage].all,
        asia: translations[currentLanguage].asia,
        africa: translations[currentLanguage].africa,
        europe: translations[currentLanguage].europe,
        america: translations[currentLanguage].america,
        oceania: translations[currentLanguage].oceania
      };
      
      showNotification(`${translations[currentLanguage].showingCountries || 'عرض دول'} ${continentNames[continent]}`);
    }

    // Check if element is in viewport
    function isInViewport(element) {
      const rect = element.getBoundingClientRect();
      return (
        rect.top >= 0 &&
        rect.left >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
        rect.right <= (window.innerWidth || document.documentElement.clientWidth)
      );
    }

    // Render clocks (initial render with weather and prayer times)
    async function renderClocks() {
      const container = document.getElementById('clocks');
      container.innerHTML = '';
      const loading = document.getElementById('loading');
      loading.style.display = 'block';
      loading.textContent = translations[currentLanguage].loading;

      let filteredCountries = countries;

      if (currentContinent !== 'all') {
        filteredCountries = countries.filter(country => {
          let continentMatch = false;
          if (currentContinent === 'america') {
            continentMatch = (country.continent === 'america' || country.continent === 'americas');
          } else {
            continentMatch = country.continent.toLowerCase() === currentContinent.toLowerCase();
          }
          return continentMatch;
        });
      }

      if (currentSearch) {
        filteredCountries = filteredCountries.filter(country => {
          const searchFields = [
            currentLanguage === 'ar' ? country.name : country.nameEn,
            currentLanguage === 'ar' ? country.capital : country.capitalEn,
            currentLanguage === 'ar' ? country.currency : country.currencyEn,
            currentLanguage === 'ar' ? country.language : country.languageEn,
            currentLanguage === 'ar' ? country.description : country.descriptionEn
          ].map(field => field.toLowerCase());
          return searchFields.some(field => field.includes(currentSearch));
        });
      }

      updateStats(filteredCountries);

      if (filteredCountries.length === 0) {
        container.innerHTML = `<div class="no-results">${translations[currentLanguage].noResults}</div>`;
        loading.style.display = 'none';
        showNotification(translations[currentLanguage].notifications.noResults);
        return;
      }

      let index = 0;
      const addedCountries = new Set(); // Track added countries to prevent duplicates
      
      for (const country of filteredCountries) {
        // Skip if country already added
        if (addedCountries.has(country.nameEn)) {
          continue;
        }
        addedCountries.add(country.nameEn);
        
        const now = DateTime.now().setZone(country.zone);
        const offsetHours = now.offset / 60;
        const offsetLabel = `GMT${offsetHours >= 0 ? '+' : ''}${offsetHours}`;
        const hour = now.hour;
        const timeStatus = hour >= 6 && hour < 18 ? '☀️' : '🌙';
        const hijriDate = new Intl.DateTimeFormat(currentLanguage === 'ar' ? 'ar-SA' : 'en-US', {
          calendar: 'islamic',
          day: 'numeric',
          month: 'long',
          year: 'numeric',
          timeZone: country.zone
        }).format(new Date());
        const weatherData = await fetchWeather(country.coordinates);
        const weather = formatWeather(weatherData);
        const prayerDate = now.toFormat('dd-MM-yyyy');
        const prayerData = await fetchPrayerTimes(country.coordinates, prayerDate);
        const prayers = formatPrayerTimes(prayerData);

        const clockBox = document.createElement('div');
        clockBox.classList.add('clock-box');
        clockBox.dataset.country = country.nameEn; // Store country identifier
        clockBox.style.boxShadow = `0 0 15px ${country.color}`;
        clockBox.style.animationDelay = `${index * 0.1}s`; // Staggered animation
        clockBox.innerHTML = `
          <div class="day-night-indicator">${timeStatus}</div>
          <div class="country-header">
            ${country.flagCode || getFlagCode(country.nameEn) ? 
              `<span class="flag-icon fi fi-${country.flagCode || getFlagCode(country.nameEn)}"></span>` : 
              `<span class="country-flag">${country.name.split(' ')[0]}</span>`
            }
            <h3 class="country-name">${currentLanguage === 'ar' ? country.name : country.nameEn}</h3>
          </div>
          <div class="location-info">
            <i class="fas fa-map-marker-alt"></i>
            ${translations[currentLanguage].capital}: ${currentLanguage === 'ar' ? country.capital : country.capitalEn}
          </div>
          <div class="clock-display" style="color: ${country.color}; text-shadow: 0 0 15px ${country.color};">
            <i class="fas fa-clock time-icon"></i>
            ${now.toFormat('hh:mm:ss a')}
          </div>
          <div class="time-info">
            <div class="time-item">
              <i class="fas fa-calendar-day time-icon"></i>
              ${currentLanguage === 'ar' ? 'الميلادي' : 'Gregorian'}: ${now.toFormat('dd/MM/yyyy')}
            </div>
            <div class="time-item">
              <i class="fas fa-moon time-icon"></i>
              ${currentLanguage === 'ar' ? 'الهجري' : 'Hijri'}: ${hijriDate}
            </div>
            <div class="time-item">
              <i class="fas fa-globe time-icon"></i>
              ${translations[currentLanguage].time}: ${offsetLabel}
            </div>
            <div class="time-item">
              <i class="fas fa-earth-americas time-icon"></i>
              ${translations[currentLanguage].continent}: ${translations[currentLanguage][country.continent] || country.continent}
            </div>
          </div>
          <div class="prayer-info">
            <div class="prayer-header">
              <i class="fas fa-mosque"></i>
              ${translations[currentLanguage].prayerTimes}
            </div>
            <div class="prayer-times-grid">
              <div class="prayer-item">
                <div class="prayer-name">
                  <i class="fas fa-sunrise"></i>
                  ${translations[currentLanguage].fajr}
                </div>
                <div class="prayer-time">${prayers.fajr}</div>
              </div>
              <div class="prayer-item">
                <div class="prayer-name">
                  <i class="fas fa-sun"></i>
                  ${translations[currentLanguage].dhuhr}
                </div>
                <div class="prayer-time">${prayers.dhuhr}</div>
              </div>
              <div class="prayer-item">
                <div class="prayer-name">
                  <i class="fas fa-cloud-sun"></i>
                  ${translations[currentLanguage].asr}
                </div>
                <div class="prayer-time">${prayers.asr}</div>
              </div>
              <div class="prayer-item">
                <div class="prayer-name">
                  <i class="fas fa-sunset"></i>
                  ${translations[currentLanguage].maghrib}
                </div>
                <div class="prayer-time">${prayers.maghrib}</div>
              </div>
              <div class="prayer-item">
                <div class="prayer-name">
                  <i class="fas fa-moon"></i>
                  ${translations[currentLanguage].isha}
                </div>
                <div class="prayer-time">${prayers.isha}</div>
              </div>
            </div>
          </div>
          <div class="weather-info">
            <i class="fas fa-cloud-sun weather-icon"></i>
            ${translations[currentLanguage].weather}: ${weather.temp} | ${weather.condition}
          </div>
        `;

        clockBox.addEventListener('click', () => openCountryModal(country, weather, prayers));
        container.appendChild(clockBox);
        index++;
      }

      loading.style.display = 'none';
    }

    // Update clocks dynamically (only visible clocks)
    function updateClocks() {
      const clockBoxes = document.querySelectorAll('.clock-box');
      clockBoxes.forEach(box => {
        if (!isInViewport(box)) return; // Skip non-visible clocks
        const countryName = box.dataset.country;
        const country = countries.find(c => c.nameEn === countryName);
        if (!country) return;

        const now = DateTime.now().setZone(country.zone);
        const hour = now.hour;
        const timeStatus = hour >= 6 && hour < 18 ? '☀️' : '🌙';
        const hijriDate = new Intl.DateTimeFormat(currentLanguage === 'ar' ? 'ar-SA' : 'en-US', {
          calendar: 'islamic',
          day: 'numeric',
          month: 'long',
          year: 'numeric',
          timeZone: country.zone
        }).format(new Date());
        const offsetHours = now.offset / 60;
        const offsetLabel = `GMT${offsetHours >= 0 ? '+' : ''}${offsetHours}`;

        box.querySelector('.clock-display').textContent = now.toFormat('hh:mm:ss a');
        box.querySelector('.day-night-indicator').textContent = timeStatus;
        const timeInfo = box.querySelector('.time-info');
        timeInfo.innerHTML = `
          <div class="time-item">${currentLanguage === 'ar' ? 'الميلادي' : 'Gregorian'}: ${now.toFormat('dd/MM/yyyy')}</div>
          <div class="time-item">${currentLanguage === 'ar' ? 'الهجري' : 'Hijri'}: ${hijriDate}</div>
          <div class="time-item">${translations[currentLanguage].time}: ${offsetLabel}</div>
          <div class="time-item">${translations[currentLanguage].continent}: ${translations[currentLanguage][country.continent]}</div>
        `;
      });
    }

    // Open country modal
    function openCountryModal(country, weather, prayers) {
      const modal = document.getElementById('country-modal');
      document.getElementById('modal-country-name').textContent = currentLanguage === 'ar' ? country.name : country.nameEn;
      document.getElementById('modal-country-flag').textContent = country.name.split(' ')[0];
      const details = document.getElementById('country-details');
      details.innerHTML = `
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].description}</div>
          <div class="detail-value">${currentLanguage === 'ar' ? country.description : country.descriptionEn}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].leader}</div>
          <div class="detail-value">${currentLanguage === 'ar' ? country.leader : country.leaderEn}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].population}</div>
          <div class="detail-value">${currentLanguage === 'ar' ? country.population : country.populationEn}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].capital}</div>
          <div class="detail-value">${currentLanguage === 'ar' ? country.capital : country.capitalEn}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].timezone}</div>
          <div class="detail-value">${country.zone}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].coordinates}</div>
          <div class="detail-value">${country.coordinates}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].area}</div>
          <div class="detail-value">${currentLanguage === 'ar' ? country.area : country.areaEn}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].currency}</div>
          <div class="detail-value">${currentLanguage === 'ar' ? country.currency : country.currencyEn}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].language}</div>
          <div class="detail-value">${currentLanguage === 'ar' ? country.language : country.languageEn}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].weatherTemp}</div>
          <div class="detail-value">${weather.temp}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].weatherCondition}</div>
          <div class="detail-value">${weather.condition}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].weatherHumidity}</div>
          <div class="detail-value">${weather.humidity}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].weatherWind}</div>
          <div class="detail-value">${weather.wind}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">${translations[currentLanguage].prayerTimes}</div>
          <div class="detail-value">
            ${translations[currentLanguage].fajr}: ${prayers.fajr}<br>
            ${translations[currentLanguage].dhuhr}: ${prayers.dhuhr}<br>
            ${translations[currentLanguage].asr}: ${prayers.asr}<br>
            ${translations[currentLanguage].maghrib}: ${prayers.maghrib}<br>
            ${translations[currentLanguage].isha}: ${prayers.isha}
          </div>
        </div>
      `;
      modal.style.display = 'flex';
    }

    // Close modal
    function closeModal() {
      document.getElementById('country-modal').style.display = 'none';
      document.getElementById('about-modal').style.display = 'none';
    }

    // Open about modal
    function openAboutModal() {
      const modal = document.getElementById('about-modal');
      document.querySelector('#about-modal .modal-title').textContent = translations[currentLanguage].aboutTitle;
      toggleAboutLang(currentLanguage);
      modal.style.display = 'flex';
    }

    // Toggle about modal language
    function toggleAboutLang(lang) {
      const arContent = document.getElementById('about-content-ar');
      const enContent = document.getElementById('about-content-en');
      if (lang === 'ar') {
        arContent.style.display = 'block';
        enContent.style.display = 'none';
        document.querySelector('#about-content-ar .lang-switch button').textContent = '🌐 English Version';
      } else {
        arContent.style.display = 'none';
        enContent.style.display = 'block';
        document.querySelector('#about-content-en .lang-switch button').textContent = '🌐 النسخة العربية';
      }
    }

    // Toggle fullscreen
    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().then(() => {
          showNotification(translations[currentLanguage].notifications.fullscreenOn);
        }).catch(() => {
          showNotification(translations[currentLanguage].notifications.fullscreenError);
        });
      } else {
        document.exitFullscreen().then(() => {
          showNotification(translations[currentLanguage].notifications.fullscreenOff);
        });
      }
    }

    // Export data as CSV
    function exportData() {
      const headers = [
        translations[currentLanguage].name,
        translations[currentLanguage].leader,
        translations[currentLanguage].population,
        translations[currentLanguage].timezone,
        translations[currentLanguage].capital,
        translations[currentLanguage].continent,
        translations[currentLanguage].coordinates,
        translations[currentLanguage].area,
        translations[currentLanguage].currency,
        translations[currentLanguage].language,
        translations[currentLanguage].description,
        translations[currentLanguage].prayerTimes
      ];
      const rows = countries.map(country => {
        const prayerDate = DateTime.now().toFormat('dd-MM-yyyy');
        const prayerCacheKey = `${country.coordinates}|${prayerDate}`;
        const prayers = prayerCache[prayerCacheKey]?.data || {
          Fajr: 'N/A', Dhuhr: 'N/A', Asr: 'N/A', Maghrib: 'N/A', Isha: 'N/A'
        };
        return [
          currentLanguage === 'ar' ? country.name : country.nameEn,
          currentLanguage === 'ar' ? country.leader : country.leaderEn,
          currentLanguage === 'ar' ? country.population : country.populationEn,
          country.zone,
          currentLanguage === 'ar' ? country.capital : country.capitalEn,
          translations[currentLanguage][country.continent],
          country.coordinates,
          currentLanguage === 'ar' ? country.area : country.areaEn,
          currentLanguage === 'ar' ? country.currency : country.currencyEn,
          currentLanguage === 'ar' ? country.language : country.languageEn,
          currentLanguage === 'ar' ? country.description : country.descriptionEn,
          `${translations[currentLanguage].fajr}: ${prayers.Fajr}, ` +
          `${translations[currentLanguage].dhuhr}: ${prayers.Dhuhr}, ` +
          `${translations[currentLanguage].asr}: ${prayers.Asr}, ` +
          `${translations[currentLanguage].maghrib}: ${prayers.Maghrib}, ` +
          `${translations[currentLanguage].isha}: ${prayers.Isha}`
        ].map(field => `"${field.replace(/"/g, '""')}"`).join(',');
      });

      const csv = [headers.join(','), ...rows].join('\n');
      const blob = new Blob([new Uint8Array([0xEF, 0xBB, 0xBF]), csv], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'world_clocks_data.csv';
      a.click();
      URL.revokeObjectURL(url);
      showNotification(translations[currentLanguage].notifications.dataExported);
    }

    // Refresh clocks
    function refreshClocks() {
      weatherCache = {};
      prayerCache = {};
      renderClocks();
      showNotification(translations[currentLanguage].notifications.clocksRefreshed);
    }

    // Toggle language
    function toggleLanguage() {
      currentLanguage = currentLanguage === 'ar' ? 'en' : 'ar';
      document.documentElement.lang = currentLanguage;
      document.documentElement.dir = currentLanguage === 'ar' ? 'rtl' : 'ltr';
      document.querySelector('.project-title').textContent = translations[currentLanguage].title;
      document.querySelector('.subtitle').textContent = translations[currentLanguage].subtitle;
      document.querySelector('.search-input').placeholder = translations[currentLanguage].searchPlaceholder;
      document.querySelector('.copyright p').textContent = translations[currentLanguage].copyright;
      
      // Update continent buttons with new structure
      document.querySelectorAll('.continent-btn').forEach((btn, index) => {
        const continents = ['all', 'asia', 'africa', 'europe', 'america', 'oceania'];
        const continentNameElement = btn.querySelector('.continent-name');
        if (continentNameElement) {
          continentNameElement.textContent = translations[currentLanguage][continents[index]];
        }
      });
      
      document.querySelectorAll('.btn').forEach((btn, index) => {
        const btnKeys = ['aboutBtn', 'fullscreenBtn', 'exportBtn', 'refreshBtn', 'langBtn'];
        btn.innerHTML = translations[currentLanguage][btnKeys[index]];
      });
      
      renderClocks();
      updateLocalClock();
      if (document.getElementById('about-modal').style.display === 'flex') {
        toggleAboutLang(currentLanguage);
        document.querySelector('#about-modal .modal-title').textContent = translations[currentLanguage].aboutTitle;
      }
      showNotification(translations[currentLanguage].notifications.langChanged);
    }

    // Function to add missing flag codes to countries
    function addMissingFlagCodes() {
      countries.forEach(country => {
        if (!country.flagCode) {
          country.flagCode = getFlagCode(country.nameEn);
        }
      });
    }

    // Initialize
    function init() {
      if (!window.luxon) {
        showNotification('فشل تحميل مكتبة Luxon. تحقق من الاتصال بالإنترنت.');
        return;
      }
      addMissingFlagCodes(); // Add missing flag codes
      updateLocalClock();
      setInterval(updateLocalClock, 1000);
      renderClocks();
      setInterval(updateClocks, 1000); // Update clocks every second
    }

    init();
  </script>
</body>
</html>